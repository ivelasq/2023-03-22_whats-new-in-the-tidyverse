var sl=Object.create;var ea=Object.defineProperty;var nl=Object.getOwnPropertyDescriptor;var al=Object.getOwnPropertyNames;var ol=Object.getPrototypeOf,ll=Object.prototype.hasOwnProperty;var Mt=(o=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(o,{get:(d,k)=>(typeof require!="undefined"?require:d)[k]}):o)(function(o){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+o+'" is not supported')});var rt=(o,d)=>()=>(d||o((d={exports:{}}).exports,d),d.exports);var cl=(o,d,k,M)=>{if(d&&typeof d=="object"||typeof d=="function")for(let B of al(d))!ll.call(o,B)&&B!==k&&ea(o,B,{get:()=>d[B],enumerable:!(M=nl(d,B))||M.enumerable});return o};var Tt=(o,d,k)=>(k=o!=null?sl(ol(o)):{},cl(d||!o||!o.__esModule?ea(k,"default",{value:o,enumerable:!0}):k,o));var Os=(o,d,k)=>{if(!d.has(o))throw TypeError("Cannot "+k)};var re=(o,d,k)=>(Os(o,d,"read from private field"),k?k.call(o):d.get(o)),we=(o,d,k)=>{if(d.has(o))throw TypeError("Cannot add the same private member more than once");d instanceof WeakSet?d.add(o):d.set(o,k)},Be=(o,d,k,M)=>(Os(o,d,"write to private field"),M?M.call(o,k):d.set(o,k),k);var st=(o,d,k)=>(Os(o,d,"access private method"),k);var Bs=rt((ta,wi)=>{(function(o,d){"use strict";typeof wi=="object"&&typeof wi.exports=="object"?wi.exports=o.document?d(o,!0):function(k){if(!k.document)throw new Error("jQuery requires a window with a document");return d(k)}:d(o)})(typeof window<"u"?window:ta,function(o,d){"use strict";var k=[],M=Object.getPrototypeOf,B=k.slice,u=k.flat?function(s){return k.flat.call(s)}:function(s){return k.concat.apply([],s)},_=k.push,y=k.indexOf,w={},R=w.toString,x=w.hasOwnProperty,P=x.toString,A=P.call(Object),S={},c=function(h){return typeof h=="function"&&typeof h.nodeType!="number"&&typeof h.item!="function"},p=function(h){return h!=null&&h===h.window},v=o.document,e={type:!0,src:!0,nonce:!0,noModule:!0};function i(s,h,f){f=f||v;var m,T,L=f.createElement("script");if(L.text=s,h)for(m in e)T=h[m]||h.getAttribute&&h.getAttribute(m),T&&L.setAttribute(m,T);f.head.appendChild(L).parentNode.removeChild(L)}function t(s){return s==null?s+"":typeof s=="object"||typeof s=="function"?w[R.call(s)]||"object":typeof s}var n="3.6.3",r=function(s,h){return new r.fn.init(s,h)};r.fn=r.prototype={jquery:n,constructor:r,length:0,toArray:function(){return B.call(this)},get:function(s){return s==null?B.call(this):s<0?this[s+this.length]:this[s]},pushStack:function(s){var h=r.merge(this.constructor(),s);return h.prevObject=this,h},each:function(s){return r.each(this,s)},map:function(s){return this.pushStack(r.map(this,function(h,f){return s.call(h,f,h)}))},slice:function(){return this.pushStack(B.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(r.grep(this,function(s,h){return(h+1)%2}))},odd:function(){return this.pushStack(r.grep(this,function(s,h){return h%2}))},eq:function(s){var h=this.length,f=+s+(s<0?h:0);return this.pushStack(f>=0&&f<h?[this[f]]:[])},end:function(){return this.prevObject||this.constructor()},push:_,sort:k.sort,splice:k.splice},r.extend=r.fn.extend=function(){var s,h,f,m,T,L,O=arguments[0]||{},J=1,U=arguments.length,Z=!1;for(typeof O=="boolean"&&(Z=O,O=arguments[J]||{},J++),typeof O!="object"&&!c(O)&&(O={}),J===U&&(O=this,J--);J<U;J++)if((s=arguments[J])!=null)for(h in s)m=s[h],!(h==="__proto__"||O===m)&&(Z&&m&&(r.isPlainObject(m)||(T=Array.isArray(m)))?(f=O[h],T&&!Array.isArray(f)?L=[]:!T&&!r.isPlainObject(f)?L={}:L=f,T=!1,O[h]=r.extend(Z,L,m)):m!==void 0&&(O[h]=m));return O},r.extend({expando:"jQuery"+(n+Math.random()).replace(/\D/g,""),isReady:!0,error:function(s){throw new Error(s)},noop:function(){},isPlainObject:function(s){var h,f;return!s||R.call(s)!=="[object Object]"?!1:(h=M(s),h?(f=x.call(h,"constructor")&&h.constructor,typeof f=="function"&&P.call(f)===A):!0)},isEmptyObject:function(s){var h;for(h in s)return!1;return!0},globalEval:function(s,h,f){i(s,{nonce:h&&h.nonce},f)},each:function(s,h){var f,m=0;if(a(s))for(f=s.length;m<f&&h.call(s[m],m,s[m])!==!1;m++);else for(m in s)if(h.call(s[m],m,s[m])===!1)break;return s},makeArray:function(s,h){var f=h||[];return s!=null&&(a(Object(s))?r.merge(f,typeof s=="string"?[s]:s):_.call(f,s)),f},inArray:function(s,h,f){return h==null?-1:y.call(h,s,f)},merge:function(s,h){for(var f=+h.length,m=0,T=s.length;m<f;m++)s[T++]=h[m];return s.length=T,s},grep:function(s,h,f){for(var m,T=[],L=0,O=s.length,J=!f;L<O;L++)m=!h(s[L],L),m!==J&&T.push(s[L]);return T},map:function(s,h,f){var m,T,L=0,O=[];if(a(s))for(m=s.length;L<m;L++)T=h(s[L],L,f),T!=null&&O.push(T);else for(L in s)T=h(s[L],L,f),T!=null&&O.push(T);return u(O)},guid:1,support:S}),typeof Symbol=="function"&&(r.fn[Symbol.iterator]=k[Symbol.iterator]),r.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(s,h){w["[object "+h+"]"]=h.toLowerCase()});function a(s){var h=!!s&&"length"in s&&s.length,f=t(s);return c(s)||p(s)?!1:f==="array"||h===0||typeof h=="number"&&h>0&&h-1 in s}var l=function(s){var h,f,m,T,L,O,J,U,Z,$,ce,Q,te,Se,Te,Ce,Ye,Ge,dt,He="sizzle"+1*new Date,ke=s.document,lt=0,Oe=0,Ve=yi(),Pr=yi(),gi=yi(),ft=yi(),Kt=function(H,z){return H===z&&(ce=!0),0},Vt={}.hasOwnProperty,ct=[],Ot=ct.pop,vt=ct.push,Bt=ct.push,Kn=ct.slice,Jt=function(H,z){for(var X=0,se=H.length;X<se;X++)if(H[X]===z)return X;return-1},Es="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Ne="[\\x20\\t\\r\\n\\f]",Xt="(?:\\\\[\\da-fA-F]{1,6}"+Ne+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Vn="\\["+Ne+"*("+Xt+")(?:"+Ne+"*([*^$|!~]?=)"+Ne+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Xt+"))|)"+Ne+"*\\]",xs=":("+Xt+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Vn+")*)|.*)\\)|)",zo=new RegExp(Ne+"+","g"),vi=new RegExp("^"+Ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Ne+"+$","g"),Ko=new RegExp("^"+Ne+"*,"+Ne+"*"),Jn=new RegExp("^"+Ne+"*([>+~]|"+Ne+")"+Ne+"*"),Vo=new RegExp(Ne+"|>"),Jo=new RegExp(xs),Xo=new RegExp("^"+Xt+"$"),mi={ID:new RegExp("^#("+Xt+")"),CLASS:new RegExp("^\\.("+Xt+")"),TAG:new RegExp("^("+Xt+"|[*])"),ATTR:new RegExp("^"+Vn),PSEUDO:new RegExp("^"+xs),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Ne+"*(even|odd|(([+-]|)(\\d*)n|)"+Ne+"*(?:([+-]|)"+Ne+"*(\\d+)|))"+Ne+"*\\)|)","i"),bool:new RegExp("^(?:"+Es+")$","i"),needsContext:new RegExp("^"+Ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Ne+"*((?:-\\d)?\\d*)"+Ne+"*\\)|)(?=[^-]|$)","i")},Go=/HTML$/i,Yo=/^(?:input|select|textarea|button)$/i,Zo=/^h\d$/i,Fr=/^[^{]+\{\s*\[native \w/,Qo=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ks=/[+~]/,xt=new RegExp("\\\\[\\da-fA-F]{1,6}"+Ne+"?|\\\\([^\\r\\n\\f])","g"),kt=function(H,z){var X="0x"+H.slice(1)-65536;return z||(X<0?String.fromCharCode(X+65536):String.fromCharCode(X>>10|55296,X&1023|56320))},Xn=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Gn=function(H,z){return z?H==="\0"?"\uFFFD":H.slice(0,-1)+"\\"+H.charCodeAt(H.length-1).toString(16)+" ":"\\"+H},Yn=function(){Q()},$o=Ci(function(H){return H.disabled===!0&&H.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{Bt.apply(ct=Kn.call(ke.childNodes),ke.childNodes),ct[ke.childNodes.length].nodeType}catch{Bt={apply:ct.length?function(z,X){vt.apply(z,Kn.call(X))}:function(z,X){for(var se=z.length,Y=0;z[se++]=X[Y++];);z.length=se-1}}}function We(H,z,X,se){var Y,oe,he,pe,me,Re,be,xe=z&&z.ownerDocument,Pe=z?z.nodeType:9;if(X=X||[],typeof H!="string"||!H||Pe!==1&&Pe!==9&&Pe!==11)return X;if(!se&&(Q(z),z=z||te,Te)){if(Pe!==11&&(me=Qo.exec(H)))if(Y=me[1]){if(Pe===9)if(he=z.getElementById(Y)){if(he.id===Y)return X.push(he),X}else return X;else if(xe&&(he=xe.getElementById(Y))&&dt(z,he)&&he.id===Y)return X.push(he),X}else{if(me[2])return Bt.apply(X,z.getElementsByTagName(H)),X;if((Y=me[3])&&f.getElementsByClassName&&z.getElementsByClassName)return Bt.apply(X,z.getElementsByClassName(Y)),X}if(f.qsa&&!ft[H+" "]&&(!Ce||!Ce.test(H))&&(Pe!==1||z.nodeName.toLowerCase()!=="object")){if(be=H,xe=z,Pe===1&&(Vo.test(H)||Jn.test(H))){for(xe=ks.test(H)&&As(z.parentNode)||z,(xe!==z||!f.scope)&&((pe=z.getAttribute("id"))?pe=pe.replace(Xn,Gn):z.setAttribute("id",pe=He)),Re=O(H),oe=Re.length;oe--;)Re[oe]=(pe?"#"+pe:":scope")+" "+Di(Re[oe]);be=Re.join(",")}try{if(f.cssSupportsSelector&&!CSS.supports("selector(:is("+be+"))"))throw new Error;return Bt.apply(X,xe.querySelectorAll(be)),X}catch{ft(H,!0)}finally{pe===He&&z.removeAttribute("id")}}}return U(H.replace(vi,"$1"),z,X,se)}function yi(){var H=[];function z(X,se){return H.push(X+" ")>m.cacheLength&&delete z[H.shift()],z[X+" "]=se}return z}function Dt(H){return H[He]=!0,H}function mt(H){var z=te.createElement("fieldset");try{return!!H(z)}catch{return!1}finally{z.parentNode&&z.parentNode.removeChild(z),z=null}}function Ts(H,z){for(var X=H.split("|"),se=X.length;se--;)m.attrHandle[X[se]]=z}function Zn(H,z){var X=z&&H,se=X&&H.nodeType===1&&z.nodeType===1&&H.sourceIndex-z.sourceIndex;if(se)return se;if(X){for(;X=X.nextSibling;)if(X===z)return-1}return H?1:-1}function el(H){return function(z){var X=z.nodeName.toLowerCase();return X==="input"&&z.type===H}}function tl(H){return function(z){var X=z.nodeName.toLowerCase();return(X==="input"||X==="button")&&z.type===H}}function Qn(H){return function(z){return"form"in z?z.parentNode&&z.disabled===!1?"label"in z?"label"in z.parentNode?z.parentNode.disabled===H:z.disabled===H:z.isDisabled===H||z.isDisabled!==!H&&$o(z)===H:z.disabled===H:"label"in z?z.disabled===H:!1}}function Gt(H){return Dt(function(z){return z=+z,Dt(function(X,se){for(var Y,oe=H([],X.length,z),he=oe.length;he--;)X[Y=oe[he]]&&(X[Y]=!(se[Y]=X[Y]))})})}function As(H){return H&&typeof H.getElementsByTagName<"u"&&H}f=We.support={},L=We.isXML=function(H){var z=H&&H.namespaceURI,X=H&&(H.ownerDocument||H).documentElement;return!Go.test(z||X&&X.nodeName||"HTML")},Q=We.setDocument=function(H){var z,X,se=H?H.ownerDocument||H:ke;return se==te||se.nodeType!==9||!se.documentElement||(te=se,Se=te.documentElement,Te=!L(te),ke!=te&&(X=te.defaultView)&&X.top!==X&&(X.addEventListener?X.addEventListener("unload",Yn,!1):X.attachEvent&&X.attachEvent("onunload",Yn)),f.scope=mt(function(Y){return Se.appendChild(Y).appendChild(te.createElement("div")),typeof Y.querySelectorAll<"u"&&!Y.querySelectorAll(":scope fieldset div").length}),f.cssSupportsSelector=mt(function(){return CSS.supports("selector(*)")&&te.querySelectorAll(":is(:jqfake)")&&!CSS.supports("selector(:is(*,:jqfake))")}),f.attributes=mt(function(Y){return Y.className="i",!Y.getAttribute("className")}),f.getElementsByTagName=mt(function(Y){return Y.appendChild(te.createComment("")),!Y.getElementsByTagName("*").length}),f.getElementsByClassName=Fr.test(te.getElementsByClassName),f.getById=mt(function(Y){return Se.appendChild(Y).id=He,!te.getElementsByName||!te.getElementsByName(He).length}),f.getById?(m.filter.ID=function(Y){var oe=Y.replace(xt,kt);return function(he){return he.getAttribute("id")===oe}},m.find.ID=function(Y,oe){if(typeof oe.getElementById<"u"&&Te){var he=oe.getElementById(Y);return he?[he]:[]}}):(m.filter.ID=function(Y){var oe=Y.replace(xt,kt);return function(he){var pe=typeof he.getAttributeNode<"u"&&he.getAttributeNode("id");return pe&&pe.value===oe}},m.find.ID=function(Y,oe){if(typeof oe.getElementById<"u"&&Te){var he,pe,me,Re=oe.getElementById(Y);if(Re){if(he=Re.getAttributeNode("id"),he&&he.value===Y)return[Re];for(me=oe.getElementsByName(Y),pe=0;Re=me[pe++];)if(he=Re.getAttributeNode("id"),he&&he.value===Y)return[Re]}return[]}}),m.find.TAG=f.getElementsByTagName?function(Y,oe){if(typeof oe.getElementsByTagName<"u")return oe.getElementsByTagName(Y);if(f.qsa)return oe.querySelectorAll(Y)}:function(Y,oe){var he,pe=[],me=0,Re=oe.getElementsByTagName(Y);if(Y==="*"){for(;he=Re[me++];)he.nodeType===1&&pe.push(he);return pe}return Re},m.find.CLASS=f.getElementsByClassName&&function(Y,oe){if(typeof oe.getElementsByClassName<"u"&&Te)return oe.getElementsByClassName(Y)},Ye=[],Ce=[],(f.qsa=Fr.test(te.querySelectorAll))&&(mt(function(Y){var oe;Se.appendChild(Y).innerHTML="<a id='"+He+"'></a><select id='"+He+"-\r\\' msallowcapture=''><option selected=''></option></select>",Y.querySelectorAll("[msallowcapture^='']").length&&Ce.push("[*^$]="+Ne+`*(?:''|"")`),Y.querySelectorAll("[selected]").length||Ce.push("\\["+Ne+"*(?:value|"+Es+")"),Y.querySelectorAll("[id~="+He+"-]").length||Ce.push("~="),oe=te.createElement("input"),oe.setAttribute("name",""),Y.appendChild(oe),Y.querySelectorAll("[name='']").length||Ce.push("\\["+Ne+"*name"+Ne+"*="+Ne+`*(?:''|"")`),Y.querySelectorAll(":checked").length||Ce.push(":checked"),Y.querySelectorAll("a#"+He+"+*").length||Ce.push(".#.+[+~]"),Y.querySelectorAll("\\\f"),Ce.push("[\\r\\n\\f]")}),mt(function(Y){Y.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var oe=te.createElement("input");oe.setAttribute("type","hidden"),Y.appendChild(oe).setAttribute("name","D"),Y.querySelectorAll("[name=d]").length&&Ce.push("name"+Ne+"*[*^$|!~]?="),Y.querySelectorAll(":enabled").length!==2&&Ce.push(":enabled",":disabled"),Se.appendChild(Y).disabled=!0,Y.querySelectorAll(":disabled").length!==2&&Ce.push(":enabled",":disabled"),Y.querySelectorAll("*,:x"),Ce.push(",.*:")})),(f.matchesSelector=Fr.test(Ge=Se.matches||Se.webkitMatchesSelector||Se.mozMatchesSelector||Se.oMatchesSelector||Se.msMatchesSelector))&&mt(function(Y){f.disconnectedMatch=Ge.call(Y,"*"),Ge.call(Y,"[s!='']:x"),Ye.push("!=",xs)}),f.cssSupportsSelector||Ce.push(":has"),Ce=Ce.length&&new RegExp(Ce.join("|")),Ye=Ye.length&&new RegExp(Ye.join("|")),z=Fr.test(Se.compareDocumentPosition),dt=z||Fr.test(Se.contains)?function(Y,oe){var he=Y.nodeType===9&&Y.documentElement||Y,pe=oe&&oe.parentNode;return Y===pe||!!(pe&&pe.nodeType===1&&(he.contains?he.contains(pe):Y.compareDocumentPosition&&Y.compareDocumentPosition(pe)&16))}:function(Y,oe){if(oe){for(;oe=oe.parentNode;)if(oe===Y)return!0}return!1},Kt=z?function(Y,oe){if(Y===oe)return ce=!0,0;var he=!Y.compareDocumentPosition-!oe.compareDocumentPosition;return he||(he=(Y.ownerDocument||Y)==(oe.ownerDocument||oe)?Y.compareDocumentPosition(oe):1,he&1||!f.sortDetached&&oe.compareDocumentPosition(Y)===he?Y==te||Y.ownerDocument==ke&&dt(ke,Y)?-1:oe==te||oe.ownerDocument==ke&&dt(ke,oe)?1:$?Jt($,Y)-Jt($,oe):0:he&4?-1:1)}:function(Y,oe){if(Y===oe)return ce=!0,0;var he,pe=0,me=Y.parentNode,Re=oe.parentNode,be=[Y],xe=[oe];if(!me||!Re)return Y==te?-1:oe==te?1:me?-1:Re?1:$?Jt($,Y)-Jt($,oe):0;if(me===Re)return Zn(Y,oe);for(he=Y;he=he.parentNode;)be.unshift(he);for(he=oe;he=he.parentNode;)xe.unshift(he);for(;be[pe]===xe[pe];)pe++;return pe?Zn(be[pe],xe[pe]):be[pe]==ke?-1:xe[pe]==ke?1:0}),te},We.matches=function(H,z){return We(H,null,null,z)},We.matchesSelector=function(H,z){if(Q(H),f.matchesSelector&&Te&&!ft[z+" "]&&(!Ye||!Ye.test(z))&&(!Ce||!Ce.test(z)))try{var X=Ge.call(H,z);if(X||f.disconnectedMatch||H.document&&H.document.nodeType!==11)return X}catch{ft(z,!0)}return We(z,te,null,[H]).length>0},We.contains=function(H,z){return(H.ownerDocument||H)!=te&&Q(H),dt(H,z)},We.attr=function(H,z){(H.ownerDocument||H)!=te&&Q(H);var X=m.attrHandle[z.toLowerCase()],se=X&&Vt.call(m.attrHandle,z.toLowerCase())?X(H,z,!Te):void 0;return se!==void 0?se:f.attributes||!Te?H.getAttribute(z):(se=H.getAttributeNode(z))&&se.specified?se.value:null},We.escape=function(H){return(H+"").replace(Xn,Gn)},We.error=function(H){throw new Error("Syntax error, unrecognized expression: "+H)},We.uniqueSort=function(H){var z,X=[],se=0,Y=0;if(ce=!f.detectDuplicates,$=!f.sortStable&&H.slice(0),H.sort(Kt),ce){for(;z=H[Y++];)z===H[Y]&&(se=X.push(Y));for(;se--;)H.splice(X[se],1)}return $=null,H},T=We.getText=function(H){var z,X="",se=0,Y=H.nodeType;if(Y){if(Y===1||Y===9||Y===11){if(typeof H.textContent=="string")return H.textContent;for(H=H.firstChild;H;H=H.nextSibling)X+=T(H)}else if(Y===3||Y===4)return H.nodeValue}else for(;z=H[se++];)X+=T(z);return X},m=We.selectors={cacheLength:50,createPseudo:Dt,match:mi,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(H){return H[1]=H[1].replace(xt,kt),H[3]=(H[3]||H[4]||H[5]||"").replace(xt,kt),H[2]==="~="&&(H[3]=" "+H[3]+" "),H.slice(0,4)},CHILD:function(H){return H[1]=H[1].toLowerCase(),H[1].slice(0,3)==="nth"?(H[3]||We.error(H[0]),H[4]=+(H[4]?H[5]+(H[6]||1):2*(H[3]==="even"||H[3]==="odd")),H[5]=+(H[7]+H[8]||H[3]==="odd")):H[3]&&We.error(H[0]),H},PSEUDO:function(H){var z,X=!H[6]&&H[2];return mi.CHILD.test(H[0])?null:(H[3]?H[2]=H[4]||H[5]||"":X&&Jo.test(X)&&(z=O(X,!0))&&(z=X.indexOf(")",X.length-z)-X.length)&&(H[0]=H[0].slice(0,z),H[2]=X.slice(0,z)),H.slice(0,3))}},filter:{TAG:function(H){var z=H.replace(xt,kt).toLowerCase();return H==="*"?function(){return!0}:function(X){return X.nodeName&&X.nodeName.toLowerCase()===z}},CLASS:function(H){var z=Ve[H+" "];return z||(z=new RegExp("(^|"+Ne+")"+H+"("+Ne+"|$)"))&&Ve(H,function(X){return z.test(typeof X.className=="string"&&X.className||typeof X.getAttribute<"u"&&X.getAttribute("class")||"")})},ATTR:function(H,z,X){return function(se){var Y=We.attr(se,H);return Y==null?z==="!=":z?(Y+="",z==="="?Y===X:z==="!="?Y!==X:z==="^="?X&&Y.indexOf(X)===0:z==="*="?X&&Y.indexOf(X)>-1:z==="$="?X&&Y.slice(-X.length)===X:z==="~="?(" "+Y.replace(zo," ")+" ").indexOf(X)>-1:z==="|="?Y===X||Y.slice(0,X.length+1)===X+"-":!1):!0}},CHILD:function(H,z,X,se,Y){var oe=H.slice(0,3)!=="nth",he=H.slice(-4)!=="last",pe=z==="of-type";return se===1&&Y===0?function(me){return!!me.parentNode}:function(me,Re,be){var xe,Pe,je,Ee,Ze,tt,_t=oe!==he?"nextSibling":"previousSibling",Ke=me.parentNode,Or=pe&&me.nodeName.toLowerCase(),Br=!be&&!pe,pt=!1;if(Ke){if(oe){for(;_t;){for(Ee=me;Ee=Ee[_t];)if(pe?Ee.nodeName.toLowerCase()===Or:Ee.nodeType===1)return!1;tt=_t=H==="only"&&!tt&&"nextSibling"}return!0}if(tt=[he?Ke.firstChild:Ke.lastChild],he&&Br){for(Ee=Ke,je=Ee[He]||(Ee[He]={}),Pe=je[Ee.uniqueID]||(je[Ee.uniqueID]={}),xe=Pe[H]||[],Ze=xe[0]===lt&&xe[1],pt=Ze&&xe[2],Ee=Ze&&Ke.childNodes[Ze];Ee=++Ze&&Ee&&Ee[_t]||(pt=Ze=0)||tt.pop();)if(Ee.nodeType===1&&++pt&&Ee===me){Pe[H]=[lt,Ze,pt];break}}else if(Br&&(Ee=me,je=Ee[He]||(Ee[He]={}),Pe=je[Ee.uniqueID]||(je[Ee.uniqueID]={}),xe=Pe[H]||[],Ze=xe[0]===lt&&xe[1],pt=Ze),pt===!1)for(;(Ee=++Ze&&Ee&&Ee[_t]||(pt=Ze=0)||tt.pop())&&!((pe?Ee.nodeName.toLowerCase()===Or:Ee.nodeType===1)&&++pt&&(Br&&(je=Ee[He]||(Ee[He]={}),Pe=je[Ee.uniqueID]||(je[Ee.uniqueID]={}),Pe[H]=[lt,pt]),Ee===me)););return pt-=Y,pt===se||pt%se===0&&pt/se>=0}}},PSEUDO:function(H,z){var X,se=m.pseudos[H]||m.setFilters[H.toLowerCase()]||We.error("unsupported pseudo: "+H);return se[He]?se(z):se.length>1?(X=[H,H,"",z],m.setFilters.hasOwnProperty(H.toLowerCase())?Dt(function(Y,oe){for(var he,pe=se(Y,z),me=pe.length;me--;)he=Jt(Y,pe[me]),Y[he]=!(oe[he]=pe[me])}):function(Y){return se(Y,0,X)}):se}},pseudos:{not:Dt(function(H){var z=[],X=[],se=J(H.replace(vi,"$1"));return se[He]?Dt(function(Y,oe,he,pe){for(var me,Re=se(Y,null,pe,[]),be=Y.length;be--;)(me=Re[be])&&(Y[be]=!(oe[be]=me))}):function(Y,oe,he){return z[0]=Y,se(z,null,he,X),z[0]=null,!X.pop()}}),has:Dt(function(H){return function(z){return We(H,z).length>0}}),contains:Dt(function(H){return H=H.replace(xt,kt),function(z){return(z.textContent||T(z)).indexOf(H)>-1}}),lang:Dt(function(H){return Xo.test(H||"")||We.error("unsupported lang: "+H),H=H.replace(xt,kt).toLowerCase(),function(z){var X;do if(X=Te?z.lang:z.getAttribute("xml:lang")||z.getAttribute("lang"))return X=X.toLowerCase(),X===H||X.indexOf(H+"-")===0;while((z=z.parentNode)&&z.nodeType===1);return!1}}),target:function(H){var z=s.location&&s.location.hash;return z&&z.slice(1)===H.id},root:function(H){return H===Se},focus:function(H){return H===te.activeElement&&(!te.hasFocus||te.hasFocus())&&!!(H.type||H.href||~H.tabIndex)},enabled:Qn(!1),disabled:Qn(!0),checked:function(H){var z=H.nodeName.toLowerCase();return z==="input"&&!!H.checked||z==="option"&&!!H.selected},selected:function(H){return H.parentNode&&H.parentNode.selectedIndex,H.selected===!0},empty:function(H){for(H=H.firstChild;H;H=H.nextSibling)if(H.nodeType<6)return!1;return!0},parent:function(H){return!m.pseudos.empty(H)},header:function(H){return Zo.test(H.nodeName)},input:function(H){return Yo.test(H.nodeName)},button:function(H){var z=H.nodeName.toLowerCase();return z==="input"&&H.type==="button"||z==="button"},text:function(H){var z;return H.nodeName.toLowerCase()==="input"&&H.type==="text"&&((z=H.getAttribute("type"))==null||z.toLowerCase()==="text")},first:Gt(function(){return[0]}),last:Gt(function(H,z){return[z-1]}),eq:Gt(function(H,z,X){return[X<0?X+z:X]}),even:Gt(function(H,z){for(var X=0;X<z;X+=2)H.push(X);return H}),odd:Gt(function(H,z){for(var X=1;X<z;X+=2)H.push(X);return H}),lt:Gt(function(H,z,X){for(var se=X<0?X+z:X>z?z:X;--se>=0;)H.push(se);return H}),gt:Gt(function(H,z,X){for(var se=X<0?X+z:X;++se<z;)H.push(se);return H})}},m.pseudos.nth=m.pseudos.eq;for(h in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})m.pseudos[h]=el(h);for(h in{submit:!0,reset:!0})m.pseudos[h]=tl(h);function $n(){}$n.prototype=m.filters=m.pseudos,m.setFilters=new $n,O=We.tokenize=function(H,z){var X,se,Y,oe,he,pe,me,Re=Pr[H+" "];if(Re)return z?0:Re.slice(0);for(he=H,pe=[],me=m.preFilter;he;){(!X||(se=Ko.exec(he)))&&(se&&(he=he.slice(se[0].length)||he),pe.push(Y=[])),X=!1,(se=Jn.exec(he))&&(X=se.shift(),Y.push({value:X,type:se[0].replace(vi," ")}),he=he.slice(X.length));for(oe in m.filter)(se=mi[oe].exec(he))&&(!me[oe]||(se=me[oe](se)))&&(X=se.shift(),Y.push({value:X,type:oe,matches:se}),he=he.slice(X.length));if(!X)break}return z?he.length:he?We.error(H):Pr(H,pe).slice(0)};function Di(H){for(var z=0,X=H.length,se="";z<X;z++)se+=H[z].value;return se}function Ci(H,z,X){var se=z.dir,Y=z.next,oe=Y||se,he=X&&oe==="parentNode",pe=Oe++;return z.first?function(me,Re,be){for(;me=me[se];)if(me.nodeType===1||he)return H(me,Re,be);return!1}:function(me,Re,be){var xe,Pe,je,Ee=[lt,pe];if(be){for(;me=me[se];)if((me.nodeType===1||he)&&H(me,Re,be))return!0}else for(;me=me[se];)if(me.nodeType===1||he)if(je=me[He]||(me[He]={}),Pe=je[me.uniqueID]||(je[me.uniqueID]={}),Y&&Y===me.nodeName.toLowerCase())me=me[se]||me;else{if((xe=Pe[oe])&&xe[0]===lt&&xe[1]===pe)return Ee[2]=xe[2];if(Pe[oe]=Ee,Ee[2]=H(me,Re,be))return!0}return!1}}function Ls(H){return H.length>1?function(z,X,se){for(var Y=H.length;Y--;)if(!H[Y](z,X,se))return!1;return!0}:H[0]}function rl(H,z,X){for(var se=0,Y=z.length;se<Y;se++)We(H,z[se],X);return X}function Si(H,z,X,se,Y){for(var oe,he=[],pe=0,me=H.length,Re=z!=null;pe<me;pe++)(oe=H[pe])&&(!X||X(oe,se,Y))&&(he.push(oe),Re&&z.push(pe));return he}function Ps(H,z,X,se,Y,oe){return se&&!se[He]&&(se=Ps(se)),Y&&!Y[He]&&(Y=Ps(Y,oe)),Dt(function(he,pe,me,Re){var be,xe,Pe,je=[],Ee=[],Ze=pe.length,tt=he||rl(z||"*",me.nodeType?[me]:me,[]),_t=H&&(he||!z)?Si(tt,je,H,me,Re):tt,Ke=X?Y||(he?H:Ze||se)?[]:pe:_t;if(X&&X(_t,Ke,me,Re),se)for(be=Si(Ke,Ee),se(be,[],me,Re),xe=be.length;xe--;)(Pe=be[xe])&&(Ke[Ee[xe]]=!(_t[Ee[xe]]=Pe));if(he){if(Y||H){if(Y){for(be=[],xe=Ke.length;xe--;)(Pe=Ke[xe])&&be.push(_t[xe]=Pe);Y(null,Ke=[],be,Re)}for(xe=Ke.length;xe--;)(Pe=Ke[xe])&&(be=Y?Jt(he,Pe):je[xe])>-1&&(he[be]=!(pe[be]=Pe))}}else Ke=Si(Ke===pe?Ke.splice(Ze,Ke.length):Ke),Y?Y(null,pe,Ke,Re):Bt.apply(pe,Ke)})}function Fs(H){for(var z,X,se,Y=H.length,oe=m.relative[H[0].type],he=oe||m.relative[" "],pe=oe?1:0,me=Ci(function(xe){return xe===z},he,!0),Re=Ci(function(xe){return Jt(z,xe)>-1},he,!0),be=[function(xe,Pe,je){var Ee=!oe&&(je||Pe!==Z)||((z=Pe).nodeType?me(xe,Pe,je):Re(xe,Pe,je));return z=null,Ee}];pe<Y;pe++)if(X=m.relative[H[pe].type])be=[Ci(Ls(be),X)];else{if(X=m.filter[H[pe].type].apply(null,H[pe].matches),X[He]){for(se=++pe;se<Y&&!m.relative[H[se].type];se++);return Ps(pe>1&&Ls(be),pe>1&&Di(H.slice(0,pe-1).concat({value:H[pe-2].type===" "?"*":""})).replace(vi,"$1"),X,pe<se&&Fs(H.slice(pe,se)),se<Y&&Fs(H=H.slice(se)),se<Y&&Di(H))}be.push(X)}return Ls(be)}function il(H,z){var X=z.length>0,se=H.length>0,Y=function(oe,he,pe,me,Re){var be,xe,Pe,je=0,Ee="0",Ze=oe&&[],tt=[],_t=Z,Ke=oe||se&&m.find.TAG("*",Re),Or=lt+=_t==null?1:Math.random()||.1,Br=Ke.length;for(Re&&(Z=he==te||he||Re);Ee!==Br&&(be=Ke[Ee])!=null;Ee++){if(se&&be){for(xe=0,!he&&be.ownerDocument!=te&&(Q(be),pe=!Te);Pe=H[xe++];)if(Pe(be,he||te,pe)){me.push(be);break}Re&&(lt=Or)}X&&((be=!Pe&&be)&&je--,oe&&Ze.push(be))}if(je+=Ee,X&&Ee!==je){for(xe=0;Pe=z[xe++];)Pe(Ze,tt,he,pe);if(oe){if(je>0)for(;Ee--;)Ze[Ee]||tt[Ee]||(tt[Ee]=Ot.call(me));tt=Si(tt)}Bt.apply(me,tt),Re&&!oe&&tt.length>0&&je+z.length>1&&We.uniqueSort(me)}return Re&&(lt=Or,Z=_t),Ze};return X?Dt(Y):Y}return J=We.compile=function(H,z){var X,se=[],Y=[],oe=gi[H+" "];if(!oe){for(z||(z=O(H)),X=z.length;X--;)oe=Fs(z[X]),oe[He]?se.push(oe):Y.push(oe);oe=gi(H,il(Y,se)),oe.selector=H}return oe},U=We.select=function(H,z,X,se){var Y,oe,he,pe,me,Re=typeof H=="function"&&H,be=!se&&O(H=Re.selector||H);if(X=X||[],be.length===1){if(oe=be[0]=be[0].slice(0),oe.length>2&&(he=oe[0]).type==="ID"&&z.nodeType===9&&Te&&m.relative[oe[1].type]){if(z=(m.find.ID(he.matches[0].replace(xt,kt),z)||[])[0],z)Re&&(z=z.parentNode);else return X;H=H.slice(oe.shift().value.length)}for(Y=mi.needsContext.test(H)?0:oe.length;Y--&&(he=oe[Y],!m.relative[pe=he.type]);)if((me=m.find[pe])&&(se=me(he.matches[0].replace(xt,kt),ks.test(oe[0].type)&&As(z.parentNode)||z))){if(oe.splice(Y,1),H=se.length&&Di(oe),!H)return Bt.apply(X,se),X;break}}return(Re||J(H,be))(se,z,!Te,X,!z||ks.test(H)&&As(z.parentNode)||z),X},f.sortStable=He.split("").sort(Kt).join("")===He,f.detectDuplicates=!!ce,Q(),f.sortDetached=mt(function(H){return H.compareDocumentPosition(te.createElement("fieldset"))&1}),mt(function(H){return H.innerHTML="<a href='#'></a>",H.firstChild.getAttribute("href")==="#"})||Ts("type|href|height|width",function(H,z,X){if(!X)return H.getAttribute(z,z.toLowerCase()==="type"?1:2)}),(!f.attributes||!mt(function(H){return H.innerHTML="<input/>",H.firstChild.setAttribute("value",""),H.firstChild.getAttribute("value")===""}))&&Ts("value",function(H,z,X){if(!X&&H.nodeName.toLowerCase()==="input")return H.defaultValue}),mt(function(H){return H.getAttribute("disabled")==null})||Ts(Es,function(H,z,X){var se;if(!X)return H[z]===!0?z.toLowerCase():(se=H.getAttributeNode(z))&&se.specified?se.value:null}),We}(o);r.find=l,r.expr=l.selectors,r.expr[":"]=r.expr.pseudos,r.uniqueSort=r.unique=l.uniqueSort,r.text=l.getText,r.isXMLDoc=l.isXML,r.contains=l.contains,r.escapeSelector=l.escape;var g=function(s,h,f){for(var m=[],T=f!==void 0;(s=s[h])&&s.nodeType!==9;)if(s.nodeType===1){if(T&&r(s).is(f))break;m.push(s)}return m},D=function(s,h){for(var f=[];s;s=s.nextSibling)s.nodeType===1&&s!==h&&f.push(s);return f},C=r.expr.match.needsContext;function b(s,h){return s.nodeName&&s.nodeName.toLowerCase()===h.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function W(s,h,f){return c(h)?r.grep(s,function(m,T){return!!h.call(m,T,m)!==f}):h.nodeType?r.grep(s,function(m){return m===h!==f}):typeof h!="string"?r.grep(s,function(m){return y.call(h,m)>-1!==f}):r.filter(h,s,f)}r.filter=function(s,h,f){var m=h[0];return f&&(s=":not("+s+")"),h.length===1&&m.nodeType===1?r.find.matchesSelector(m,s)?[m]:[]:r.find.matches(s,r.grep(h,function(T){return T.nodeType===1}))},r.fn.extend({find:function(s){var h,f,m=this.length,T=this;if(typeof s!="string")return this.pushStack(r(s).filter(function(){for(h=0;h<m;h++)if(r.contains(T[h],this))return!0}));for(f=this.pushStack([]),h=0;h<m;h++)r.find(s,T[h],f);return m>1?r.uniqueSort(f):f},filter:function(s){return this.pushStack(W(this,s||[],!1))},not:function(s){return this.pushStack(W(this,s||[],!0))},is:function(s){return!!W(this,typeof s=="string"&&C.test(s)?r(s):s||[],!1).length}});var K,E=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,F=r.fn.init=function(s,h,f){var m,T;if(!s)return this;if(f=f||K,typeof s=="string")if(s[0]==="<"&&s[s.length-1]===">"&&s.length>=3?m=[null,s,null]:m=E.exec(s),m&&(m[1]||!h))if(m[1]){if(h=h instanceof r?h[0]:h,r.merge(this,r.parseHTML(m[1],h&&h.nodeType?h.ownerDocument||h:v,!0)),N.test(m[1])&&r.isPlainObject(h))for(m in h)c(this[m])?this[m](h[m]):this.attr(m,h[m]);return this}else return T=v.getElementById(m[2]),T&&(this[0]=T,this.length=1),this;else return!h||h.jquery?(h||f).find(s):this.constructor(h).find(s);else{if(s.nodeType)return this[0]=s,this.length=1,this;if(c(s))return f.ready!==void 0?f.ready(s):s(r)}return r.makeArray(s,this)};F.prototype=r.fn,K=r(v);var I=/^(?:parents|prev(?:Until|All))/,j={children:!0,contents:!0,next:!0,prev:!0};r.fn.extend({has:function(s){var h=r(s,this),f=h.length;return this.filter(function(){for(var m=0;m<f;m++)if(r.contains(this,h[m]))return!0})},closest:function(s,h){var f,m=0,T=this.length,L=[],O=typeof s!="string"&&r(s);if(!C.test(s)){for(;m<T;m++)for(f=this[m];f&&f!==h;f=f.parentNode)if(f.nodeType<11&&(O?O.index(f)>-1:f.nodeType===1&&r.find.matchesSelector(f,s))){L.push(f);break}}return this.pushStack(L.length>1?r.uniqueSort(L):L)},index:function(s){return s?typeof s=="string"?y.call(r(s),this[0]):y.call(this,s.jquery?s[0]:s):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(s,h){return this.pushStack(r.uniqueSort(r.merge(this.get(),r(s,h))))},addBack:function(s){return this.add(s==null?this.prevObject:this.prevObject.filter(s))}});function ie(s,h){for(;(s=s[h])&&s.nodeType!==1;);return s}r.each({parent:function(s){var h=s.parentNode;return h&&h.nodeType!==11?h:null},parents:function(s){return g(s,"parentNode")},parentsUntil:function(s,h,f){return g(s,"parentNode",f)},next:function(s){return ie(s,"nextSibling")},prev:function(s){return ie(s,"previousSibling")},nextAll:function(s){return g(s,"nextSibling")},prevAll:function(s){return g(s,"previousSibling")},nextUntil:function(s,h,f){return g(s,"nextSibling",f)},prevUntil:function(s,h,f){return g(s,"previousSibling",f)},siblings:function(s){return D((s.parentNode||{}).firstChild,s)},children:function(s){return D(s.firstChild)},contents:function(s){return s.contentDocument!=null&&M(s.contentDocument)?s.contentDocument:(b(s,"template")&&(s=s.content||s),r.merge([],s.childNodes))}},function(s,h){r.fn[s]=function(f,m){var T=r.map(this,h,f);return s.slice(-5)!=="Until"&&(m=f),m&&typeof m=="string"&&(T=r.filter(m,T)),this.length>1&&(j[s]||r.uniqueSort(T),I.test(s)&&T.reverse()),this.pushStack(T)}});var ee=/[^\x20\t\r\n\f]+/g;function fe(s){var h={};return r.each(s.match(ee)||[],function(f,m){h[m]=!0}),h}r.Callbacks=function(s){s=typeof s=="string"?fe(s):r.extend({},s);var h,f,m,T,L=[],O=[],J=-1,U=function(){for(T=T||s.once,m=h=!0;O.length;J=-1)for(f=O.shift();++J<L.length;)L[J].apply(f[0],f[1])===!1&&s.stopOnFalse&&(J=L.length,f=!1);s.memory||(f=!1),h=!1,T&&(f?L=[]:L="")},Z={add:function(){return L&&(f&&!h&&(J=L.length-1,O.push(f)),function $(ce){r.each(ce,function(Q,te){c(te)?(!s.unique||!Z.has(te))&&L.push(te):te&&te.length&&t(te)!=="string"&&$(te)})}(arguments),f&&!h&&U()),this},remove:function(){return r.each(arguments,function($,ce){for(var Q;(Q=r.inArray(ce,L,Q))>-1;)L.splice(Q,1),Q<=J&&J--}),this},has:function($){return $?r.inArray($,L)>-1:L.length>0},empty:function(){return L&&(L=[]),this},disable:function(){return T=O=[],L=f="",this},disabled:function(){return!L},lock:function(){return T=O=[],!f&&!h&&(L=f=""),this},locked:function(){return!!T},fireWith:function($,ce){return T||(ce=ce||[],ce=[$,ce.slice?ce.slice():ce],O.push(ce),h||U()),this},fire:function(){return Z.fireWith(this,arguments),this},fired:function(){return!!m}};return Z};function ue(s){return s}function ge(s){throw s}function q(s,h,f,m){var T;try{s&&c(T=s.promise)?T.call(s).done(h).fail(f):s&&c(T=s.then)?T.call(s,h,f):h.apply(void 0,[s].slice(m))}catch(L){f.apply(void 0,[L])}}r.extend({Deferred:function(s){var h=[["notify","progress",r.Callbacks("memory"),r.Callbacks("memory"),2],["resolve","done",r.Callbacks("once memory"),r.Callbacks("once memory"),0,"resolved"],["reject","fail",r.Callbacks("once memory"),r.Callbacks("once memory"),1,"rejected"]],f="pending",m={state:function(){return f},always:function(){return T.done(arguments).fail(arguments),this},catch:function(L){return m.then(null,L)},pipe:function(){var L=arguments;return r.Deferred(function(O){r.each(h,function(J,U){var Z=c(L[U[4]])&&L[U[4]];T[U[1]](function(){var $=Z&&Z.apply(this,arguments);$&&c($.promise)?$.promise().progress(O.notify).done(O.resolve).fail(O.reject):O[U[0]+"With"](this,Z?[$]:arguments)})}),L=null}).promise()},then:function(L,O,J){var U=0;function Z($,ce,Q,te){return function(){var Se=this,Te=arguments,Ce=function(){var Ge,dt;if(!($<U)){if(Ge=Q.apply(Se,Te),Ge===ce.promise())throw new TypeError("Thenable self-resolution");dt=Ge&&(typeof Ge=="object"||typeof Ge=="function")&&Ge.then,c(dt)?te?dt.call(Ge,Z(U,ce,ue,te),Z(U,ce,ge,te)):(U++,dt.call(Ge,Z(U,ce,ue,te),Z(U,ce,ge,te),Z(U,ce,ue,ce.notifyWith))):(Q!==ue&&(Se=void 0,Te=[Ge]),(te||ce.resolveWith)(Se,Te))}},Ye=te?Ce:function(){try{Ce()}catch(Ge){r.Deferred.exceptionHook&&r.Deferred.exceptionHook(Ge,Ye.stackTrace),$+1>=U&&(Q!==ge&&(Se=void 0,Te=[Ge]),ce.rejectWith(Se,Te))}};$?Ye():(r.Deferred.getStackHook&&(Ye.stackTrace=r.Deferred.getStackHook()),o.setTimeout(Ye))}}return r.Deferred(function($){h[0][3].add(Z(0,$,c(J)?J:ue,$.notifyWith)),h[1][3].add(Z(0,$,c(L)?L:ue)),h[2][3].add(Z(0,$,c(O)?O:ge))}).promise()},promise:function(L){return L!=null?r.extend(L,m):m}},T={};return r.each(h,function(L,O){var J=O[2],U=O[5];m[O[1]]=J.add,U&&J.add(function(){f=U},h[3-L][2].disable,h[3-L][3].disable,h[0][2].lock,h[0][3].lock),J.add(O[3].fire),T[O[0]]=function(){return T[O[0]+"With"](this===T?void 0:this,arguments),this},T[O[0]+"With"]=J.fireWith}),m.promise(T),s&&s.call(T,T),T},when:function(s){var h=arguments.length,f=h,m=Array(f),T=B.call(arguments),L=r.Deferred(),O=function(J){return function(U){m[J]=this,T[J]=arguments.length>1?B.call(arguments):U,--h||L.resolveWith(m,T)}};if(h<=1&&(q(s,L.done(O(f)).resolve,L.reject,!h),L.state()==="pending"||c(T[f]&&T[f].then)))return L.then();for(;f--;)q(T[f],O(f),L.reject);return L.promise()}});var V=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;r.Deferred.exceptionHook=function(s,h){o.console&&o.console.warn&&s&&V.test(s.name)&&o.console.warn("jQuery.Deferred exception: "+s.message,s.stack,h)},r.readyException=function(s){o.setTimeout(function(){throw s})};var G=r.Deferred();r.fn.ready=function(s){return G.then(s).catch(function(h){r.readyException(h)}),this},r.extend({isReady:!1,readyWait:1,ready:function(s){(s===!0?--r.readyWait:r.isReady)||(r.isReady=!0,!(s!==!0&&--r.readyWait>0)&&G.resolveWith(v,[r]))}}),r.ready.then=G.then;function ae(){v.removeEventListener("DOMContentLoaded",ae),o.removeEventListener("load",ae),r.ready()}v.readyState==="complete"||v.readyState!=="loading"&&!v.documentElement.doScroll?o.setTimeout(r.ready):(v.addEventListener("DOMContentLoaded",ae),o.addEventListener("load",ae));var de=function(s,h,f,m,T,L,O){var J=0,U=s.length,Z=f==null;if(t(f)==="object"){T=!0;for(J in f)de(s,h,J,f[J],!0,L,O)}else if(m!==void 0&&(T=!0,c(m)||(O=!0),Z&&(O?(h.call(s,m),h=null):(Z=h,h=function($,ce,Q){return Z.call(r($),Q)})),h))for(;J<U;J++)h(s[J],f,O?m:m.call(s[J],J,h(s[J],f)));return T?s:Z?h.call(s):U?h(s[0],f):L},ne=/^-ms-/,_e=/-([a-z])/g;function Fe(s,h){return h.toUpperCase()}function Ae(s){return s.replace(ne,"ms-").replace(_e,Fe)}var ve=function(s){return s.nodeType===1||s.nodeType===9||!+s.nodeType};function Le(){this.expando=r.expando+Le.uid++}Le.uid=1,Le.prototype={cache:function(s){var h=s[this.expando];return h||(h={},ve(s)&&(s.nodeType?s[this.expando]=h:Object.defineProperty(s,this.expando,{value:h,configurable:!0}))),h},set:function(s,h,f){var m,T=this.cache(s);if(typeof h=="string")T[Ae(h)]=f;else for(m in h)T[Ae(m)]=h[m];return T},get:function(s,h){return h===void 0?this.cache(s):s[this.expando]&&s[this.expando][Ae(h)]},access:function(s,h,f){return h===void 0||h&&typeof h=="string"&&f===void 0?this.get(s,h):(this.set(s,h,f),f!==void 0?f:h)},remove:function(s,h){var f,m=s[this.expando];if(m!==void 0){if(h!==void 0)for(Array.isArray(h)?h=h.map(Ae):(h=Ae(h),h=h in m?[h]:h.match(ee)||[]),f=h.length;f--;)delete m[h[f]];(h===void 0||r.isEmptyObject(m))&&(s.nodeType?s[this.expando]=void 0:delete s[this.expando])}},hasData:function(s){var h=s[this.expando];return h!==void 0&&!r.isEmptyObject(h)}};var De=new Le,Je=new Le,ye=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ro=/[A-Z]/g;function io(s){return s==="true"?!0:s==="false"?!1:s==="null"?null:s===+s+""?+s:ye.test(s)?JSON.parse(s):s}function fn(s,h,f){var m;if(f===void 0&&s.nodeType===1)if(m="data-"+h.replace(ro,"-$&").toLowerCase(),f=s.getAttribute(m),typeof f=="string"){try{f=io(f)}catch{}Je.set(s,h,f)}else f=void 0;return f}r.extend({hasData:function(s){return Je.hasData(s)||De.hasData(s)},data:function(s,h,f){return Je.access(s,h,f)},removeData:function(s,h){Je.remove(s,h)},_data:function(s,h,f){return De.access(s,h,f)},_removeData:function(s,h){De.remove(s,h)}}),r.fn.extend({data:function(s,h){var f,m,T,L=this[0],O=L&&L.attributes;if(s===void 0){if(this.length&&(T=Je.get(L),L.nodeType===1&&!De.get(L,"hasDataAttrs"))){for(f=O.length;f--;)O[f]&&(m=O[f].name,m.indexOf("data-")===0&&(m=Ae(m.slice(5)),fn(L,m,T[m])));De.set(L,"hasDataAttrs",!0)}return T}return typeof s=="object"?this.each(function(){Je.set(this,s)}):de(this,function(J){var U;if(L&&J===void 0)return U=Je.get(L,s),U!==void 0||(U=fn(L,s),U!==void 0)?U:void 0;this.each(function(){Je.set(this,s,J)})},null,h,arguments.length>1,null,!0)},removeData:function(s){return this.each(function(){Je.remove(this,s)})}}),r.extend({queue:function(s,h,f){var m;if(s)return h=(h||"fx")+"queue",m=De.get(s,h),f&&(!m||Array.isArray(f)?m=De.access(s,h,r.makeArray(f)):m.push(f)),m||[]},dequeue:function(s,h){h=h||"fx";var f=r.queue(s,h),m=f.length,T=f.shift(),L=r._queueHooks(s,h),O=function(){r.dequeue(s,h)};T==="inprogress"&&(T=f.shift(),m--),T&&(h==="fx"&&f.unshift("inprogress"),delete L.stop,T.call(s,O,L)),!m&&L&&L.empty.fire()},_queueHooks:function(s,h){var f=h+"queueHooks";return De.get(s,f)||De.access(s,f,{empty:r.Callbacks("once memory").add(function(){De.remove(s,[h+"queue",f])})})}}),r.fn.extend({queue:function(s,h){var f=2;return typeof s!="string"&&(h=s,s="fx",f--),arguments.length<f?r.queue(this[0],s):h===void 0?this:this.each(function(){var m=r.queue(this,s,h);r._queueHooks(this,s),s==="fx"&&m[0]!=="inprogress"&&r.dequeue(this,s)})},dequeue:function(s){return this.each(function(){r.dequeue(this,s)})},clearQueue:function(s){return this.queue(s||"fx",[])},promise:function(s,h){var f,m=1,T=r.Deferred(),L=this,O=this.length,J=function(){--m||T.resolveWith(L,[L])};for(typeof s!="string"&&(h=s,s=void 0),s=s||"fx";O--;)f=De.get(L[O],s+"queueHooks"),f&&f.empty&&(m++,f.empty.add(J));return J(),T.promise(h)}});var _n=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Er=new RegExp("^(?:([+-])=|)("+_n+")([a-z%]*)$","i"),Et=["Top","Right","Bottom","Left"],Ut=v.documentElement,ir=function(s){return r.contains(s.ownerDocument,s)},so={composed:!0};Ut.getRootNode&&(ir=function(s){return r.contains(s.ownerDocument,s)||s.getRootNode(so)===s.ownerDocument});var ui=function(s,h){return s=h||s,s.style.display==="none"||s.style.display===""&&ir(s)&&r.css(s,"display")==="none"};function pn(s,h,f,m){var T,L,O=20,J=m?function(){return m.cur()}:function(){return r.css(s,h,"")},U=J(),Z=f&&f[3]||(r.cssNumber[h]?"":"px"),$=s.nodeType&&(r.cssNumber[h]||Z!=="px"&&+U)&&Er.exec(r.css(s,h));if($&&$[3]!==Z){for(U=U/2,Z=Z||$[3],$=+U||1;O--;)r.style(s,h,$+Z),(1-L)*(1-(L=J()/U||.5))<=0&&(O=0),$=$/L;$=$*2,r.style(s,h,$+Z),f=f||[]}return f&&($=+$||+U||0,T=f[1]?$+(f[1]+1)*f[2]:+f[2],m&&(m.unit=Z,m.start=$,m.end=T)),T}var gn={};function no(s){var h,f=s.ownerDocument,m=s.nodeName,T=gn[m];return T||(h=f.body.appendChild(f.createElement(m)),T=r.css(h,"display"),h.parentNode.removeChild(h),T==="none"&&(T="block"),gn[m]=T,T)}function sr(s,h){for(var f,m,T=[],L=0,O=s.length;L<O;L++)m=s[L],m.style&&(f=m.style.display,h?(f==="none"&&(T[L]=De.get(m,"display")||null,T[L]||(m.style.display="")),m.style.display===""&&ui(m)&&(T[L]=no(m))):f!=="none"&&(T[L]="none",De.set(m,"display",f)));for(L=0;L<O;L++)T[L]!=null&&(s[L].style.display=T[L]);return s}r.fn.extend({show:function(){return sr(this,!0)},hide:function(){return sr(this)},toggle:function(s){return typeof s=="boolean"?s?this.show():this.hide():this.each(function(){ui(this)?r(this).show():r(this).hide()})}});var xr=/^(?:checkbox|radio)$/i,vn=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,mn=/^$|^module$|\/(?:java|ecma)script/i;(function(){var s=v.createDocumentFragment(),h=s.appendChild(v.createElement("div")),f=v.createElement("input");f.setAttribute("type","radio"),f.setAttribute("checked","checked"),f.setAttribute("name","t"),h.appendChild(f),S.checkClone=h.cloneNode(!0).cloneNode(!0).lastChild.checked,h.innerHTML="<textarea>x</textarea>",S.noCloneChecked=!!h.cloneNode(!0).lastChild.defaultValue,h.innerHTML="<option></option>",S.option=!!h.lastChild})();var gt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};gt.tbody=gt.tfoot=gt.colgroup=gt.caption=gt.thead,gt.th=gt.td,S.option||(gt.optgroup=gt.option=[1,"<select multiple='multiple'>","</select>"]);function at(s,h){var f;return typeof s.getElementsByTagName<"u"?f=s.getElementsByTagName(h||"*"):typeof s.querySelectorAll<"u"?f=s.querySelectorAll(h||"*"):f=[],h===void 0||h&&b(s,h)?r.merge([s],f):f}function ds(s,h){for(var f=0,m=s.length;f<m;f++)De.set(s[f],"globalEval",!h||De.get(h[f],"globalEval"))}var ao=/<|&#?\w+;/;function yn(s,h,f,m,T){for(var L,O,J,U,Z,$,ce=h.createDocumentFragment(),Q=[],te=0,Se=s.length;te<Se;te++)if(L=s[te],L||L===0)if(t(L)==="object")r.merge(Q,L.nodeType?[L]:L);else if(!ao.test(L))Q.push(h.createTextNode(L));else{for(O=O||ce.appendChild(h.createElement("div")),J=(vn.exec(L)||["",""])[1].toLowerCase(),U=gt[J]||gt._default,O.innerHTML=U[1]+r.htmlPrefilter(L)+U[2],$=U[0];$--;)O=O.lastChild;r.merge(Q,O.childNodes),O=ce.firstChild,O.textContent=""}for(ce.textContent="",te=0;L=Q[te++];){if(m&&r.inArray(L,m)>-1){T&&T.push(L);continue}if(Z=ir(L),O=at(ce.appendChild(L),"script"),Z&&ds(O),f)for($=0;L=O[$++];)mn.test(L.type||"")&&f.push(L)}return ce}var Dn=/^([^.]*)(?:\.(.+)|)/;function nr(){return!0}function ar(){return!1}function oo(s,h){return s===lo()==(h==="focus")}function lo(){try{return v.activeElement}catch{}}function fs(s,h,f,m,T,L){var O,J;if(typeof h=="object"){typeof f!="string"&&(m=m||f,f=void 0);for(J in h)fs(s,J,f,m,h[J],L);return s}if(m==null&&T==null?(T=f,m=f=void 0):T==null&&(typeof f=="string"?(T=m,m=void 0):(T=m,m=f,f=void 0)),T===!1)T=ar;else if(!T)return s;return L===1&&(O=T,T=function(U){return r().off(U),O.apply(this,arguments)},T.guid=O.guid||(O.guid=r.guid++)),s.each(function(){r.event.add(this,h,T,m,f)})}r.event={global:{},add:function(s,h,f,m,T){var L,O,J,U,Z,$,ce,Q,te,Se,Te,Ce=De.get(s);if(!!ve(s))for(f.handler&&(L=f,f=L.handler,T=L.selector),T&&r.find.matchesSelector(Ut,T),f.guid||(f.guid=r.guid++),(U=Ce.events)||(U=Ce.events=Object.create(null)),(O=Ce.handle)||(O=Ce.handle=function(Ye){return typeof r<"u"&&r.event.triggered!==Ye.type?r.event.dispatch.apply(s,arguments):void 0}),h=(h||"").match(ee)||[""],Z=h.length;Z--;)J=Dn.exec(h[Z])||[],te=Te=J[1],Se=(J[2]||"").split(".").sort(),te&&(ce=r.event.special[te]||{},te=(T?ce.delegateType:ce.bindType)||te,ce=r.event.special[te]||{},$=r.extend({type:te,origType:Te,data:m,handler:f,guid:f.guid,selector:T,needsContext:T&&r.expr.match.needsContext.test(T),namespace:Se.join(".")},L),(Q=U[te])||(Q=U[te]=[],Q.delegateCount=0,(!ce.setup||ce.setup.call(s,m,Se,O)===!1)&&s.addEventListener&&s.addEventListener(te,O)),ce.add&&(ce.add.call(s,$),$.handler.guid||($.handler.guid=f.guid)),T?Q.splice(Q.delegateCount++,0,$):Q.push($),r.event.global[te]=!0)},remove:function(s,h,f,m,T){var L,O,J,U,Z,$,ce,Q,te,Se,Te,Ce=De.hasData(s)&&De.get(s);if(!(!Ce||!(U=Ce.events))){for(h=(h||"").match(ee)||[""],Z=h.length;Z--;){if(J=Dn.exec(h[Z])||[],te=Te=J[1],Se=(J[2]||"").split(".").sort(),!te){for(te in U)r.event.remove(s,te+h[Z],f,m,!0);continue}for(ce=r.event.special[te]||{},te=(m?ce.delegateType:ce.bindType)||te,Q=U[te]||[],J=J[2]&&new RegExp("(^|\\.)"+Se.join("\\.(?:.*\\.|)")+"(\\.|$)"),O=L=Q.length;L--;)$=Q[L],(T||Te===$.origType)&&(!f||f.guid===$.guid)&&(!J||J.test($.namespace))&&(!m||m===$.selector||m==="**"&&$.selector)&&(Q.splice(L,1),$.selector&&Q.delegateCount--,ce.remove&&ce.remove.call(s,$));O&&!Q.length&&((!ce.teardown||ce.teardown.call(s,Se,Ce.handle)===!1)&&r.removeEvent(s,te,Ce.handle),delete U[te])}r.isEmptyObject(U)&&De.remove(s,"handle events")}},dispatch:function(s){var h,f,m,T,L,O,J=new Array(arguments.length),U=r.event.fix(s),Z=(De.get(this,"events")||Object.create(null))[U.type]||[],$=r.event.special[U.type]||{};for(J[0]=U,h=1;h<arguments.length;h++)J[h]=arguments[h];if(U.delegateTarget=this,!($.preDispatch&&$.preDispatch.call(this,U)===!1)){for(O=r.event.handlers.call(this,U,Z),h=0;(T=O[h++])&&!U.isPropagationStopped();)for(U.currentTarget=T.elem,f=0;(L=T.handlers[f++])&&!U.isImmediatePropagationStopped();)(!U.rnamespace||L.namespace===!1||U.rnamespace.test(L.namespace))&&(U.handleObj=L,U.data=L.data,m=((r.event.special[L.origType]||{}).handle||L.handler).apply(T.elem,J),m!==void 0&&(U.result=m)===!1&&(U.preventDefault(),U.stopPropagation()));return $.postDispatch&&$.postDispatch.call(this,U),U.result}},handlers:function(s,h){var f,m,T,L,O,J=[],U=h.delegateCount,Z=s.target;if(U&&Z.nodeType&&!(s.type==="click"&&s.button>=1)){for(;Z!==this;Z=Z.parentNode||this)if(Z.nodeType===1&&!(s.type==="click"&&Z.disabled===!0)){for(L=[],O={},f=0;f<U;f++)m=h[f],T=m.selector+" ",O[T]===void 0&&(O[T]=m.needsContext?r(T,this).index(Z)>-1:r.find(T,this,null,[Z]).length),O[T]&&L.push(m);L.length&&J.push({elem:Z,handlers:L})}}return Z=this,U<h.length&&J.push({elem:Z,handlers:h.slice(U)}),J},addProp:function(s,h){Object.defineProperty(r.Event.prototype,s,{enumerable:!0,configurable:!0,get:c(h)?function(){if(this.originalEvent)return h(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[s]},set:function(f){Object.defineProperty(this,s,{enumerable:!0,configurable:!0,writable:!0,value:f})}})},fix:function(s){return s[r.expando]?s:new r.Event(s)},special:{load:{noBubble:!0},click:{setup:function(s){var h=this||s;return xr.test(h.type)&&h.click&&b(h,"input")&&di(h,"click",nr),!1},trigger:function(s){var h=this||s;return xr.test(h.type)&&h.click&&b(h,"input")&&di(h,"click"),!0},_default:function(s){var h=s.target;return xr.test(h.type)&&h.click&&b(h,"input")&&De.get(h,"click")||b(h,"a")}},beforeunload:{postDispatch:function(s){s.result!==void 0&&s.originalEvent&&(s.originalEvent.returnValue=s.result)}}}};function di(s,h,f){if(!f){De.get(s,h)===void 0&&r.event.add(s,h,nr);return}De.set(s,h,!1),r.event.add(s,h,{namespace:!1,handler:function(m){var T,L,O=De.get(this,h);if(m.isTrigger&1&&this[h]){if(O.length)(r.event.special[h]||{}).delegateType&&m.stopPropagation();else if(O=B.call(arguments),De.set(this,h,O),T=f(this,h),this[h](),L=De.get(this,h),O!==L||T?De.set(this,h,!1):L={},O!==L)return m.stopImmediatePropagation(),m.preventDefault(),L&&L.value}else O.length&&(De.set(this,h,{value:r.event.trigger(r.extend(O[0],r.Event.prototype),O.slice(1),this)}),m.stopImmediatePropagation())}})}r.removeEvent=function(s,h,f){s.removeEventListener&&s.removeEventListener(h,f)},r.Event=function(s,h){if(!(this instanceof r.Event))return new r.Event(s,h);s&&s.type?(this.originalEvent=s,this.type=s.type,this.isDefaultPrevented=s.defaultPrevented||s.defaultPrevented===void 0&&s.returnValue===!1?nr:ar,this.target=s.target&&s.target.nodeType===3?s.target.parentNode:s.target,this.currentTarget=s.currentTarget,this.relatedTarget=s.relatedTarget):this.type=s,h&&r.extend(this,h),this.timeStamp=s&&s.timeStamp||Date.now(),this[r.expando]=!0},r.Event.prototype={constructor:r.Event,isDefaultPrevented:ar,isPropagationStopped:ar,isImmediatePropagationStopped:ar,isSimulated:!1,preventDefault:function(){var s=this.originalEvent;this.isDefaultPrevented=nr,s&&!this.isSimulated&&s.preventDefault()},stopPropagation:function(){var s=this.originalEvent;this.isPropagationStopped=nr,s&&!this.isSimulated&&s.stopPropagation()},stopImmediatePropagation:function(){var s=this.originalEvent;this.isImmediatePropagationStopped=nr,s&&!this.isSimulated&&s.stopImmediatePropagation(),this.stopPropagation()}},r.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},r.event.addProp),r.each({focus:"focusin",blur:"focusout"},function(s,h){r.event.special[s]={setup:function(){return di(this,s,oo),!1},trigger:function(){return di(this,s),!0},_default:function(f){return De.get(f.target,s)},delegateType:h}}),r.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(s,h){r.event.special[s]={delegateType:h,bindType:h,handle:function(f){var m,T=this,L=f.relatedTarget,O=f.handleObj;return(!L||L!==T&&!r.contains(T,L))&&(f.type=O.origType,m=O.handler.apply(this,arguments),f.type=h),m}}}),r.fn.extend({on:function(s,h,f,m){return fs(this,s,h,f,m)},one:function(s,h,f,m){return fs(this,s,h,f,m,1)},off:function(s,h,f){var m,T;if(s&&s.preventDefault&&s.handleObj)return m=s.handleObj,r(s.delegateTarget).off(m.namespace?m.origType+"."+m.namespace:m.origType,m.selector,m.handler),this;if(typeof s=="object"){for(T in s)this.off(T,h,s[T]);return this}return(h===!1||typeof h=="function")&&(f=h,h=void 0),f===!1&&(f=ar),this.each(function(){r.event.remove(this,s,f,h)})}});var co=/<script|<style|<link/i,ho=/checked\s*(?:[^=]|=\s*.checked.)/i,uo=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Cn(s,h){return b(s,"table")&&b(h.nodeType!==11?h:h.firstChild,"tr")&&r(s).children("tbody")[0]||s}function fo(s){return s.type=(s.getAttribute("type")!==null)+"/"+s.type,s}function _o(s){return(s.type||"").slice(0,5)==="true/"?s.type=s.type.slice(5):s.removeAttribute("type"),s}function Sn(s,h){var f,m,T,L,O,J,U;if(h.nodeType===1){if(De.hasData(s)&&(L=De.get(s),U=L.events,U)){De.remove(h,"handle events");for(T in U)for(f=0,m=U[T].length;f<m;f++)r.event.add(h,T,U[T][f])}Je.hasData(s)&&(O=Je.access(s),J=r.extend({},O),Je.set(h,J))}}function po(s,h){var f=h.nodeName.toLowerCase();f==="input"&&xr.test(s.type)?h.checked=s.checked:(f==="input"||f==="textarea")&&(h.defaultValue=s.defaultValue)}function or(s,h,f,m){h=u(h);var T,L,O,J,U,Z,$=0,ce=s.length,Q=ce-1,te=h[0],Se=c(te);if(Se||ce>1&&typeof te=="string"&&!S.checkClone&&ho.test(te))return s.each(function(Te){var Ce=s.eq(Te);Se&&(h[0]=te.call(this,Te,Ce.html())),or(Ce,h,f,m)});if(ce&&(T=yn(h,s[0].ownerDocument,!1,s,m),L=T.firstChild,T.childNodes.length===1&&(T=L),L||m)){for(O=r.map(at(T,"script"),fo),J=O.length;$<ce;$++)U=T,$!==Q&&(U=r.clone(U,!0,!0),J&&r.merge(O,at(U,"script"))),f.call(s[$],U,$);if(J)for(Z=O[O.length-1].ownerDocument,r.map(O,_o),$=0;$<J;$++)U=O[$],mn.test(U.type||"")&&!De.access(U,"globalEval")&&r.contains(Z,U)&&(U.src&&(U.type||"").toLowerCase()!=="module"?r._evalUrl&&!U.noModule&&r._evalUrl(U.src,{nonce:U.nonce||U.getAttribute("nonce")},Z):i(U.textContent.replace(uo,""),U,Z))}return s}function wn(s,h,f){for(var m,T=h?r.filter(h,s):s,L=0;(m=T[L])!=null;L++)!f&&m.nodeType===1&&r.cleanData(at(m)),m.parentNode&&(f&&ir(m)&&ds(at(m,"script")),m.parentNode.removeChild(m));return s}r.extend({htmlPrefilter:function(s){return s},clone:function(s,h,f){var m,T,L,O,J=s.cloneNode(!0),U=ir(s);if(!S.noCloneChecked&&(s.nodeType===1||s.nodeType===11)&&!r.isXMLDoc(s))for(O=at(J),L=at(s),m=0,T=L.length;m<T;m++)po(L[m],O[m]);if(h)if(f)for(L=L||at(s),O=O||at(J),m=0,T=L.length;m<T;m++)Sn(L[m],O[m]);else Sn(s,J);return O=at(J,"script"),O.length>0&&ds(O,!U&&at(s,"script")),J},cleanData:function(s){for(var h,f,m,T=r.event.special,L=0;(f=s[L])!==void 0;L++)if(ve(f)){if(h=f[De.expando]){if(h.events)for(m in h.events)T[m]?r.event.remove(f,m):r.removeEvent(f,m,h.handle);f[De.expando]=void 0}f[Je.expando]&&(f[Je.expando]=void 0)}}}),r.fn.extend({detach:function(s){return wn(this,s,!0)},remove:function(s){return wn(this,s)},text:function(s){return de(this,function(h){return h===void 0?r.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=h)})},null,s,arguments.length)},append:function(){return or(this,arguments,function(s){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var h=Cn(this,s);h.appendChild(s)}})},prepend:function(){return or(this,arguments,function(s){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var h=Cn(this,s);h.insertBefore(s,h.firstChild)}})},before:function(){return or(this,arguments,function(s){this.parentNode&&this.parentNode.insertBefore(s,this)})},after:function(){return or(this,arguments,function(s){this.parentNode&&this.parentNode.insertBefore(s,this.nextSibling)})},empty:function(){for(var s,h=0;(s=this[h])!=null;h++)s.nodeType===1&&(r.cleanData(at(s,!1)),s.textContent="");return this},clone:function(s,h){return s=s==null?!1:s,h=h==null?s:h,this.map(function(){return r.clone(this,s,h)})},html:function(s){return de(this,function(h){var f=this[0]||{},m=0,T=this.length;if(h===void 0&&f.nodeType===1)return f.innerHTML;if(typeof h=="string"&&!co.test(h)&&!gt[(vn.exec(h)||["",""])[1].toLowerCase()]){h=r.htmlPrefilter(h);try{for(;m<T;m++)f=this[m]||{},f.nodeType===1&&(r.cleanData(at(f,!1)),f.innerHTML=h);f=0}catch{}}f&&this.empty().append(h)},null,s,arguments.length)},replaceWith:function(){var s=[];return or(this,arguments,function(h){var f=this.parentNode;r.inArray(this,s)<0&&(r.cleanData(at(this)),f&&f.replaceChild(h,this))},s)}}),r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(s,h){r.fn[s]=function(f){for(var m,T=[],L=r(f),O=L.length-1,J=0;J<=O;J++)m=J===O?this:this.clone(!0),r(L[J])[h](m),_.apply(T,m.get());return this.pushStack(T)}});var _s=new RegExp("^("+_n+")(?!px)[a-z%]+$","i"),ps=/^--/,fi=function(s){var h=s.ownerDocument.defaultView;return(!h||!h.opener)&&(h=o),h.getComputedStyle(s)},bn=function(s,h,f){var m,T,L={};for(T in h)L[T]=s.style[T],s.style[T]=h[T];m=f.call(s);for(T in h)s.style[T]=L[T];return m},go=new RegExp(Et.join("|"),"i"),Rn="[\\x20\\t\\r\\n\\f]",vo=new RegExp("^"+Rn+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Rn+"+$","g");(function(){function s(){if(!!Z){U.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Z.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Ut.appendChild(U).appendChild(Z);var $=o.getComputedStyle(Z);f=$.top!=="1%",J=h($.marginLeft)===12,Z.style.right="60%",L=h($.right)===36,m=h($.width)===36,Z.style.position="absolute",T=h(Z.offsetWidth/3)===12,Ut.removeChild(U),Z=null}}function h($){return Math.round(parseFloat($))}var f,m,T,L,O,J,U=v.createElement("div"),Z=v.createElement("div");!Z.style||(Z.style.backgroundClip="content-box",Z.cloneNode(!0).style.backgroundClip="",S.clearCloneStyle=Z.style.backgroundClip==="content-box",r.extend(S,{boxSizingReliable:function(){return s(),m},pixelBoxStyles:function(){return s(),L},pixelPosition:function(){return s(),f},reliableMarginLeft:function(){return s(),J},scrollboxSize:function(){return s(),T},reliableTrDimensions:function(){var $,ce,Q,te;return O==null&&($=v.createElement("table"),ce=v.createElement("tr"),Q=v.createElement("div"),$.style.cssText="position:absolute;left:-11111px;border-collapse:separate",ce.style.cssText="border:1px solid",ce.style.height="1px",Q.style.height="9px",Q.style.display="block",Ut.appendChild($).appendChild(ce).appendChild(Q),te=o.getComputedStyle(ce),O=parseInt(te.height,10)+parseInt(te.borderTopWidth,10)+parseInt(te.borderBottomWidth,10)===ce.offsetHeight,Ut.removeChild($)),O}}))})();function kr(s,h,f){var m,T,L,O,J=ps.test(h),U=s.style;return f=f||fi(s),f&&(O=f.getPropertyValue(h)||f[h],J&&O&&(O=O.replace(vo,"$1")||void 0),O===""&&!ir(s)&&(O=r.style(s,h)),!S.pixelBoxStyles()&&_s.test(O)&&go.test(h)&&(m=U.width,T=U.minWidth,L=U.maxWidth,U.minWidth=U.maxWidth=U.width=O,O=f.width,U.width=m,U.minWidth=T,U.maxWidth=L)),O!==void 0?O+"":O}function En(s,h){return{get:function(){if(s()){delete this.get;return}return(this.get=h).apply(this,arguments)}}}var xn=["Webkit","Moz","ms"],kn=v.createElement("div").style,Tn={};function mo(s){for(var h=s[0].toUpperCase()+s.slice(1),f=xn.length;f--;)if(s=xn[f]+h,s in kn)return s}function gs(s){var h=r.cssProps[s]||Tn[s];return h||(s in kn?s:Tn[s]=mo(s)||s)}var yo=/^(none|table(?!-c[ea]).+)/,Do={position:"absolute",visibility:"hidden",display:"block"},An={letterSpacing:"0",fontWeight:"400"};function Ln(s,h,f){var m=Er.exec(h);return m?Math.max(0,m[2]-(f||0))+(m[3]||"px"):h}function vs(s,h,f,m,T,L){var O=h==="width"?1:0,J=0,U=0;if(f===(m?"border":"content"))return 0;for(;O<4;O+=2)f==="margin"&&(U+=r.css(s,f+Et[O],!0,T)),m?(f==="content"&&(U-=r.css(s,"padding"+Et[O],!0,T)),f!=="margin"&&(U-=r.css(s,"border"+Et[O]+"Width",!0,T))):(U+=r.css(s,"padding"+Et[O],!0,T),f!=="padding"?U+=r.css(s,"border"+Et[O]+"Width",!0,T):J+=r.css(s,"border"+Et[O]+"Width",!0,T));return!m&&L>=0&&(U+=Math.max(0,Math.ceil(s["offset"+h[0].toUpperCase()+h.slice(1)]-L-U-J-.5))||0),U}function Pn(s,h,f){var m=fi(s),T=!S.boxSizingReliable()||f,L=T&&r.css(s,"boxSizing",!1,m)==="border-box",O=L,J=kr(s,h,m),U="offset"+h[0].toUpperCase()+h.slice(1);if(_s.test(J)){if(!f)return J;J="auto"}return(!S.boxSizingReliable()&&L||!S.reliableTrDimensions()&&b(s,"tr")||J==="auto"||!parseFloat(J)&&r.css(s,"display",!1,m)==="inline")&&s.getClientRects().length&&(L=r.css(s,"boxSizing",!1,m)==="border-box",O=U in s,O&&(J=s[U])),J=parseFloat(J)||0,J+vs(s,h,f||(L?"border":"content"),O,m,J)+"px"}r.extend({cssHooks:{opacity:{get:function(s,h){if(h){var f=kr(s,"opacity");return f===""?"1":f}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(s,h,f,m){if(!(!s||s.nodeType===3||s.nodeType===8||!s.style)){var T,L,O,J=Ae(h),U=ps.test(h),Z=s.style;if(U||(h=gs(J)),O=r.cssHooks[h]||r.cssHooks[J],f!==void 0){if(L=typeof f,L==="string"&&(T=Er.exec(f))&&T[1]&&(f=pn(s,h,T),L="number"),f==null||f!==f)return;L==="number"&&!U&&(f+=T&&T[3]||(r.cssNumber[J]?"":"px")),!S.clearCloneStyle&&f===""&&h.indexOf("background")===0&&(Z[h]="inherit"),(!O||!("set"in O)||(f=O.set(s,f,m))!==void 0)&&(U?Z.setProperty(h,f):Z[h]=f)}else return O&&"get"in O&&(T=O.get(s,!1,m))!==void 0?T:Z[h]}},css:function(s,h,f,m){var T,L,O,J=Ae(h),U=ps.test(h);return U||(h=gs(J)),O=r.cssHooks[h]||r.cssHooks[J],O&&"get"in O&&(T=O.get(s,!0,f)),T===void 0&&(T=kr(s,h,m)),T==="normal"&&h in An&&(T=An[h]),f===""||f?(L=parseFloat(T),f===!0||isFinite(L)?L||0:T):T}}),r.each(["height","width"],function(s,h){r.cssHooks[h]={get:function(f,m,T){if(m)return yo.test(r.css(f,"display"))&&(!f.getClientRects().length||!f.getBoundingClientRect().width)?bn(f,Do,function(){return Pn(f,h,T)}):Pn(f,h,T)},set:function(f,m,T){var L,O=fi(f),J=!S.scrollboxSize()&&O.position==="absolute",U=J||T,Z=U&&r.css(f,"boxSizing",!1,O)==="border-box",$=T?vs(f,h,T,Z,O):0;return Z&&J&&($-=Math.ceil(f["offset"+h[0].toUpperCase()+h.slice(1)]-parseFloat(O[h])-vs(f,h,"border",!1,O)-.5)),$&&(L=Er.exec(m))&&(L[3]||"px")!=="px"&&(f.style[h]=m,m=r.css(f,h)),Ln(f,m,$)}}}),r.cssHooks.marginLeft=En(S.reliableMarginLeft,function(s,h){if(h)return(parseFloat(kr(s,"marginLeft"))||s.getBoundingClientRect().left-bn(s,{marginLeft:0},function(){return s.getBoundingClientRect().left}))+"px"}),r.each({margin:"",padding:"",border:"Width"},function(s,h){r.cssHooks[s+h]={expand:function(f){for(var m=0,T={},L=typeof f=="string"?f.split(" "):[f];m<4;m++)T[s+Et[m]+h]=L[m]||L[m-2]||L[0];return T}},s!=="margin"&&(r.cssHooks[s+h].set=Ln)}),r.fn.extend({css:function(s,h){return de(this,function(f,m,T){var L,O,J={},U=0;if(Array.isArray(m)){for(L=fi(f),O=m.length;U<O;U++)J[m[U]]=r.css(f,m[U],!1,L);return J}return T!==void 0?r.style(f,m,T):r.css(f,m)},s,h,arguments.length>1)}});function ot(s,h,f,m,T){return new ot.prototype.init(s,h,f,m,T)}r.Tween=ot,ot.prototype={constructor:ot,init:function(s,h,f,m,T,L){this.elem=s,this.prop=f,this.easing=T||r.easing._default,this.options=h,this.start=this.now=this.cur(),this.end=m,this.unit=L||(r.cssNumber[f]?"":"px")},cur:function(){var s=ot.propHooks[this.prop];return s&&s.get?s.get(this):ot.propHooks._default.get(this)},run:function(s){var h,f=ot.propHooks[this.prop];return this.options.duration?this.pos=h=r.easing[this.easing](s,this.options.duration*s,0,1,this.options.duration):this.pos=h=s,this.now=(this.end-this.start)*h+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),f&&f.set?f.set(this):ot.propHooks._default.set(this),this}},ot.prototype.init.prototype=ot.prototype,ot.propHooks={_default:{get:function(s){var h;return s.elem.nodeType!==1||s.elem[s.prop]!=null&&s.elem.style[s.prop]==null?s.elem[s.prop]:(h=r.css(s.elem,s.prop,""),!h||h==="auto"?0:h)},set:function(s){r.fx.step[s.prop]?r.fx.step[s.prop](s):s.elem.nodeType===1&&(r.cssHooks[s.prop]||s.elem.style[gs(s.prop)]!=null)?r.style(s.elem,s.prop,s.now+s.unit):s.elem[s.prop]=s.now}}},ot.propHooks.scrollTop=ot.propHooks.scrollLeft={set:function(s){s.elem.nodeType&&s.elem.parentNode&&(s.elem[s.prop]=s.now)}},r.easing={linear:function(s){return s},swing:function(s){return .5-Math.cos(s*Math.PI)/2},_default:"swing"},r.fx=ot.prototype.init,r.fx.step={};var lr,_i,Co=/^(?:toggle|show|hide)$/,So=/queueHooks$/;function ms(){_i&&(v.hidden===!1&&o.requestAnimationFrame?o.requestAnimationFrame(ms):o.setTimeout(ms,r.fx.interval),r.fx.tick())}function Fn(){return o.setTimeout(function(){lr=void 0}),lr=Date.now()}function pi(s,h){var f,m=0,T={height:s};for(h=h?1:0;m<4;m+=2-h)f=Et[m],T["margin"+f]=T["padding"+f]=s;return h&&(T.opacity=T.width=s),T}function On(s,h,f){for(var m,T=(yt.tweeners[h]||[]).concat(yt.tweeners["*"]),L=0,O=T.length;L<O;L++)if(m=T[L].call(f,h,s))return m}function wo(s,h,f){var m,T,L,O,J,U,Z,$,ce="width"in h||"height"in h,Q=this,te={},Se=s.style,Te=s.nodeType&&ui(s),Ce=De.get(s,"fxshow");f.queue||(O=r._queueHooks(s,"fx"),O.unqueued==null&&(O.unqueued=0,J=O.empty.fire,O.empty.fire=function(){O.unqueued||J()}),O.unqueued++,Q.always(function(){Q.always(function(){O.unqueued--,r.queue(s,"fx").length||O.empty.fire()})}));for(m in h)if(T=h[m],Co.test(T)){if(delete h[m],L=L||T==="toggle",T===(Te?"hide":"show"))if(T==="show"&&Ce&&Ce[m]!==void 0)Te=!0;else continue;te[m]=Ce&&Ce[m]||r.style(s,m)}if(U=!r.isEmptyObject(h),!(!U&&r.isEmptyObject(te))){ce&&s.nodeType===1&&(f.overflow=[Se.overflow,Se.overflowX,Se.overflowY],Z=Ce&&Ce.display,Z==null&&(Z=De.get(s,"display")),$=r.css(s,"display"),$==="none"&&(Z?$=Z:(sr([s],!0),Z=s.style.display||Z,$=r.css(s,"display"),sr([s]))),($==="inline"||$==="inline-block"&&Z!=null)&&r.css(s,"float")==="none"&&(U||(Q.done(function(){Se.display=Z}),Z==null&&($=Se.display,Z=$==="none"?"":$)),Se.display="inline-block")),f.overflow&&(Se.overflow="hidden",Q.always(function(){Se.overflow=f.overflow[0],Se.overflowX=f.overflow[1],Se.overflowY=f.overflow[2]})),U=!1;for(m in te)U||(Ce?"hidden"in Ce&&(Te=Ce.hidden):Ce=De.access(s,"fxshow",{display:Z}),L&&(Ce.hidden=!Te),Te&&sr([s],!0),Q.done(function(){Te||sr([s]),De.remove(s,"fxshow");for(m in te)r.style(s,m,te[m])})),U=On(Te?Ce[m]:0,m,Q),m in Ce||(Ce[m]=U.start,Te&&(U.end=U.start,U.start=0))}}function bo(s,h){var f,m,T,L,O;for(f in s)if(m=Ae(f),T=h[m],L=s[f],Array.isArray(L)&&(T=L[1],L=s[f]=L[0]),f!==m&&(s[m]=L,delete s[f]),O=r.cssHooks[m],O&&"expand"in O){L=O.expand(L),delete s[m];for(f in L)f in s||(s[f]=L[f],h[f]=T)}else h[m]=T}function yt(s,h,f){var m,T,L=0,O=yt.prefilters.length,J=r.Deferred().always(function(){delete U.elem}),U=function(){if(T)return!1;for(var ce=lr||Fn(),Q=Math.max(0,Z.startTime+Z.duration-ce),te=Q/Z.duration||0,Se=1-te,Te=0,Ce=Z.tweens.length;Te<Ce;Te++)Z.tweens[Te].run(Se);return J.notifyWith(s,[Z,Se,Q]),Se<1&&Ce?Q:(Ce||J.notifyWith(s,[Z,1,0]),J.resolveWith(s,[Z]),!1)},Z=J.promise({elem:s,props:r.extend({},h),opts:r.extend(!0,{specialEasing:{},easing:r.easing._default},f),originalProperties:h,originalOptions:f,startTime:lr||Fn(),duration:f.duration,tweens:[],createTween:function(ce,Q){var te=r.Tween(s,Z.opts,ce,Q,Z.opts.specialEasing[ce]||Z.opts.easing);return Z.tweens.push(te),te},stop:function(ce){var Q=0,te=ce?Z.tweens.length:0;if(T)return this;for(T=!0;Q<te;Q++)Z.tweens[Q].run(1);return ce?(J.notifyWith(s,[Z,1,0]),J.resolveWith(s,[Z,ce])):J.rejectWith(s,[Z,ce]),this}}),$=Z.props;for(bo($,Z.opts.specialEasing);L<O;L++)if(m=yt.prefilters[L].call(Z,s,$,Z.opts),m)return c(m.stop)&&(r._queueHooks(Z.elem,Z.opts.queue).stop=m.stop.bind(m)),m;return r.map($,On,Z),c(Z.opts.start)&&Z.opts.start.call(s,Z),Z.progress(Z.opts.progress).done(Z.opts.done,Z.opts.complete).fail(Z.opts.fail).always(Z.opts.always),r.fx.timer(r.extend(U,{elem:s,anim:Z,queue:Z.opts.queue})),Z}r.Animation=r.extend(yt,{tweeners:{"*":[function(s,h){var f=this.createTween(s,h);return pn(f.elem,s,Er.exec(h),f),f}]},tweener:function(s,h){c(s)?(h=s,s=["*"]):s=s.match(ee);for(var f,m=0,T=s.length;m<T;m++)f=s[m],yt.tweeners[f]=yt.tweeners[f]||[],yt.tweeners[f].unshift(h)},prefilters:[wo],prefilter:function(s,h){h?yt.prefilters.unshift(s):yt.prefilters.push(s)}}),r.speed=function(s,h,f){var m=s&&typeof s=="object"?r.extend({},s):{complete:f||!f&&h||c(s)&&s,duration:s,easing:f&&h||h&&!c(h)&&h};return r.fx.off?m.duration=0:typeof m.duration!="number"&&(m.duration in r.fx.speeds?m.duration=r.fx.speeds[m.duration]:m.duration=r.fx.speeds._default),(m.queue==null||m.queue===!0)&&(m.queue="fx"),m.old=m.complete,m.complete=function(){c(m.old)&&m.old.call(this),m.queue&&r.dequeue(this,m.queue)},m},r.fn.extend({fadeTo:function(s,h,f,m){return this.filter(ui).css("opacity",0).show().end().animate({opacity:h},s,f,m)},animate:function(s,h,f,m){var T=r.isEmptyObject(s),L=r.speed(h,f,m),O=function(){var J=yt(this,r.extend({},s),L);(T||De.get(this,"finish"))&&J.stop(!0)};return O.finish=O,T||L.queue===!1?this.each(O):this.queue(L.queue,O)},stop:function(s,h,f){var m=function(T){var L=T.stop;delete T.stop,L(f)};return typeof s!="string"&&(f=h,h=s,s=void 0),h&&this.queue(s||"fx",[]),this.each(function(){var T=!0,L=s!=null&&s+"queueHooks",O=r.timers,J=De.get(this);if(L)J[L]&&J[L].stop&&m(J[L]);else for(L in J)J[L]&&J[L].stop&&So.test(L)&&m(J[L]);for(L=O.length;L--;)O[L].elem===this&&(s==null||O[L].queue===s)&&(O[L].anim.stop(f),T=!1,O.splice(L,1));(T||!f)&&r.dequeue(this,s)})},finish:function(s){return s!==!1&&(s=s||"fx"),this.each(function(){var h,f=De.get(this),m=f[s+"queue"],T=f[s+"queueHooks"],L=r.timers,O=m?m.length:0;for(f.finish=!0,r.queue(this,s,[]),T&&T.stop&&T.stop.call(this,!0),h=L.length;h--;)L[h].elem===this&&L[h].queue===s&&(L[h].anim.stop(!0),L.splice(h,1));for(h=0;h<O;h++)m[h]&&m[h].finish&&m[h].finish.call(this);delete f.finish})}}),r.each(["toggle","show","hide"],function(s,h){var f=r.fn[h];r.fn[h]=function(m,T,L){return m==null||typeof m=="boolean"?f.apply(this,arguments):this.animate(pi(h,!0),m,T,L)}}),r.each({slideDown:pi("show"),slideUp:pi("hide"),slideToggle:pi("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(s,h){r.fn[s]=function(f,m,T){return this.animate(h,f,m,T)}}),r.timers=[],r.fx.tick=function(){var s,h=0,f=r.timers;for(lr=Date.now();h<f.length;h++)s=f[h],!s()&&f[h]===s&&f.splice(h--,1);f.length||r.fx.stop(),lr=void 0},r.fx.timer=function(s){r.timers.push(s),r.fx.start()},r.fx.interval=13,r.fx.start=function(){_i||(_i=!0,ms())},r.fx.stop=function(){_i=null},r.fx.speeds={slow:600,fast:200,_default:400},r.fn.delay=function(s,h){return s=r.fx&&r.fx.speeds[s]||s,h=h||"fx",this.queue(h,function(f,m){var T=o.setTimeout(f,s);m.stop=function(){o.clearTimeout(T)}})},function(){var s=v.createElement("input"),h=v.createElement("select"),f=h.appendChild(v.createElement("option"));s.type="checkbox",S.checkOn=s.value!=="",S.optSelected=f.selected,s=v.createElement("input"),s.value="t",s.type="radio",S.radioValue=s.value==="t"}();var Bn,Tr=r.expr.attrHandle;r.fn.extend({attr:function(s,h){return de(this,r.attr,s,h,arguments.length>1)},removeAttr:function(s){return this.each(function(){r.removeAttr(this,s)})}}),r.extend({attr:function(s,h,f){var m,T,L=s.nodeType;if(!(L===3||L===8||L===2)){if(typeof s.getAttribute>"u")return r.prop(s,h,f);if((L!==1||!r.isXMLDoc(s))&&(T=r.attrHooks[h.toLowerCase()]||(r.expr.match.bool.test(h)?Bn:void 0)),f!==void 0){if(f===null){r.removeAttr(s,h);return}return T&&"set"in T&&(m=T.set(s,f,h))!==void 0?m:(s.setAttribute(h,f+""),f)}return T&&"get"in T&&(m=T.get(s,h))!==null?m:(m=r.find.attr(s,h),m==null?void 0:m)}},attrHooks:{type:{set:function(s,h){if(!S.radioValue&&h==="radio"&&b(s,"input")){var f=s.value;return s.setAttribute("type",h),f&&(s.value=f),h}}}},removeAttr:function(s,h){var f,m=0,T=h&&h.match(ee);if(T&&s.nodeType===1)for(;f=T[m++];)s.removeAttribute(f)}}),Bn={set:function(s,h,f){return h===!1?r.removeAttr(s,f):s.setAttribute(f,f),f}},r.each(r.expr.match.bool.source.match(/\w+/g),function(s,h){var f=Tr[h]||r.find.attr;Tr[h]=function(m,T,L){var O,J,U=T.toLowerCase();return L||(J=Tr[U],Tr[U]=O,O=f(m,T,L)!=null?U:null,Tr[U]=J),O}});var Ro=/^(?:input|select|textarea|button)$/i,Eo=/^(?:a|area)$/i;r.fn.extend({prop:function(s,h){return de(this,r.prop,s,h,arguments.length>1)},removeProp:function(s){return this.each(function(){delete this[r.propFix[s]||s]})}}),r.extend({prop:function(s,h,f){var m,T,L=s.nodeType;if(!(L===3||L===8||L===2))return(L!==1||!r.isXMLDoc(s))&&(h=r.propFix[h]||h,T=r.propHooks[h]),f!==void 0?T&&"set"in T&&(m=T.set(s,f,h))!==void 0?m:s[h]=f:T&&"get"in T&&(m=T.get(s,h))!==null?m:s[h]},propHooks:{tabIndex:{get:function(s){var h=r.find.attr(s,"tabindex");return h?parseInt(h,10):Ro.test(s.nodeName)||Eo.test(s.nodeName)&&s.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),S.optSelected||(r.propHooks.selected={get:function(s){var h=s.parentNode;return h&&h.parentNode&&h.parentNode.selectedIndex,null},set:function(s){var h=s.parentNode;h&&(h.selectedIndex,h.parentNode&&h.parentNode.selectedIndex)}}),r.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){r.propFix[this.toLowerCase()]=this});function qt(s){var h=s.match(ee)||[];return h.join(" ")}function zt(s){return s.getAttribute&&s.getAttribute("class")||""}function ys(s){return Array.isArray(s)?s:typeof s=="string"?s.match(ee)||[]:[]}r.fn.extend({addClass:function(s){var h,f,m,T,L,O;return c(s)?this.each(function(J){r(this).addClass(s.call(this,J,zt(this)))}):(h=ys(s),h.length?this.each(function(){if(m=zt(this),f=this.nodeType===1&&" "+qt(m)+" ",f){for(L=0;L<h.length;L++)T=h[L],f.indexOf(" "+T+" ")<0&&(f+=T+" ");O=qt(f),m!==O&&this.setAttribute("class",O)}}):this)},removeClass:function(s){var h,f,m,T,L,O;return c(s)?this.each(function(J){r(this).removeClass(s.call(this,J,zt(this)))}):arguments.length?(h=ys(s),h.length?this.each(function(){if(m=zt(this),f=this.nodeType===1&&" "+qt(m)+" ",f){for(L=0;L<h.length;L++)for(T=h[L];f.indexOf(" "+T+" ")>-1;)f=f.replace(" "+T+" "," ");O=qt(f),m!==O&&this.setAttribute("class",O)}}):this):this.attr("class","")},toggleClass:function(s,h){var f,m,T,L,O=typeof s,J=O==="string"||Array.isArray(s);return c(s)?this.each(function(U){r(this).toggleClass(s.call(this,U,zt(this),h),h)}):typeof h=="boolean"&&J?h?this.addClass(s):this.removeClass(s):(f=ys(s),this.each(function(){if(J)for(L=r(this),T=0;T<f.length;T++)m=f[T],L.hasClass(m)?L.removeClass(m):L.addClass(m);else(s===void 0||O==="boolean")&&(m=zt(this),m&&De.set(this,"__className__",m),this.setAttribute&&this.setAttribute("class",m||s===!1?"":De.get(this,"__className__")||""))}))},hasClass:function(s){var h,f,m=0;for(h=" "+s+" ";f=this[m++];)if(f.nodeType===1&&(" "+qt(zt(f))+" ").indexOf(h)>-1)return!0;return!1}});var xo=/\r/g;r.fn.extend({val:function(s){var h,f,m,T=this[0];return arguments.length?(m=c(s),this.each(function(L){var O;this.nodeType===1&&(m?O=s.call(this,L,r(this).val()):O=s,O==null?O="":typeof O=="number"?O+="":Array.isArray(O)&&(O=r.map(O,function(J){return J==null?"":J+""})),h=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],(!h||!("set"in h)||h.set(this,O,"value")===void 0)&&(this.value=O))})):T?(h=r.valHooks[T.type]||r.valHooks[T.nodeName.toLowerCase()],h&&"get"in h&&(f=h.get(T,"value"))!==void 0?f:(f=T.value,typeof f=="string"?f.replace(xo,""):f==null?"":f)):void 0}}),r.extend({valHooks:{option:{get:function(s){var h=r.find.attr(s,"value");return h!=null?h:qt(r.text(s))}},select:{get:function(s){var h,f,m,T=s.options,L=s.selectedIndex,O=s.type==="select-one",J=O?null:[],U=O?L+1:T.length;for(L<0?m=U:m=O?L:0;m<U;m++)if(f=T[m],(f.selected||m===L)&&!f.disabled&&(!f.parentNode.disabled||!b(f.parentNode,"optgroup"))){if(h=r(f).val(),O)return h;J.push(h)}return J},set:function(s,h){for(var f,m,T=s.options,L=r.makeArray(h),O=T.length;O--;)m=T[O],(m.selected=r.inArray(r.valHooks.option.get(m),L)>-1)&&(f=!0);return f||(s.selectedIndex=-1),L}}}}),r.each(["radio","checkbox"],function(){r.valHooks[this]={set:function(s,h){if(Array.isArray(h))return s.checked=r.inArray(r(s).val(),h)>-1}},S.checkOn||(r.valHooks[this].get=function(s){return s.getAttribute("value")===null?"on":s.value})}),S.focusin="onfocusin"in o;var Mn=/^(?:focusinfocus|focusoutblur)$/,In=function(s){s.stopPropagation()};r.extend(r.event,{trigger:function(s,h,f,m){var T,L,O,J,U,Z,$,ce,Q=[f||v],te=x.call(s,"type")?s.type:s,Se=x.call(s,"namespace")?s.namespace.split("."):[];if(L=ce=O=f=f||v,!(f.nodeType===3||f.nodeType===8)&&!Mn.test(te+r.event.triggered)&&(te.indexOf(".")>-1&&(Se=te.split("."),te=Se.shift(),Se.sort()),U=te.indexOf(":")<0&&"on"+te,s=s[r.expando]?s:new r.Event(te,typeof s=="object"&&s),s.isTrigger=m?2:3,s.namespace=Se.join("."),s.rnamespace=s.namespace?new RegExp("(^|\\.)"+Se.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,s.result=void 0,s.target||(s.target=f),h=h==null?[s]:r.makeArray(h,[s]),$=r.event.special[te]||{},!(!m&&$.trigger&&$.trigger.apply(f,h)===!1))){if(!m&&!$.noBubble&&!p(f)){for(J=$.delegateType||te,Mn.test(J+te)||(L=L.parentNode);L;L=L.parentNode)Q.push(L),O=L;O===(f.ownerDocument||v)&&Q.push(O.defaultView||O.parentWindow||o)}for(T=0;(L=Q[T++])&&!s.isPropagationStopped();)ce=L,s.type=T>1?J:$.bindType||te,Z=(De.get(L,"events")||Object.create(null))[s.type]&&De.get(L,"handle"),Z&&Z.apply(L,h),Z=U&&L[U],Z&&Z.apply&&ve(L)&&(s.result=Z.apply(L,h),s.result===!1&&s.preventDefault());return s.type=te,!m&&!s.isDefaultPrevented()&&(!$._default||$._default.apply(Q.pop(),h)===!1)&&ve(f)&&U&&c(f[te])&&!p(f)&&(O=f[U],O&&(f[U]=null),r.event.triggered=te,s.isPropagationStopped()&&ce.addEventListener(te,In),f[te](),s.isPropagationStopped()&&ce.removeEventListener(te,In),r.event.triggered=void 0,O&&(f[U]=O)),s.result}},simulate:function(s,h,f){var m=r.extend(new r.Event,f,{type:s,isSimulated:!0});r.event.trigger(m,null,h)}}),r.fn.extend({trigger:function(s,h){return this.each(function(){r.event.trigger(s,h,this)})},triggerHandler:function(s,h){var f=this[0];if(f)return r.event.trigger(s,h,f,!0)}}),S.focusin||r.each({focus:"focusin",blur:"focusout"},function(s,h){var f=function(m){r.event.simulate(h,m.target,r.event.fix(m))};r.event.special[h]={setup:function(){var m=this.ownerDocument||this.document||this,T=De.access(m,h);T||m.addEventListener(s,f,!0),De.access(m,h,(T||0)+1)},teardown:function(){var m=this.ownerDocument||this.document||this,T=De.access(m,h)-1;T?De.access(m,h,T):(m.removeEventListener(s,f,!0),De.remove(m,h))}}});var Ar=o.location,Nn={guid:Date.now()},Ds=/\?/;r.parseXML=function(s){var h,f;if(!s||typeof s!="string")return null;try{h=new o.DOMParser().parseFromString(s,"text/xml")}catch{}return f=h&&h.getElementsByTagName("parsererror")[0],(!h||f)&&r.error("Invalid XML: "+(f?r.map(f.childNodes,function(m){return m.textContent}).join(`
`):s)),h};var ko=/\[\]$/,Hn=/\r?\n/g,To=/^(?:submit|button|image|reset|file)$/i,Ao=/^(?:input|select|textarea|keygen)/i;function Cs(s,h,f,m){var T;if(Array.isArray(h))r.each(h,function(L,O){f||ko.test(s)?m(s,O):Cs(s+"["+(typeof O=="object"&&O!=null?L:"")+"]",O,f,m)});else if(!f&&t(h)==="object")for(T in h)Cs(s+"["+T+"]",h[T],f,m);else m(s,h)}r.param=function(s,h){var f,m=[],T=function(L,O){var J=c(O)?O():O;m[m.length]=encodeURIComponent(L)+"="+encodeURIComponent(J==null?"":J)};if(s==null)return"";if(Array.isArray(s)||s.jquery&&!r.isPlainObject(s))r.each(s,function(){T(this.name,this.value)});else for(f in s)Cs(f,s[f],h,T);return m.join("&")},r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var s=r.prop(this,"elements");return s?r.makeArray(s):this}).filter(function(){var s=this.type;return this.name&&!r(this).is(":disabled")&&Ao.test(this.nodeName)&&!To.test(s)&&(this.checked||!xr.test(s))}).map(function(s,h){var f=r(this).val();return f==null?null:Array.isArray(f)?r.map(f,function(m){return{name:h.name,value:m.replace(Hn,`\r
`)}}):{name:h.name,value:f.replace(Hn,`\r
`)}}).get()}});var Lo=/%20/g,Po=/#.*$/,Fo=/([?&])_=[^&]*/,Oo=/^(.*?):[ \t]*([^\r\n]*)$/mg,Bo=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mo=/^(?:GET|HEAD)$/,Io=/^\/\//,Wn={},Ss={},jn="*/".concat("*"),ws=v.createElement("a");ws.href=Ar.href;function Un(s){return function(h,f){typeof h!="string"&&(f=h,h="*");var m,T=0,L=h.toLowerCase().match(ee)||[];if(c(f))for(;m=L[T++];)m[0]==="+"?(m=m.slice(1)||"*",(s[m]=s[m]||[]).unshift(f)):(s[m]=s[m]||[]).push(f)}}function qn(s,h,f,m){var T={},L=s===Ss;function O(J){var U;return T[J]=!0,r.each(s[J]||[],function(Z,$){var ce=$(h,f,m);if(typeof ce=="string"&&!L&&!T[ce])return h.dataTypes.unshift(ce),O(ce),!1;if(L)return!(U=ce)}),U}return O(h.dataTypes[0])||!T["*"]&&O("*")}function bs(s,h){var f,m,T=r.ajaxSettings.flatOptions||{};for(f in h)h[f]!==void 0&&((T[f]?s:m||(m={}))[f]=h[f]);return m&&r.extend(!0,s,m),s}function No(s,h,f){for(var m,T,L,O,J=s.contents,U=s.dataTypes;U[0]==="*";)U.shift(),m===void 0&&(m=s.mimeType||h.getResponseHeader("Content-Type"));if(m){for(T in J)if(J[T]&&J[T].test(m)){U.unshift(T);break}}if(U[0]in f)L=U[0];else{for(T in f){if(!U[0]||s.converters[T+" "+U[0]]){L=T;break}O||(O=T)}L=L||O}if(L)return L!==U[0]&&U.unshift(L),f[L]}function Ho(s,h,f,m){var T,L,O,J,U,Z={},$=s.dataTypes.slice();if($[1])for(O in s.converters)Z[O.toLowerCase()]=s.converters[O];for(L=$.shift();L;)if(s.responseFields[L]&&(f[s.responseFields[L]]=h),!U&&m&&s.dataFilter&&(h=s.dataFilter(h,s.dataType)),U=L,L=$.shift(),L){if(L==="*")L=U;else if(U!=="*"&&U!==L){if(O=Z[U+" "+L]||Z["* "+L],!O){for(T in Z)if(J=T.split(" "),J[1]===L&&(O=Z[U+" "+J[0]]||Z["* "+J[0]],O)){O===!0?O=Z[T]:Z[T]!==!0&&(L=J[0],$.unshift(J[1]));break}}if(O!==!0)if(O&&s.throws)h=O(h);else try{h=O(h)}catch(ce){return{state:"parsererror",error:O?ce:"No conversion from "+U+" to "+L}}}}return{state:"success",data:h}}r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ar.href,type:"GET",isLocal:Bo.test(Ar.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":jn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(s,h){return h?bs(bs(s,r.ajaxSettings),h):bs(r.ajaxSettings,s)},ajaxPrefilter:Un(Wn),ajaxTransport:Un(Ss),ajax:function(s,h){typeof s=="object"&&(h=s,s=void 0),h=h||{};var f,m,T,L,O,J,U,Z,$,ce,Q=r.ajaxSetup({},h),te=Q.context||Q,Se=Q.context&&(te.nodeType||te.jquery)?r(te):r.event,Te=r.Deferred(),Ce=r.Callbacks("once memory"),Ye=Q.statusCode||{},Ge={},dt={},He="canceled",ke={readyState:0,getResponseHeader:function(Oe){var Ve;if(U){if(!L)for(L={};Ve=Oo.exec(T);)L[Ve[1].toLowerCase()+" "]=(L[Ve[1].toLowerCase()+" "]||[]).concat(Ve[2]);Ve=L[Oe.toLowerCase()+" "]}return Ve==null?null:Ve.join(", ")},getAllResponseHeaders:function(){return U?T:null},setRequestHeader:function(Oe,Ve){return U==null&&(Oe=dt[Oe.toLowerCase()]=dt[Oe.toLowerCase()]||Oe,Ge[Oe]=Ve),this},overrideMimeType:function(Oe){return U==null&&(Q.mimeType=Oe),this},statusCode:function(Oe){var Ve;if(Oe)if(U)ke.always(Oe[ke.status]);else for(Ve in Oe)Ye[Ve]=[Ye[Ve],Oe[Ve]];return this},abort:function(Oe){var Ve=Oe||He;return f&&f.abort(Ve),lt(0,Ve),this}};if(Te.promise(ke),Q.url=((s||Q.url||Ar.href)+"").replace(Io,Ar.protocol+"//"),Q.type=h.method||h.type||Q.method||Q.type,Q.dataTypes=(Q.dataType||"*").toLowerCase().match(ee)||[""],Q.crossDomain==null){J=v.createElement("a");try{J.href=Q.url,J.href=J.href,Q.crossDomain=ws.protocol+"//"+ws.host!=J.protocol+"//"+J.host}catch{Q.crossDomain=!0}}if(Q.data&&Q.processData&&typeof Q.data!="string"&&(Q.data=r.param(Q.data,Q.traditional)),qn(Wn,Q,h,ke),U)return ke;Z=r.event&&Q.global,Z&&r.active++===0&&r.event.trigger("ajaxStart"),Q.type=Q.type.toUpperCase(),Q.hasContent=!Mo.test(Q.type),m=Q.url.replace(Po,""),Q.hasContent?Q.data&&Q.processData&&(Q.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Q.data=Q.data.replace(Lo,"+")):(ce=Q.url.slice(m.length),Q.data&&(Q.processData||typeof Q.data=="string")&&(m+=(Ds.test(m)?"&":"?")+Q.data,delete Q.data),Q.cache===!1&&(m=m.replace(Fo,"$1"),ce=(Ds.test(m)?"&":"?")+"_="+Nn.guid+++ce),Q.url=m+ce),Q.ifModified&&(r.lastModified[m]&&ke.setRequestHeader("If-Modified-Since",r.lastModified[m]),r.etag[m]&&ke.setRequestHeader("If-None-Match",r.etag[m])),(Q.data&&Q.hasContent&&Q.contentType!==!1||h.contentType)&&ke.setRequestHeader("Content-Type",Q.contentType),ke.setRequestHeader("Accept",Q.dataTypes[0]&&Q.accepts[Q.dataTypes[0]]?Q.accepts[Q.dataTypes[0]]+(Q.dataTypes[0]!=="*"?", "+jn+"; q=0.01":""):Q.accepts["*"]);for($ in Q.headers)ke.setRequestHeader($,Q.headers[$]);if(Q.beforeSend&&(Q.beforeSend.call(te,ke,Q)===!1||U))return ke.abort();if(He="abort",Ce.add(Q.complete),ke.done(Q.success),ke.fail(Q.error),f=qn(Ss,Q,h,ke),!f)lt(-1,"No Transport");else{if(ke.readyState=1,Z&&Se.trigger("ajaxSend",[ke,Q]),U)return ke;Q.async&&Q.timeout>0&&(O=o.setTimeout(function(){ke.abort("timeout")},Q.timeout));try{U=!1,f.send(Ge,lt)}catch(Oe){if(U)throw Oe;lt(-1,Oe)}}function lt(Oe,Ve,Pr,gi){var ft,Kt,Vt,ct,Ot,vt=Ve;U||(U=!0,O&&o.clearTimeout(O),f=void 0,T=gi||"",ke.readyState=Oe>0?4:0,ft=Oe>=200&&Oe<300||Oe===304,Pr&&(ct=No(Q,ke,Pr)),!ft&&r.inArray("script",Q.dataTypes)>-1&&r.inArray("json",Q.dataTypes)<0&&(Q.converters["text script"]=function(){}),ct=Ho(Q,ct,ke,ft),ft?(Q.ifModified&&(Ot=ke.getResponseHeader("Last-Modified"),Ot&&(r.lastModified[m]=Ot),Ot=ke.getResponseHeader("etag"),Ot&&(r.etag[m]=Ot)),Oe===204||Q.type==="HEAD"?vt="nocontent":Oe===304?vt="notmodified":(vt=ct.state,Kt=ct.data,Vt=ct.error,ft=!Vt)):(Vt=vt,(Oe||!vt)&&(vt="error",Oe<0&&(Oe=0))),ke.status=Oe,ke.statusText=(Ve||vt)+"",ft?Te.resolveWith(te,[Kt,vt,ke]):Te.rejectWith(te,[ke,vt,Vt]),ke.statusCode(Ye),Ye=void 0,Z&&Se.trigger(ft?"ajaxSuccess":"ajaxError",[ke,Q,ft?Kt:Vt]),Ce.fireWith(te,[ke,vt]),Z&&(Se.trigger("ajaxComplete",[ke,Q]),--r.active||r.event.trigger("ajaxStop")))}return ke},getJSON:function(s,h,f){return r.get(s,h,f,"json")},getScript:function(s,h){return r.get(s,void 0,h,"script")}}),r.each(["get","post"],function(s,h){r[h]=function(f,m,T,L){return c(m)&&(L=L||T,T=m,m=void 0),r.ajax(r.extend({url:f,type:h,dataType:L,data:m,success:T},r.isPlainObject(f)&&f))}}),r.ajaxPrefilter(function(s){var h;for(h in s.headers)h.toLowerCase()==="content-type"&&(s.contentType=s.headers[h]||"")}),r._evalUrl=function(s,h,f){return r.ajax({url:s,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(m){r.globalEval(m,h,f)}})},r.fn.extend({wrapAll:function(s){var h;return this[0]&&(c(s)&&(s=s.call(this[0])),h=r(s,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&h.insertBefore(this[0]),h.map(function(){for(var f=this;f.firstElementChild;)f=f.firstElementChild;return f}).append(this)),this},wrapInner:function(s){return c(s)?this.each(function(h){r(this).wrapInner(s.call(this,h))}):this.each(function(){var h=r(this),f=h.contents();f.length?f.wrapAll(s):h.append(s)})},wrap:function(s){var h=c(s);return this.each(function(f){r(this).wrapAll(h?s.call(this,f):s)})},unwrap:function(s){return this.parent(s).not("body").each(function(){r(this).replaceWith(this.childNodes)}),this}}),r.expr.pseudos.hidden=function(s){return!r.expr.pseudos.visible(s)},r.expr.pseudos.visible=function(s){return!!(s.offsetWidth||s.offsetHeight||s.getClientRects().length)},r.ajaxSettings.xhr=function(){try{return new o.XMLHttpRequest}catch{}};var Wo={0:200,1223:204},Lr=r.ajaxSettings.xhr();S.cors=!!Lr&&"withCredentials"in Lr,S.ajax=Lr=!!Lr,r.ajaxTransport(function(s){var h,f;if(S.cors||Lr&&!s.crossDomain)return{send:function(m,T){var L,O=s.xhr();if(O.open(s.type,s.url,s.async,s.username,s.password),s.xhrFields)for(L in s.xhrFields)O[L]=s.xhrFields[L];s.mimeType&&O.overrideMimeType&&O.overrideMimeType(s.mimeType),!s.crossDomain&&!m["X-Requested-With"]&&(m["X-Requested-With"]="XMLHttpRequest");for(L in m)O.setRequestHeader(L,m[L]);h=function(J){return function(){h&&(h=f=O.onload=O.onerror=O.onabort=O.ontimeout=O.onreadystatechange=null,J==="abort"?O.abort():J==="error"?typeof O.status!="number"?T(0,"error"):T(O.status,O.statusText):T(Wo[O.status]||O.status,O.statusText,(O.responseType||"text")!=="text"||typeof O.responseText!="string"?{binary:O.response}:{text:O.responseText},O.getAllResponseHeaders()))}},O.onload=h(),f=O.onerror=O.ontimeout=h("error"),O.onabort!==void 0?O.onabort=f:O.onreadystatechange=function(){O.readyState===4&&o.setTimeout(function(){h&&f()})},h=h("abort");try{O.send(s.hasContent&&s.data||null)}catch(J){if(h)throw J}},abort:function(){h&&h()}}}),r.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),r.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(s){return r.globalEval(s),s}}}),r.ajaxPrefilter("script",function(s){s.cache===void 0&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),r.ajaxTransport("script",function(s){if(s.crossDomain||s.scriptAttrs){var h,f;return{send:function(m,T){h=r("<script>").attr(s.scriptAttrs||{}).prop({charset:s.scriptCharset,src:s.url}).on("load error",f=function(L){h.remove(),f=null,L&&T(L.type==="error"?404:200,L.type)}),v.head.appendChild(h[0])},abort:function(){f&&f()}}}});var zn=[],Rs=/(=)\?(?=&|$)|\?\?/;r.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var s=zn.pop()||r.expando+"_"+Nn.guid++;return this[s]=!0,s}}),r.ajaxPrefilter("json jsonp",function(s,h,f){var m,T,L,O=s.jsonp!==!1&&(Rs.test(s.url)?"url":typeof s.data=="string"&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Rs.test(s.data)&&"data");if(O||s.dataTypes[0]==="jsonp")return m=s.jsonpCallback=c(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,O?s[O]=s[O].replace(Rs,"$1"+m):s.jsonp!==!1&&(s.url+=(Ds.test(s.url)?"&":"?")+s.jsonp+"="+m),s.converters["script json"]=function(){return L||r.error(m+" was not called"),L[0]},s.dataTypes[0]="json",T=o[m],o[m]=function(){L=arguments},f.always(function(){T===void 0?r(o).removeProp(m):o[m]=T,s[m]&&(s.jsonpCallback=h.jsonpCallback,zn.push(m)),L&&c(T)&&T(L[0]),L=T=void 0}),"script"}),S.createHTMLDocument=function(){var s=v.implementation.createHTMLDocument("").body;return s.innerHTML="<form></form><form></form>",s.childNodes.length===2}(),r.parseHTML=function(s,h,f){if(typeof s!="string")return[];typeof h=="boolean"&&(f=h,h=!1);var m,T,L;return h||(S.createHTMLDocument?(h=v.implementation.createHTMLDocument(""),m=h.createElement("base"),m.href=v.location.href,h.head.appendChild(m)):h=v),T=N.exec(s),L=!f&&[],T?[h.createElement(T[1])]:(T=yn([s],h,L),L&&L.length&&r(L).remove(),r.merge([],T.childNodes))},r.fn.load=function(s,h,f){var m,T,L,O=this,J=s.indexOf(" ");return J>-1&&(m=qt(s.slice(J)),s=s.slice(0,J)),c(h)?(f=h,h=void 0):h&&typeof h=="object"&&(T="POST"),O.length>0&&r.ajax({url:s,type:T||"GET",dataType:"html",data:h}).done(function(U){L=arguments,O.html(m?r("<div>").append(r.parseHTML(U)).find(m):U)}).always(f&&function(U,Z){O.each(function(){f.apply(this,L||[U.responseText,Z,U])})}),this},r.expr.pseudos.animated=function(s){return r.grep(r.timers,function(h){return s===h.elem}).length},r.offset={setOffset:function(s,h,f){var m,T,L,O,J,U,Z,$=r.css(s,"position"),ce=r(s),Q={};$==="static"&&(s.style.position="relative"),J=ce.offset(),L=r.css(s,"top"),U=r.css(s,"left"),Z=($==="absolute"||$==="fixed")&&(L+U).indexOf("auto")>-1,Z?(m=ce.position(),O=m.top,T=m.left):(O=parseFloat(L)||0,T=parseFloat(U)||0),c(h)&&(h=h.call(s,f,r.extend({},J))),h.top!=null&&(Q.top=h.top-J.top+O),h.left!=null&&(Q.left=h.left-J.left+T),"using"in h?h.using.call(s,Q):ce.css(Q)}},r.fn.extend({offset:function(s){if(arguments.length)return s===void 0?this:this.each(function(T){r.offset.setOffset(this,s,T)});var h,f,m=this[0];if(!!m)return m.getClientRects().length?(h=m.getBoundingClientRect(),f=m.ownerDocument.defaultView,{top:h.top+f.pageYOffset,left:h.left+f.pageXOffset}):{top:0,left:0}},position:function(){if(!!this[0]){var s,h,f,m=this[0],T={top:0,left:0};if(r.css(m,"position")==="fixed")h=m.getBoundingClientRect();else{for(h=this.offset(),f=m.ownerDocument,s=m.offsetParent||f.documentElement;s&&(s===f.body||s===f.documentElement)&&r.css(s,"position")==="static";)s=s.parentNode;s&&s!==m&&s.nodeType===1&&(T=r(s).offset(),T.top+=r.css(s,"borderTopWidth",!0),T.left+=r.css(s,"borderLeftWidth",!0))}return{top:h.top-T.top-r.css(m,"marginTop",!0),left:h.left-T.left-r.css(m,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var s=this.offsetParent;s&&r.css(s,"position")==="static";)s=s.offsetParent;return s||Ut})}}),r.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(s,h){var f=h==="pageYOffset";r.fn[s]=function(m){return de(this,function(T,L,O){var J;if(p(T)?J=T:T.nodeType===9&&(J=T.defaultView),O===void 0)return J?J[h]:T[L];J?J.scrollTo(f?J.pageXOffset:O,f?O:J.pageYOffset):T[L]=O},s,m,arguments.length)}}),r.each(["top","left"],function(s,h){r.cssHooks[h]=En(S.pixelPosition,function(f,m){if(m)return m=kr(f,h),_s.test(m)?r(f).position()[h]+"px":m})}),r.each({Height:"height",Width:"width"},function(s,h){r.each({padding:"inner"+s,content:h,"":"outer"+s},function(f,m){r.fn[m]=function(T,L){var O=arguments.length&&(f||typeof T!="boolean"),J=f||(T===!0||L===!0?"margin":"border");return de(this,function(U,Z,$){var ce;return p(U)?m.indexOf("outer")===0?U["inner"+s]:U.document.documentElement["client"+s]:U.nodeType===9?(ce=U.documentElement,Math.max(U.body["scroll"+s],ce["scroll"+s],U.body["offset"+s],ce["offset"+s],ce["client"+s])):$===void 0?r.css(U,Z,J):r.style(U,Z,$,J)},h,O?T:void 0,O)}})}),r.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(s,h){r.fn[h]=function(f){return this.on(h,f)}}),r.fn.extend({bind:function(s,h,f){return this.on(s,null,h,f)},unbind:function(s,h){return this.off(s,null,h)},delegate:function(s,h,f,m){return this.on(h,s,f,m)},undelegate:function(s,h,f){return arguments.length===1?this.off(s,"**"):this.off(h,s||"**",f)},hover:function(s,h){return this.mouseenter(s).mouseleave(h||s)}}),r.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(s,h){r.fn[h]=function(f,m){return arguments.length>0?this.on(h,null,f,m):this.trigger(h)}});var jo=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;r.proxy=function(s,h){var f,m,T;if(typeof h=="string"&&(f=s[h],h=s,s=f),!!c(s))return m=B.call(arguments,2),T=function(){return s.apply(h||this,m.concat(B.call(arguments)))},T.guid=s.guid=s.guid||r.guid++,T},r.holdReady=function(s){s?r.readyWait++:r.ready(!0)},r.isArray=Array.isArray,r.parseJSON=JSON.parse,r.nodeName=b,r.isFunction=c,r.isWindow=p,r.camelCase=Ae,r.type=t,r.now=Date.now,r.isNumeric=function(s){var h=r.type(s);return(h==="number"||h==="string")&&!isNaN(s-parseFloat(s))},r.trim=function(s){return s==null?"":(s+"").replace(jo,"$1")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return r});var Uo=o.jQuery,qo=o.$;return r.noConflict=function(s){return o.$===r&&(o.$=qo),s&&o.jQuery===r&&(o.jQuery=Uo),r},typeof d>"u"&&(o.jQuery=o.$=r),r})});var ra=rt((rc,bi)=>{(function(o){"use strict";typeof define=="function"&&define.amd?define(["jquery"],o):typeof bi<"u"&&bi.exports?bi.exports=o(Bs()):o(jQuery)})(function(o,d){"use strict";if(!o.jstree){var k=0,M=!1,B=!1,u=!1,_=[],y=o("script:last").attr("src"),w=window.document,R=window.setImmediate,x=window.Promise;!R&&x&&(R=function(e,i){x.resolve(i).then(e)}),o.jstree={version:"3.3.14",defaults:{plugins:[]},plugins:{},path:y&&y.indexOf("/")!==-1?y.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},o.jstree.create=function(e,i){var t=new o.jstree.core(++k),n=i;return i=o.extend(!0,{},o.jstree.defaults,i),n&&n.plugins&&(i.plugins=n.plugins),o.each(i.plugins,function(r,a){r!=="core"&&(t=t.plugin(a,i[a]))}),o(e).data("jstree",t),t.init(e,i),t},o.jstree.destroy=function(){o(".jstree:jstree").jstree("destroy"),o(w).off(".jstree")},o.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},o.jstree.reference=function(e){var i=null,t=null;if(e&&e.id&&(!e.tagName||!e.nodeType)&&(e=e.id),!t||!t.length)try{t=o(e)}catch{}if(!t||!t.length)try{t=o("#"+e.replace(o.jstree.idregex,"\\$&"))}catch{}return t&&t.length&&(t=t.closest(".jstree")).length&&(t=t.data("jstree"))?i=t:o(".jstree").each(function(){var n=o(this).data("jstree");if(n&&n._model.data[e])return i=n,!1}),i},o.fn.jstree=function(e){var i=typeof e=="string",t=Array.prototype.slice.call(arguments,1),n=null;return e===!0&&!this.length?!1:(this.each(function(){var r=o.jstree.reference(this),a=i&&r?r[e]:null;if(n=i&&a?a.apply(r,t):null,!r&&!i&&(e===d||o.isPlainObject(e))&&o.jstree.create(this,e),(r&&!i||e===!0)&&(n=r||!1),n!==null&&n!==d)return!1}),n!==null&&n!==d?n:this)},o.expr.pseudos.jstree=o.expr.createPseudo(function(e){return function(i){return o(i).hasClass("jstree")&&o(i).data("jstree")!==d}}),o.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:o.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,compute_elements_positions:!1,keyboard:{"ctrl-space":function(e){e.type="click",o(e.currentTarget).trigger(e)},enter:function(e){e.type="click",o(e.currentTarget).trigger(e)},left:function(e){if(e.preventDefault(),this.is_open(e.currentTarget))this.close_node(e.currentTarget);else{var i=this.get_parent(e.currentTarget);i&&i.id!==o.jstree.root&&this.get_node(i,!0).children(".jstree-anchor").trigger("focus")}},up:function(e){e.preventDefault();var i=this.get_prev_dom(e.currentTarget);i&&i.length&&i.children(".jstree-anchor").trigger("focus")},right:function(e){if(e.preventDefault(),this.is_closed(e.currentTarget))this.open_node(e.currentTarget,function(t){this.get_node(t,!0).children(".jstree-anchor").trigger("focus")});else if(this.is_open(e.currentTarget)){var i=this.get_node(e.currentTarget,!0).children(".jstree-children")[0];i&&o(this._firstChild(i)).children(".jstree-anchor").trigger("focus")}},down:function(e){e.preventDefault();var i=this.get_next_dom(e.currentTarget);i&&i.length&&i.children(".jstree-anchor").trigger("focus")},"*":function(e){this.open_all()},home:function(e){e.preventDefault();var i=this._firstChild(this.get_container_ul()[0]);i&&o(i).children(".jstree-anchor").filter(":visible").trigger("focus")},end:function(e){e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().trigger("focus")},f2:function(e){e.preventDefault(),this.edit(e.currentTarget)}}},o.jstree.core.prototype={plugin:function(e,i){var t=o.jstree.plugins[e];return t?(this._data[e]={},t.prototype=this,new t(i,this)):this},init:function(e,i){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[o.jstree.root]={id:o.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=o(e).addClass("jstree jstree-"+this._id),this.settings=i,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl=this.element.css("direction")==="rtl",this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(o.jstree.root)},destroy:function(e){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch{}e||this.element.empty(),this.teardown()},_create_prototype_node:function(){var e=w.createElement("LI"),i,t;return e.setAttribute("role","none"),i=w.createElement("I"),i.className="jstree-icon jstree-ocl",i.setAttribute("role","presentation"),e.appendChild(i),i=w.createElement("A"),i.className="jstree-anchor",i.setAttribute("href","#"),i.setAttribute("tabindex","-1"),i.setAttribute("role","treeitem"),t=w.createElement("I"),t.className="jstree-icon jstree-themeicon",t.setAttribute("role","presentation"),i.appendChild(t),e.appendChild(i),i=t=null,e},_kbevent_to_func:function(e){var i={8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"},t=[];if(e.ctrlKey&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&t.push("shift"),t.push(i[e.which]?i[e.which].toLowerCase():e.which),t=t.sort().join("-").toLowerCase(),t==="shift-shift"||t==="ctrl-ctrl"||t==="alt-alt")return null;var n=this.settings.core.keyboard,r,a;for(r in n)if(n.hasOwnProperty(r)&&(a=r,a!=="-"&&a!=="+"&&(a=a.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS"),a=a.split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()),a===t))return n[r];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")}),this.element=null},bind:function(){var e="",i=null,t=0;this.element.on("dblclick.jstree",function(n){if(n.target.tagName&&n.target.tagName.toLowerCase()==="input")return!0;if(w.selection&&w.selection.empty)w.selection.empty();else if(window.getSelection){var r=window.getSelection();try{r.removeAllRanges(),r.collapse()}catch{}}}).on("mousedown.jstree",function(n){n.target===this.element[0]&&(n.preventDefault(),t=+new Date)}.bind(this)).on("mousedown.jstree",".jstree-ocl",function(n){n.preventDefault()}).on("click.jstree",".jstree-ocl",function(n){this.toggle_node(n.target)}.bind(this)).on("dblclick.jstree",".jstree-anchor",function(n){if(n.target.tagName&&n.target.tagName.toLowerCase()==="input")return!0;this.settings.core.dblclick_toggle&&this.toggle_node(n.target)}.bind(this)).on("click.jstree",".jstree-anchor",function(n){n.preventDefault(),n.currentTarget!==w.activeElement&&o(n.currentTarget).trigger("focus"),this.activate_node(n.currentTarget,n)}.bind(this)).on("keydown.jstree",".jstree-anchor",function(n){if(n.target.tagName&&n.target.tagName.toLowerCase()==="input")return!0;this._data.core.rtl&&(n.which===37?n.which=39:n.which===39&&(n.which=37));var r=this._kbevent_to_func(n);if(r){var a=r.call(this,n);if(a===!1||a===!0)return a}}.bind(this)).on("load_node.jstree",function(n,r){r.status&&(r.node.id===o.jstree.root&&!this._data.core.loaded&&(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var a=[],l,g;for(l=0,g=this._data.core.selected.length;l<g;l++)a=a.concat(this._model.data[this._data.core.selected[l]].parents);for(a=o.vakata.array_unique(a),l=0,g=a.length;l<g;l++)this.open_node(a[l],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}}.bind(this),0))}.bind(this)).on("keypress.jstree",function(n){if(n.target.tagName&&n.target.tagName.toLowerCase()==="input")return!0;i&&clearTimeout(i),i=setTimeout(function(){e=""},500);var r=String.fromCharCode(n.which).toLowerCase(),a=this.element.find(".jstree-anchor").filter(":visible"),l=a.index(w.activeElement)||0,g=!1;e+=r,!(e.length>1&&(a.slice(l).each(function(D,C){if(o(C).text().toLowerCase().indexOf(e)===0)return o(C).trigger("focus"),g=!0,!1}.bind(this)),g||(a.slice(0,l).each(function(D,C){if(o(C).text().toLowerCase().indexOf(e)===0)return o(C).trigger("focus"),g=!0,!1}.bind(this)),g)))&&new RegExp("^"+r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(e)&&(a.slice(l+1).each(function(D,C){if(o(C).text().toLowerCase().charAt(0)===r)return o(C).trigger("focus"),g=!0,!1}.bind(this)),g||a.slice(0,l+1).each(function(D,C){if(o(C).text().toLowerCase().charAt(0)===r)return o(C).trigger("focus"),g=!0,!1}.bind(this)))}.bind(this)).on("init.jstree",function(){var n=this.settings.core.themes;this._data.core.themes.dots=n.dots,this._data.core.themes.stripes=n.stripes,this._data.core.themes.icons=n.icons,this._data.core.themes.ellipsis=n.ellipsis,this.set_theme(n.name||"default",n.url),this.set_theme_variant(n.variant)}.bind(this)).on("loading.jstree",function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()}.bind(this)).on("blur.jstree",".jstree-anchor",function(n){this._data.core.focused=null,o(n.currentTarget).filter(".jstree-hovered").trigger("mouseleave"),this.element.attr("tabindex","0"),o(n.currentTarget).attr("tabindex","-1")}.bind(this)).on("focus.jstree",".jstree-anchor",function(n){var r=this.get_node(n.currentTarget);r&&r.id&&(this._data.core.focused=r.id),this.element.find(".jstree-hovered").not(n.currentTarget).trigger("mouseleave"),o(n.currentTarget).trigger("mouseenter"),this.element.attr("tabindex","-1"),o(n.currentTarget).attr("tabindex","0")}.bind(this)).on("focus.jstree",function(){if(+new Date-t>500&&!this._data.core.focused&&this.settings.core.restore_focus){t=0;var n=this.get_node(this.element.attr("aria-activedescendant"),!0);n&&n.find("> .jstree-anchor").trigger("focus")}}.bind(this)).on("mouseenter.jstree",".jstree-anchor",function(n){this.hover_node(n.currentTarget)}.bind(this)).on("mouseleave.jstree",".jstree-anchor",function(n){this.dehover_node(n.currentTarget)}.bind(this))},unbind:function(){this.element.off(".jstree"),o(w).off(".jstree-"+this._id)},trigger:function(e,i){i||(i={}),i.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",i)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(e){var i=this.settings.core.strings;return o.vakata.is_function(i)?i.call(this,e):i&&i[e]?i[e]:e},_firstChild:function(e){for(e=e?e.firstChild:null;e!==null&&e.nodeType!==1;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;e!==null&&e.nodeType!==1;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;e!==null&&e.nodeType!==1;)e=e.previousSibling;return e},get_node:function(e,i){e&&e.id&&(e=e.id),e instanceof o&&e.length&&e[0].id&&(e=e[0].id);var t;try{if(this._model.data[e])e=this._model.data[e];else if(typeof e=="string"&&this._model.data[e.replace(/^#/,"")])e=this._model.data[e.replace(/^#/,"")];else if(typeof e=="string"&&(t=o("#"+e.replace(o.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[t.closest(".jstree-node").attr("id")])e=this._model.data[t.closest(".jstree-node").attr("id")];else if((t=this.element.find(e)).length&&this._model.data[t.closest(".jstree-node").attr("id")])e=this._model.data[t.closest(".jstree-node").attr("id")];else if((t=this.element.find(e)).length&&t.hasClass("jstree"))e=this._model.data[o.jstree.root];else return!1;return i&&(e=e.id===o.jstree.root?this.element:o("#"+e.id.replace(o.jstree.idregex,"\\$&"),this.element)),e}catch{return!1}},get_path:function(e,i,t){if(e=e.parents?e:this.get_node(e),!e||e.id===o.jstree.root||!e.parents)return!1;var n,r,a=[];for(a.push(t?e.id:e.text),n=0,r=e.parents.length;n<r;n++)a.push(t?e.parents[n]:this.get_text(e.parents[n]));return a=a.reverse().slice(1),i?a.join(i):a},get_next_dom:function(e,i){var t;if(e=this.get_node(e,!0),e[0]===this.element[0]){for(t=this._firstChild(this.get_container_ul()[0]);t&&t.offsetHeight===0;)t=this._nextSibling(t);return t?o(t):!1}if(!e||!e.length)return!1;if(i){t=e[0];do t=this._nextSibling(t);while(t&&t.offsetHeight===0);return t?o(t):!1}if(e.hasClass("jstree-open")){for(t=this._firstChild(e.children(".jstree-children")[0]);t&&t.offsetHeight===0;)t=this._nextSibling(t);if(t!==null)return o(t)}t=e[0];do t=this._nextSibling(t);while(t&&t.offsetHeight===0);return t!==null?o(t):e.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(e,i){var t;if(e=this.get_node(e,!0),e[0]===this.element[0]){for(t=this.get_container_ul()[0].lastChild;t&&t.offsetHeight===0;)t=this._previousSibling(t);return t?o(t):!1}if(!e||!e.length)return!1;if(i){t=e[0];do t=this._previousSibling(t);while(t&&t.offsetHeight===0);return t?o(t):!1}t=e[0];do t=this._previousSibling(t);while(t&&t.offsetHeight===0);if(t!==null){for(e=o(t);e.hasClass("jstree-open");)e=e.children(".jstree-children").first().children(".jstree-node:visible:last");return e}return t=e[0].parentNode.parentNode,t&&t.className&&t.className.indexOf("jstree-node")!==-1?o(t):!1},get_parent:function(e){return e=this.get_node(e),!e||e.id===o.jstree.root?!1:e.parent},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!e||!e.length?!1:e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return e=this.get_node(e),e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){return e=this.get_node(e),e&&e.state.loaded},is_loading:function(e){return e=this.get_node(e),e&&e.state&&e.state.loading},is_open:function(e){return e=this.get_node(e),e&&e.state.opened},is_closed:function(e){return e=this.get_node(e),e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(e,i){var t=this.get_node(e,!0),n,r,a,l,g;if(o.vakata.is_array(e))return this._load_nodes(e.slice(),i),!0;if(e=this.get_node(e),!e)return i&&i.call(this,e,!1),!1;if(e.state.loaded){for(e.state.loaded=!1,a=0,l=e.parents.length;a<l;a++)this._model.data[e.parents[a]].children_d=o.vakata.array_filter(this._model.data[e.parents[a]].children_d,function(D){return o.inArray(D,e.children_d)===-1});for(n=0,r=e.children_d.length;n<r;n++)this._model.data[e.children_d[n]].state.selected&&(g=!0),delete this._model.data[e.children_d[n]];g&&(this._data.core.selected=o.vakata.array_filter(this._data.core.selected,function(D){return o.inArray(D,e.children_d)===-1})),e.children=[],e.children_d=[],g&&this.trigger("changed",{action:"load_node",node:e,selected:this._data.core.selected})}return e.state.failed=!1,e.state.loading=!0,e.id!==o.jstree.root?t.children(".jstree-anchor").attr("aria-busy",!0):t.attr("aria-busy",!0),t.addClass("jstree-loading"),this._load_node(e,function(D){e=this._model.data[e.id],e.state.loading=!1,e.state.loaded=D,e.state.failed=!e.state.loaded;var C=this.get_node(e,!0),b=0,N=0,W=this._model.data,K=!1;for(b=0,N=e.children.length;b<N;b++)if(W[e.children[b]]&&!W[e.children[b]].state.hidden){K=!0;break}e.state.loaded&&C&&C.length&&(C.removeClass("jstree-closed jstree-open jstree-leaf"),K?e.id!=="#"&&C.addClass(e.state.opened?"jstree-open":"jstree-closed"):C.addClass("jstree-leaf")),e.id!==o.jstree.root?C.children(".jstree-anchor").attr("aria-busy",!1):C.attr("aria-busy",!1),C.removeClass("jstree-loading"),this.trigger("load_node",{node:e,status:D}),i&&i.call(this,e,D)}.bind(this)),!0},_load_nodes:function(e,i,t,n){var r=!0,a=function(){this._load_nodes(e,i,!0)},l=this._model.data,g,D,C=[];for(g=0,D=e.length;g<D;g++)l[e[g]]&&(!l[e[g]].state.loaded&&!l[e[g]].state.failed||!t&&n)&&(this.is_loading(e[g])||this.load_node(e[g],a),r=!1);if(r){for(g=0,D=e.length;g<D;g++)l[e[g]]&&l[e[g]].state.loaded&&C.push(e[g]);i&&!i.done&&(i.call(this,C),i.done=!0)}},load_all:function(e,i){if(e||(e=o.jstree.root),e=this.get_node(e),!e)return!1;var t=[],n=this._model.data,r=n[e.id].children_d,a,l;for(e.state&&!e.state.loaded&&t.push(e.id),a=0,l=r.length;a<l;a++)n[r[a]]&&n[r[a]].state&&!n[r[a]].state.loaded&&t.push(r[a]);t.length?this._load_nodes(t,function(){this.load_all(e,i)}):(i&&i.call(this,e),this.trigger("load_all",{node:e}))},_load_node:function(e,i){var t=this.settings.core.data,n,r=function(){return this.nodeType!==3&&this.nodeType!==8};return t?o.vakata.is_function(t)?t.call(this,e,function(a){a===!1?i.call(this,!1):this[typeof a=="string"?"_append_html_data":"_append_json_data"](e,typeof a=="string"?o(o.parseHTML(a)).filter(r):a,function(l){i.call(this,l)})}.bind(this)):typeof t=="object"?t.url?(t=o.extend(!0,{},t),o.vakata.is_function(t.url)&&(t.url=t.url.call(this,e)),o.vakata.is_function(t.data)&&(t.data=t.data.call(this,e)),o.ajax(t).done(function(a,l,g){var D=g.getResponseHeader("Content-Type");return D&&D.indexOf("json")!==-1||typeof a=="object"?this._append_json_data(e,a,function(C){i.call(this,C)}):D&&D.indexOf("html")!==-1||typeof a=="string"?this._append_html_data(e,o(o.parseHTML(a)).filter(r),function(C){i.call(this,C)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:e.id,xhr:g})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))}.bind(this)).fail(function(a){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:e.id,xhr:a})},i.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)}.bind(this))):(o.vakata.is_array(t)?n=o.extend(!0,[],t):o.isPlainObject(t)?n=o.extend(!0,{},t):n=t,e.id===o.jstree.root?this._append_json_data(e,n,function(a){i.call(this,a)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:e.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))):typeof t=="string"?e.id===o.jstree.root?this._append_html_data(e,o(o.parseHTML(t)).filter(r),function(a){i.call(this,a)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:e.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1)):i.call(this,!1):e.id===o.jstree.root?this._append_html_data(e,this._data.core.original_container_html.clone(!0),function(a){i.call(this,a)}):i.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&o.inArray(e.id,this._model.changed)===-1&&this._model.changed.push(e.id)},_append_html_data:function(e,i,t){e=this.get_node(e),e.children=[],e.children_d=[];var n=i.is("ul")?i.children():i,r=e.id,a=[],l=[],g=this._model.data,D=g[r],C=this._data.core.selected.length,b,N,W;for(n.each(function(K,E){b=this._parse_model_from_html(o(E),r,D.parents.concat()),b&&(a.push(b),l.push(b),g[b].children_d.length&&(l=l.concat(g[b].children_d)))}.bind(this)),D.children=a,D.children_d=l,N=0,W=D.parents.length;N<W;N++)g[D.parents[N]].children_d=g[D.parents[N]].children_d.concat(l);this.trigger("model",{nodes:l,parent:r}),r!==o.jstree.root?(this._node_changed(r),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==C&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),t.call(this,!0)},_append_json_data:function(e,i,t,n){if(this.element!==null){e=this.get_node(e),e.children=[],e.children_d=[],i.d&&(i=i.d,typeof i=="string"&&(i=JSON.parse(i))),o.vakata.is_array(i)||(i=[i]);var r=null,a={df:this._model.default_state,dat:i,par:e.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},l=this,g=function(C,b){C.data&&(C=C.data);var N=C.dat,W=C.par,K=[],E=[],F=[],I=C.df,j=C.t_id,ie=C.t_cnt,ee=C.m,fe=ee[W],ue=C.sel,ge,q,V,G,ae=function(ne,_e,Fe){Fe?Fe=Fe.concat():Fe=[],_e&&Fe.unshift(_e);var Ae=ne.id.toString(),ve,Le,De,Je,ye={id:Ae,text:ne.text||"",icon:ne.icon!==b?ne.icon:!0,parent:_e,parents:Fe,children:ne.children||[],children_d:ne.children_d||[],data:ne.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(ve in I)I.hasOwnProperty(ve)&&(ye.state[ve]=I[ve]);if(ne&&ne.data&&ne.data.jstree&&ne.data.jstree.icon&&(ye.icon=ne.data.jstree.icon),(ye.icon===b||ye.icon===null||ye.icon==="")&&(ye.icon=!0),ne&&ne.data&&(ye.data=ne.data,ne.data.jstree))for(ve in ne.data.jstree)ne.data.jstree.hasOwnProperty(ve)&&(ye.state[ve]=ne.data.jstree[ve]);if(ne&&typeof ne.state=="object")for(ve in ne.state)ne.state.hasOwnProperty(ve)&&(ye.state[ve]=ne.state[ve]);if(ne&&typeof ne.li_attr=="object")for(ve in ne.li_attr)ne.li_attr.hasOwnProperty(ve)&&(ye.li_attr[ve]=ne.li_attr[ve]);if(ye.li_attr.id||(ye.li_attr.id=Ae),ne&&typeof ne.a_attr=="object")for(ve in ne.a_attr)ne.a_attr.hasOwnProperty(ve)&&(ye.a_attr[ve]=ne.a_attr[ve]);for(ne&&ne.children&&ne.children===!0&&(ye.state.loaded=!1,ye.children=[],ye.children_d=[]),ee[ye.id]=ye,ve=0,Le=ye.children.length;ve<Le;ve++)De=ae(ee[ye.children[ve]],ye.id,Fe),Je=ee[De],ye.children_d.push(De),Je.children_d.length&&(ye.children_d=ye.children_d.concat(Je.children_d));return delete ne.data,delete ne.children,ee[ye.id].original=ne,ye.state.selected&&F.push(ye.id),ye.id},de=function(ne,_e,Fe){Fe?Fe=Fe.concat():Fe=[],_e&&Fe.unshift(_e);var Ae=!1,ve,Le,De,Je,ye;do Ae="j"+j+"_"+ ++ie;while(ee[Ae]);ye={id:!1,text:typeof ne=="string"?ne:"",icon:typeof ne=="object"&&ne.icon!==b?ne.icon:!0,parent:_e,parents:Fe,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(ve in I)I.hasOwnProperty(ve)&&(ye.state[ve]=I[ve]);if(ne&&ne.id&&(ye.id=ne.id.toString()),ne&&ne.text&&(ye.text=ne.text),ne&&ne.data&&ne.data.jstree&&ne.data.jstree.icon&&(ye.icon=ne.data.jstree.icon),(ye.icon===b||ye.icon===null||ye.icon==="")&&(ye.icon=!0),ne&&ne.data&&(ye.data=ne.data,ne.data.jstree))for(ve in ne.data.jstree)ne.data.jstree.hasOwnProperty(ve)&&(ye.state[ve]=ne.data.jstree[ve]);if(ne&&typeof ne.state=="object")for(ve in ne.state)ne.state.hasOwnProperty(ve)&&(ye.state[ve]=ne.state[ve]);if(ne&&typeof ne.li_attr=="object")for(ve in ne.li_attr)ne.li_attr.hasOwnProperty(ve)&&(ye.li_attr[ve]=ne.li_attr[ve]);if(ye.li_attr.id&&!ye.id&&(ye.id=ye.li_attr.id.toString()),ye.id||(ye.id=Ae),ye.li_attr.id||(ye.li_attr.id=ye.id),ne&&typeof ne.a_attr=="object")for(ve in ne.a_attr)ne.a_attr.hasOwnProperty(ve)&&(ye.a_attr[ve]=ne.a_attr[ve]);if(ne&&ne.children&&ne.children.length){for(ve=0,Le=ne.children.length;ve<Le;ve++)De=de(ne.children[ve],ye.id,Fe),Je=ee[De],ye.children.push(De),Je.children_d.length&&(ye.children_d=ye.children_d.concat(Je.children_d));ye.children_d=ye.children_d.concat(ye.children)}return ne&&ne.children&&ne.children===!0&&(ye.state.loaded=!1,ye.children=[],ye.children_d=[]),delete ne.data,delete ne.children,ye.original=ne,ee[ye.id]=ye,ye.state.selected&&F.push(ye.id),ye.id};if(N.length&&N[0].id!==b&&N[0].parent!==b){for(q=0,V=N.length;q<V;q++)N[q].children||(N[q].children=[]),N[q].state||(N[q].state={}),ee[N[q].id.toString()]=N[q];for(q=0,V=N.length;q<V;q++){if(!ee[N[q].parent.toString()]){typeof l<"u"&&(l._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:N[q].id.toString(),parent:N[q].parent.toString()})},l.settings.core.error.call(l,l._data.core.last_error));continue}ee[N[q].parent.toString()].children.push(N[q].id.toString()),fe.children_d.push(N[q].id.toString())}for(q=0,V=fe.children.length;q<V;q++)ge=ae(ee[fe.children[q]],W,fe.parents.concat()),E.push(ge),ee[ge].children_d.length&&(E=E.concat(ee[ge].children_d));for(q=0,V=fe.parents.length;q<V;q++)ee[fe.parents[q]].children_d=ee[fe.parents[q]].children_d.concat(E);G={cnt:ie,mod:ee,sel:ue,par:W,dpc:E,add:F}}else{for(q=0,V=N.length;q<V;q++)ge=de(N[q],W,fe.parents.concat()),ge&&(K.push(ge),E.push(ge),ee[ge].children_d.length&&(E=E.concat(ee[ge].children_d)));for(fe.children=K,fe.children_d=E,q=0,V=fe.parents.length;q<V;q++)ee[fe.parents[q]].children_d=ee[fe.parents[q]].children_d.concat(E);G={cnt:ie,mod:ee,sel:ue,par:W,dpc:E,add:F}}if(typeof window>"u"||typeof window.document>"u")postMessage(G);else return G},D=function(C,b){if(this.element!==null){this._cnt=C.cnt;var N,W=this._model.data;for(N in W)W.hasOwnProperty(N)&&W[N].state&&W[N].state.loading&&C.mod[N]&&(C.mod[N].state.loading=!0);if(this._model.data=C.mod,b){var K,E=C.add,F=C.sel,I=this._data.core.selected.slice();if(W=this._model.data,F.length!==I.length||o.vakata.array_unique(F.concat(I)).length!==F.length){for(N=0,K=F.length;N<K;N++)o.inArray(F[N],E)===-1&&o.inArray(F[N],I)===-1&&(W[F[N]].state.selected=!1);for(N=0,K=I.length;N<K;N++)o.inArray(I[N],F)===-1&&(W[I[N]].state.selected=!0)}}C.add.length&&(this._data.core.selected=this._data.core.selected.concat(C.add)),this.trigger("model",{nodes:C.dpc,parent:C.par}),C.par!==o.jstree.root?(this._node_changed(C.par),this.redraw()):this.redraw(!0),C.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),!b&&R?R(function(){t.call(l,!0)}):t.call(l,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{this._wrk===null&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+g.toString()],{type:"text/javascript"}))),!this._data.core.working||n?(this._data.core.working=!0,r=new window.Worker(this._wrk),r.onmessage=function(C){D.call(this,C.data,!0);try{r.terminate(),r=null}catch{}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}.bind(this),r.onerror=function(C){D.call(this,g(a),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}.bind(this),a.par?r.postMessage(a):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([e,i,t,!0])}catch{D.call(this,g(a),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else D.call(this,g(a),!1)}},_parse_model_from_html:function(e,i,t){t?t=[].concat(t):t=[],i&&t.unshift(i);var n,r,a=this._model.data,l={id:!1,text:!1,icon:!0,parent:i,parents:t,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},g,D,C;for(g in this._model.default_state)this._model.default_state.hasOwnProperty(g)&&(l.state[g]=this._model.default_state[g]);if(D=o.vakata.attributes(e,!0),o.each(D,function(b,N){if(N=o.vakata.trim(N),!N.length)return!0;l.li_attr[b]=N,b==="id"&&(l.id=N.toString())}),D=e.children("a").first(),D.length&&(D=o.vakata.attributes(D,!0),o.each(D,function(b,N){N=o.vakata.trim(N),N.length&&(l.a_attr[b]=N)})),D=e.children("a").first().length?e.children("a").first().clone():e.clone(),D.children("ins, i, ul").remove(),D=D.html(),D=o("<div></div>").html(D),l.text=this.settings.core.force_text?D.text():D.html(),D=e.data(),l.data=D?o.extend(!0,{},D):null,l.state.opened=e.hasClass("jstree-open"),l.state.selected=e.children("a").hasClass("jstree-clicked"),l.state.disabled=e.children("a").hasClass("jstree-disabled"),l.data&&l.data.jstree)for(g in l.data.jstree)l.data.jstree.hasOwnProperty(g)&&(l.state[g]=l.data.jstree[g]);D=e.children("a").children(".jstree-themeicon"),D.length&&(l.icon=D.hasClass("jstree-themeicon-hidden")?!1:D.attr("rel")),l.state.icon!==d&&(l.icon=l.state.icon),(l.icon===d||l.icon===null||l.icon==="")&&(l.icon=!0),D=e.children("ul").children("li");do C="j"+this._id+"_"+ ++this._cnt;while(a[C]);return l.id=l.li_attr.id?l.li_attr.id.toString():C,D.length?(D.each(function(b,N){n=this._parse_model_from_html(o(N),l.id,t),r=this._model.data[n],l.children.push(n),r.children_d.length&&(l.children_d=l.children_d.concat(r.children_d))}.bind(this)),l.children_d=l.children_d.concat(l.children)):e.hasClass("jstree-closed")&&(l.state.loaded=!1),l.li_attr.class&&(l.li_attr.class=l.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),l.a_attr.class&&(l.a_attr.class=l.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),a[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_flat_json:function(e,i,t){t?t=t.concat():t=[],i&&t.unshift(i);var n=e.id.toString(),r=this._model.data,a=this._model.default_state,l,g,D,C,b={id:n,text:e.text||"",icon:e.icon!==d?e.icon:!0,parent:i,parents:t,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(l in a)a.hasOwnProperty(l)&&(b.state[l]=a[l]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(b.icon=e.data.jstree.icon),(b.icon===d||b.icon===null||b.icon==="")&&(b.icon=!0),e&&e.data&&(b.data=e.data,e.data.jstree))for(l in e.data.jstree)e.data.jstree.hasOwnProperty(l)&&(b.state[l]=e.data.jstree[l]);if(e&&typeof e.state=="object")for(l in e.state)e.state.hasOwnProperty(l)&&(b.state[l]=e.state[l]);if(e&&typeof e.li_attr=="object")for(l in e.li_attr)e.li_attr.hasOwnProperty(l)&&(b.li_attr[l]=e.li_attr[l]);if(b.li_attr.id||(b.li_attr.id=n),e&&typeof e.a_attr=="object")for(l in e.a_attr)e.a_attr.hasOwnProperty(l)&&(b.a_attr[l]=e.a_attr[l]);for(e&&e.children&&e.children===!0&&(b.state.loaded=!1,b.children=[],b.children_d=[]),r[b.id]=b,l=0,g=b.children.length;l<g;l++)D=this._parse_model_from_flat_json(r[b.children[l]],b.id,t),C=r[D],b.children_d.push(D),C.children_d.length&&(b.children_d=b.children_d.concat(C.children_d));return delete e.data,delete e.children,r[b.id].original=e,b.state.selected&&this._data.core.selected.push(b.id),b.id},_parse_model_from_json:function(e,i,t){t?t=t.concat():t=[],i&&t.unshift(i);var n=!1,r,a,l,g,D=this._model.data,C=this._model.default_state,b;do n="j"+this._id+"_"+ ++this._cnt;while(D[n]);b={id:!1,text:typeof e=="string"?e:"",icon:typeof e=="object"&&e.icon!==d?e.icon:!0,parent:i,parents:t,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(r in C)C.hasOwnProperty(r)&&(b.state[r]=C[r]);if(e&&e.id&&(b.id=e.id.toString()),e&&e.text&&(b.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(b.icon=e.data.jstree.icon),(b.icon===d||b.icon===null||b.icon==="")&&(b.icon=!0),e&&e.data&&(b.data=e.data,e.data.jstree))for(r in e.data.jstree)e.data.jstree.hasOwnProperty(r)&&(b.state[r]=e.data.jstree[r]);if(e&&typeof e.state=="object")for(r in e.state)e.state.hasOwnProperty(r)&&(b.state[r]=e.state[r]);if(e&&typeof e.li_attr=="object")for(r in e.li_attr)e.li_attr.hasOwnProperty(r)&&(b.li_attr[r]=e.li_attr[r]);if(b.li_attr.id&&!b.id&&(b.id=b.li_attr.id.toString()),b.id||(b.id=n),b.li_attr.id||(b.li_attr.id=b.id),e&&typeof e.a_attr=="object")for(r in e.a_attr)e.a_attr.hasOwnProperty(r)&&(b.a_attr[r]=e.a_attr[r]);if(e&&e.children&&e.children.length){for(r=0,a=e.children.length;r<a;r++)l=this._parse_model_from_json(e.children[r],b.id,t),g=D[l],b.children.push(l),g.children_d.length&&(b.children_d=b.children_d.concat(g.children_d));b.children_d=b.children.concat(b.children_d)}return e&&e.children&&e.children===!0&&(b.state.loaded=!1,b.children=[],b.children_d=[]),delete e.data,delete e.children,b.original=e,D[b.id]=b,b.state.selected&&this._data.core.selected.push(b.id),b.id},_redraw:function(){var e=this._model.force_full_redraw?this._model.data[o.jstree.root].children.concat([]):this._model.changed.concat([]),i=w.createElement("UL"),t,n,r,a=this._data.core.focused;for(n=0,r=e.length;n<r;n++)t=this.redraw_node(e[n],!0,this._model.force_full_redraw),t&&this._model.force_full_redraw&&i.appendChild(t);this._model.force_full_redraw&&(i.className=this.get_container_ul()[0].className,i.setAttribute("role","presentation"),this.element.empty().append(i)),a!==null&&this.settings.core.restore_focus&&(t=this.get_node(a,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==w.activeElement?t.children(".jstree-anchor").trigger("focus"):this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:e})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(e){var i=this.get_node(e),t=!1,n=!1,r=!1,a=w;if(!i)return!1;if(i.id===o.jstree.root)return this.redraw(!0);if(e=this.get_node(e,!0),!e||!e.length)return!1;if(e.children(".jstree-children").remove(),e=e[0],i.children.length&&i.state.loaded){for(r=a.createElement("UL"),r.setAttribute("role","group"),r.className="jstree-children",t=0,n=i.children.length;t<n;t++)r.appendChild(this.redraw_node(i.children[t],!0,!0));e.appendChild(r)}},redraw_node:function(e,i,t,n){var r=this.get_node(e),a=!1,l=!1,g=!1,D=!1,C=!1,b=!1,N="",W=w,K=this._model.data,E=!1,F=!1,I=null,j=0,ie=0,ee=!1,fe=!1;if(!r)return!1;if(r.id===o.jstree.root)return this.redraw(!0);if(i=i||r.children.length===0,e=w.querySelector?this.element[0].querySelector("#"+("0123456789".indexOf(r.id[0])!==-1?"\\3"+r.id[0]+" "+r.id.substr(1).replace(o.jstree.idregex,"\\$&"):r.id.replace(o.jstree.idregex,"\\$&"))):w.getElementById(r.id),e)e=o(e),t||(a=e.parent().parent()[0],a===this.element[0]&&(a=null),l=e.index()),!i&&r.children.length&&!e.children(".jstree-children").length&&(i=!0),i||(g=e.children(".jstree-children")[0]),E=e.children(".jstree-anchor")[0]===w.activeElement,e.remove();else if(i=!0,!t){if(a=r.parent!==o.jstree.root?o("#"+r.parent.replace(o.jstree.idregex,"\\$&"),this.element)[0]:null,a!==null&&(!a||!K[r.parent].state.opened))return!1;l=o.inArray(r.id,a===null?K[o.jstree.root].children:K[r.parent].children)}e=this._data.core.node.cloneNode(!0),N="jstree-node ";for(D in r.li_attr)if(r.li_attr.hasOwnProperty(D)){if(D==="id")continue;D!=="class"?e.setAttribute(D,r.li_attr[D]):N+=r.li_attr[D]}for(r.a_attr.id||(r.a_attr.id=r.id+"_anchor"),e.childNodes[1].setAttribute("aria-selected",!!r.state.selected),e.childNodes[1].setAttribute("aria-level",r.parents.length),this.settings.core.compute_elements_positions&&(e.childNodes[1].setAttribute("aria-setsize",K[r.parent].children.length),e.childNodes[1].setAttribute("aria-posinset",K[r.parent].children.indexOf(r.id)+1)),r.state.disabled&&e.childNodes[1].setAttribute("aria-disabled",!0),D=0,C=r.children.length;D<C;D++)if(!K[r.children[D]].state.hidden){ee=!0;break}if(r.parent!==null&&K[r.parent]&&!r.state.hidden&&(D=o.inArray(r.id,K[r.parent].children),fe=r.id,D!==-1))for(D++,C=K[r.parent].children.length;D<C&&(K[K[r.parent].children[D]].state.hidden||(fe=K[r.parent].children[D]),fe===r.id);D++);r.state.hidden&&(N+=" jstree-hidden"),r.state.loading&&(N+=" jstree-loading"),r.state.loaded&&!ee?N+=" jstree-leaf":(N+=r.state.opened&&r.state.loaded?" jstree-open":" jstree-closed",e.childNodes[1].setAttribute("aria-expanded",r.state.opened&&r.state.loaded)),fe===r.id&&(N+=" jstree-last"),e.id=r.id,e.className=N,N=(r.state.selected?" jstree-clicked":"")+(r.state.disabled?" jstree-disabled":"");for(C in r.a_attr)if(r.a_attr.hasOwnProperty(C)){if(C==="href"&&r.a_attr[C]==="#")continue;C!=="class"?e.childNodes[1].setAttribute(C,r.a_attr[C]):N+=" "+r.a_attr[C]}if(N.length&&(e.childNodes[1].className="jstree-anchor "+N),(r.icon&&r.icon!==!0||r.icon===!1)&&(r.icon===!1?e.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":r.icon.indexOf("/")===-1&&r.icon.indexOf(".")===-1?e.childNodes[1].childNodes[0].className+=" "+r.icon+" jstree-themeicon-custom":(e.childNodes[1].childNodes[0].style.backgroundImage='url("'+r.icon+'")',e.childNodes[1].childNodes[0].style.backgroundPosition="center center",e.childNodes[1].childNodes[0].style.backgroundSize="auto",e.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?e.childNodes[1].appendChild(W.createTextNode(r.text)):e.childNodes[1].innerHTML+=r.text,i&&r.children.length&&(r.state.opened||n)&&r.state.loaded){for(b=W.createElement("UL"),b.setAttribute("role","group"),b.className="jstree-children",D=0,C=r.children.length;D<C;D++)b.appendChild(this.redraw_node(r.children[D],i,!0));e.appendChild(b)}if(g&&e.appendChild(g),!t){for(a||(a=this.element[0]),D=0,C=a.childNodes.length;D<C;D++)if(a.childNodes[D]&&a.childNodes[D].className&&a.childNodes[D].className.indexOf("jstree-children")!==-1){I=a.childNodes[D];break}I||(I=W.createElement("UL"),I.setAttribute("role","group"),I.className="jstree-children",a.appendChild(I)),a=I,l<a.childNodes.length?a.insertBefore(e,a.childNodes[l]):a.appendChild(e),E&&(j=this.element[0].scrollTop,ie=this.element[0].scrollLeft,e.childNodes[1].focus(),this.element[0].scrollTop=j,this.element[0].scrollLeft=ie)}return r.state.opened&&!r.state.loaded&&(r.state.opened=!1,setTimeout(function(){this.open_node(r.id,!1,0)}.bind(this),0)),e},open_node:function(e,i,t){var n,r,a,l;if(o.vakata.is_array(e)){for(e=e.slice(),n=0,r=e.length;n<r;n++)this.open_node(e[n],i,t);return!0}if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;if(t=t===d?this.settings.core.animation:t,!this.is_closed(e))return i&&i.call(this,e,!1),!1;if(this.is_loaded(e))return a=this.get_node(e,!0),l=this,a.length&&(t&&a.children(".jstree-children").length&&a.children(".jstree-children").stop(!0,!0),e.children.length&&!this._firstChild(a.children(".jstree-children")[0])&&this.draw_children(e),t?(this.trigger("before_open",{node:e}),a.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children(".jstree-anchor").attr("aria-expanded",!0).end().children(".jstree-children").stop(!0,!0).slideDown(t,function(){this.style.display="",l.element&&l.trigger("after_open",{node:e})})):(this.trigger("before_open",{node:e}),a[0].className=a[0].className.replace("jstree-closed","jstree-open"),a[0].childNodes[1].setAttribute("aria-expanded",!0))),e.state.opened=!0,i&&i.call(this,e,!0),a.length||this.trigger("before_open",{node:e}),this.trigger("open_node",{node:e}),(!t||!a.length)&&this.trigger("after_open",{node:e}),!0;if(this.is_loading(e))return setTimeout(function(){this.open_node(e,i,t)}.bind(this),500);this.load_node(e,function(g,D){return D?this.open_node(g,i,t):i?i.call(this,g,!1):!1})},_open_to:function(e){if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;var i,t,n=e.parents;for(i=0,t=n.length;i<t;i+=1)i!==o.jstree.root&&this.open_node(n[i],!1,0);return o("#"+e.id.replace(o.jstree.idregex,"\\$&"),this.element)},close_node:function(e,i){var t,n,r,a;if(o.vakata.is_array(e)){for(e=e.slice(),t=0,n=e.length;t<n;t++)this.close_node(e[t],i);return!0}if(e=this.get_node(e),!e||e.id===o.jstree.root||this.is_closed(e))return!1;i=i===d?this.settings.core.animation:i,r=this,a=this.get_node(e,!0),e.state.opened=!1,this.trigger("close_node",{node:e}),a.length?i?a.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children(".jstree-anchor").attr("aria-expanded",!1).end().children(".jstree-children").stop(!0,!0).slideUp(i,function(){this.style.display="",a.children(".jstree-children").remove(),r.element&&r.trigger("after_close",{node:e})}):(a[0].className=a[0].className.replace("jstree-open","jstree-closed"),a.children(".jstree-anchor").attr("aria-expanded",!1),a.children(".jstree-children").remove(),this.trigger("after_close",{node:e})):this.trigger("after_close",{node:e})},toggle_node:function(e){var i,t;if(o.vakata.is_array(e)){for(e=e.slice(),i=0,t=e.length;i<t;i++)this.toggle_node(e[i]);return!0}if(this.is_closed(e))return this.open_node(e);if(this.is_open(e))return this.close_node(e)},open_all:function(e,i,t){if(e||(e=o.jstree.root),e=this.get_node(e),!e)return!1;var n=e.id===o.jstree.root?this.get_container_ul():this.get_node(e,!0),r,a,l;if(!n.length){for(r=0,a=e.children_d.length;r<a;r++)this.is_closed(this._model.data[e.children_d[r]])&&(this._model.data[e.children_d[r]].state.opened=!0);return this.trigger("open_all",{node:e})}t=t||n,l=this,n=this.is_closed(e)?n.find(".jstree-closed").addBack():n.find(".jstree-closed"),n.each(function(){l.open_node(this,function(g,D){D&&this.is_parent(g)&&this.open_all(g,i,t)},i||0)}),t.find(".jstree-closed").length===0&&this.trigger("open_all",{node:this.get_node(t)})},close_all:function(e,i){if(e||(e=o.jstree.root),e=this.get_node(e),!e)return!1;var t=e.id===o.jstree.root?this.get_container_ul():this.get_node(e,!0),n=this,r,a;for(t.length&&(t=this.is_open(e)?t.find(".jstree-open").addBack():t.find(".jstree-open"),o(t.get().reverse()).each(function(){n.close_node(this,i||0)})),r=0,a=e.children_d.length;r<a;r++)this._model.data[e.children_d[r]].state.opened=!1;this.trigger("close_all",{node:e})},is_disabled:function(e){return e=this.get_node(e),e&&e.state&&e.state.disabled},enable_node:function(e){var i,t;if(o.vakata.is_array(e)){for(e=e.slice(),i=0,t=e.length;i<t;i++)this.enable_node(e[i]);return!0}if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;e.state.disabled=!1,this.get_node(e,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:e})},disable_node:function(e){var i,t;if(o.vakata.is_array(e)){for(e=e.slice(),i=0,t=e.length;i<t;i++)this.disable_node(e[i]);return!0}if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;e.state.disabled=!0,this.get_node(e,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:e})},is_hidden:function(e){return e=this.get_node(e),e.state.hidden===!0},hide_node:function(e,i){var t,n;if(o.vakata.is_array(e)){for(e=e.slice(),t=0,n=e.length;t<n;t++)this.hide_node(e[t],!0);return i||this.redraw(),!0}if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;e.state.hidden||(e.state.hidden=!0,this._node_changed(e.parent),i||this.redraw(),this.trigger("hide_node",{node:e}))},show_node:function(e,i){var t,n;if(o.vakata.is_array(e)){for(e=e.slice(),t=0,n=e.length;t<n;t++)this.show_node(e[t],!0);return i||this.redraw(),!0}if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;e.state.hidden&&(e.state.hidden=!1,this._node_changed(e.parent),i||this.redraw(),this.trigger("show_node",{node:e}))},hide_all:function(e){var i,t=this._model.data,n=[];for(i in t)t.hasOwnProperty(i)&&i!==o.jstree.root&&!t[i].state.hidden&&(t[i].state.hidden=!0,n.push(i));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("hide_all",{nodes:n}),n},show_all:function(e){var i,t=this._model.data,n=[];for(i in t)t.hasOwnProperty(i)&&i!==o.jstree.root&&t[i].state.hidden&&(t[i].state.hidden=!1,n.push(i));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("show_all",{nodes:n}),n},activate_node:function(e,i){if(this.is_disabled(e))return!1;if((!i||typeof i!="object")&&(i={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==d?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),!this.settings.core.multiple||!i.metaKey&&!i.ctrlKey&&!i.shiftKey||i.shiftKey&&(!this._data.core.last_clicked||!this.get_parent(e)||this.get_parent(e)!==this._data.core.last_clicked.parent))!this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,i):((!this.is_selected(e)||this._data.core.selected.length!==1)&&(this.deselect_all(!0),this.select_node(e,!1,!1,i)),this._data.core.last_clicked=this.get_node(e));else if(i.shiftKey){var t=this.get_node(e).id,n=this._data.core.last_clicked.id,r=this.get_node(this._data.core.last_clicked.parent).children,a=!1,l,g;for(l=0,g=r.length;l<g;l+=1)r[l]===t&&(a=!a),r[l]===n&&(a=!a),!this.is_disabled(r[l])&&(a||r[l]===t||r[l]===n)?this.is_hidden(r[l])||this.select_node(r[l],!0,!1,i):i.ctrlKey||this.deselect_node(r[l],!0,i);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:i})}else this.is_selected(e)?this.deselect_node(e,!1,i):(i.ctrlKey&&(this._data.core.last_clicked=this.get_node(e)),this.select_node(e,!1,!1,i));this.trigger("activate_node",{node:this.get_node(e),event:i})},hover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||e.children(".jstree-hovered").length)return!1;var i=this.element.find(".jstree-hovered"),t=this.element;i&&i.length&&this.dehover_node(i),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){t.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||!e.children(".jstree-hovered").length)return!1;e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(e,i,t,n){var r,a,l,g;if(o.vakata.is_array(e)){for(e=e.slice(),a=0,l=e.length;a<l;a++)this.select_node(e[a],i,t,n);return!0}if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;r=this.get_node(e,!0),e.state.selected||(e.state.selected=!0,this._data.core.selected.push(e.id),t||(r=this._open_to(e)),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-clicked").attr("aria-selected",!0),this.trigger("select_node",{node:e,selected:this._data.core.selected,event:n}),i||this.trigger("changed",{action:"select_node",node:e,selected:this._data.core.selected,event:n}))},deselect_node:function(e,i,t){var n,r,a;if(o.vakata.is_array(e)){for(e=e.slice(),n=0,r=e.length;n<r;n++)this.deselect_node(e[n],i,t);return!0}if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;a=this.get_node(e,!0),e.state.selected&&(e.state.selected=!1,this._data.core.selected=o.vakata.array_remove_item(this._data.core.selected,e.id),a.length&&a.children(".jstree-anchor").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_node",{node:e,selected:this._data.core.selected,event:t}),i||this.trigger("changed",{action:"deselect_node",node:e,selected:this._data.core.selected,event:t}))},select_all:function(e){var i=this._data.core.selected.concat([]),t,n;for(this._data.core.selected=this._model.data[o.jstree.root].children_d.concat(),t=0,n=this._data.core.selected.length;t<n;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),e||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:i})},deselect_all:function(e){var i=this._data.core.selected.concat([]),t,n;for(t=0,n=this._data.core.selected.length;t<n;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:i}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(e){return e=this.get_node(e),!e||e.id===o.jstree.root?!1:e.state.selected},get_selected:function(e){return e?o.map(this._data.core.selected,function(i){return this.get_node(i)}.bind(this)):this._data.core.selected.slice()},get_top_selected:function(e){var i=this.get_selected(!0),t={},n,r,a,l;for(n=0,r=i.length;n<r;n++)t[i[n].id]=i[n];for(n=0,r=i.length;n<r;n++)for(a=0,l=i[n].children_d.length;a<l;a++)t[i[n].children_d[a]]&&delete t[i[n].children_d[a]];i=[];for(n in t)t.hasOwnProperty(n)&&i.push(n);return e?o.map(i,function(g){return this.get_node(g)}.bind(this)):i},get_bottom_selected:function(e){var i=this.get_selected(!0),t=[],n,r;for(n=0,r=i.length;n<r;n++)i[n].children.length||t.push(i[n].id);return e?o.map(t,function(a){return this.get_node(a)}.bind(this)):t},get_state:function(){var e={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}},i;for(i in this._model.data)this._model.data.hasOwnProperty(i)&&i!==o.jstree.root&&(this._model.data[i].state.loaded&&this.settings.core.loaded_state&&e.core.loaded.push(i),this._model.data[i].state.opened&&e.core.open.push(i),this._model.data[i].state.selected&&e.core.selected.push(i));return e},set_state:function(e,i){if(e){if(e.core&&e.core.selected&&e.core.initial_selection===d&&(e.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),e.core){var t,n,r,a,l;if(e.core.loaded)return!this.settings.core.loaded_state||!o.vakata.is_array(e.core.loaded)||!e.core.loaded.length?(delete e.core.loaded,this.set_state(e,i)):this._load_nodes(e.core.loaded,function(g){delete e.core.loaded,this.set_state(e,i)}),!1;if(e.core.open)return!o.vakata.is_array(e.core.open)||!e.core.open.length?(delete e.core.open,this.set_state(e,i)):this._load_nodes(e.core.open,function(g){this.open_node(g,!1,0),delete e.core.open,this.set_state(e,i)}),!1;if(e.core.scroll)return e.core.scroll&&e.core.scroll.left!==d&&this.element.scrollLeft(e.core.scroll.left),e.core.scroll&&e.core.scroll.top!==d&&this.element.scrollTop(e.core.scroll.top),delete e.core.scroll,this.set_state(e,i),!1;if(e.core.selected)return a=this,(e.core.initial_selection===d||e.core.initial_selection===this._data.core.selected.concat([]).sort().join(","))&&(this.deselect_all(),o.each(e.core.selected,function(g,D){a.select_node(D,!1,!0)})),delete e.core.initial_selection,delete e.core.selected,this.set_state(e,i),!1;for(l in e)e.hasOwnProperty(l)&&l!=="core"&&o.inArray(l,this.settings.plugins)===-1&&delete e[l];if(o.isEmptyObject(e.core))return delete e.core,this.set_state(e,i),!1}return o.isEmptyObject(e)?(e=null,i&&i.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(e,i){this._data.core.state=i===!0?{}:this.get_state(),i&&o.vakata.is_function(i)&&(this._data.core.state=i.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[o.jstree.root]={id:o.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var t=this.get_container_ul()[0].className;e||(this.element.html("<ul class='"+t+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(o.jstree.root,function(n,r){r&&(this.get_container_ul()[0].className=t,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(o.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(e){if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;var i=[],t=[],n=this._data.core.selected.concat([]);t.push(e.id),e.state.opened===!0&&i.push(e.id),this.get_node(e,!0).find(".jstree-open").each(function(){t.push(this.id),i.push(this.id)}),this._load_nodes(t,function(r){this.open_node(i,!1,0),this.select_node(n),this.trigger("refresh_node",{node:e,nodes:r})}.bind(this),!1,!0)},set_id:function(e,i){if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;var t,n,r=this._model.data,a=e.id;for(i=i.toString(),r[e.parent].children[o.inArray(e.id,r[e.parent].children)]=i,t=0,n=e.parents.length;t<n;t++)r[e.parents[t]].children_d[o.inArray(e.id,r[e.parents[t]].children_d)]=i;for(t=0,n=e.children.length;t<n;t++)r[e.children[t]].parent=i;for(t=0,n=e.children_d.length;t<n;t++)r[e.children_d[t]].parents[o.inArray(e.id,r[e.children_d[t]].parents)]=i;return t=o.inArray(e.id,this._data.core.selected),t!==-1&&(this._data.core.selected[t]=i),t=this.get_node(e.id,!0),t&&(t.attr("id",i),this.element.attr("aria-activedescendant")===e.id&&this.element.attr("aria-activedescendant",i)),delete r[e.id],e.id=i,e.li_attr.id=i,r[i]=e,this.trigger("set_id",{node:e,new:e.id,old:a}),!0},get_text:function(e){return e=this.get_node(e),!e||e.id===o.jstree.root?!1:e.text},set_text:function(e,i){var t,n;if(o.vakata.is_array(e)){for(e=e.slice(),t=0,n=e.length;t<n;t++)this.set_text(e[t],i);return!0}return e=this.get_node(e),!e||e.id===o.jstree.root?!1:(e.text=i,this.get_node(e,!0).length&&this.redraw_node(e.id),this.trigger("set_text",{obj:e,text:i}),!0)},get_json:function(e,i,t){if(e=this.get_node(e||o.jstree.root),!e)return!1;i&&i.flat&&!t&&(t=[]);var n={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:o.extend(!0,{},e.li_attr),a_attr:o.extend(!0,{},e.a_attr),state:{},data:i&&i.no_data?!1:o.extend(!0,o.vakata.is_array(e.data)?[]:{},e.data)},r,a;if(i&&i.flat?n.parent=e.parent:n.children=[],!i||!i.no_state)for(r in e.state)e.state.hasOwnProperty(r)&&(n.state[r]=e.state[r]);else delete n.state;if(i&&i.no_li_attr&&delete n.li_attr,i&&i.no_a_attr&&delete n.a_attr,i&&i.no_id&&(delete n.id,n.li_attr&&n.li_attr.id&&delete n.li_attr.id,n.a_attr&&n.a_attr.id&&delete n.a_attr.id),i&&i.flat&&e.id!==o.jstree.root&&t.push(n),!i||!i.no_children)for(r=0,a=e.children.length;r<a;r++)i&&i.flat?this.get_json(e.children[r],i,t):n.children.push(this.get_json(e.children[r],i));return i&&i.flat?t:e.id===o.jstree.root?n.children:n},create_node:function(e,i,t,n,r){if(e===null&&(e=o.jstree.root),e=this.get_node(e),!e)return!1;if(t=t===d?"last":t,!t.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(e))return this.load_node(e,function(){this.create_node(e,i,t,n,!0)});i||(i={text:this.get_string("New node")}),typeof i=="string"?i={text:i}:i=o.extend(!0,{},i),i.text===d&&(i.text=this.get_string("New node"));var a,l,g,D;switch(e.id===o.jstree.root&&(t==="before"&&(t="first"),t==="after"&&(t="last")),t){case"before":a=this.get_node(e.parent),t=o.inArray(e.id,a.children),e=a;break;case"after":a=this.get_node(e.parent),t=o.inArray(e.id,a.children)+1,e=a;break;case"inside":case"first":t=0;break;case"last":t=e.children.length;break;default:t||(t=0);break}if(t>e.children.length&&(t=e.children.length),i.id||(i.id=!0),!this.check("create_node",i,e,t))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.id===!0&&delete i.id,i=this._parse_model_from_json(i,e.id,e.parents.concat()),!i)return!1;for(a=this.get_node(i),l=[],l.push(i),l=l.concat(a.children_d),this.trigger("model",{nodes:l,parent:e.id}),e.children_d=e.children_d.concat(l),g=0,D=e.parents.length;g<D;g++)this._model.data[e.parents[g]].children_d=this._model.data[e.parents[g]].children_d.concat(l);for(i=a,a=[],g=0,D=e.children.length;g<D;g++)a[g>=t?g+1:g]=e.children[g];return a[t]=i.id,e.children=a,this.redraw_node(e,!0),this.trigger("create_node",{node:this.get_node(i),parent:e.id,position:t}),n&&n.call(this,this.get_node(i)),i.id},rename_node:function(e,i){var t,n,r;if(o.vakata.is_array(e)){for(e=e.slice(),t=0,n=e.length;t<n;t++)this.rename_node(e[t],i);return!0}return e=this.get_node(e),!e||e.id===o.jstree.root?!1:(r=e.text,this.check("rename_node",e,this.get_parent(e),i)?(this.set_text(e,i),this.trigger("rename_node",{node:e,text:i,old:r}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(e){var i,t,n,r,a,l,g,D,C,b,N,W;if(o.vakata.is_array(e)){for(e=e.slice(),i=0,t=e.length;i<t;i++)this.delete_node(e[i]);return!0}if(e=this.get_node(e),!e||e.id===o.jstree.root)return!1;if(n=this.get_node(e.parent),r=o.inArray(e.id,n.children),b=!1,!this.check("delete_node",e,n,r))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(r!==-1&&(n.children=o.vakata.array_remove(n.children,r)),a=e.children_d.concat([]),a.push(e.id),l=0,g=e.parents.length;l<g;l++)this._model.data[e.parents[l]].children_d=o.vakata.array_filter(this._model.data[e.parents[l]].children_d,function(K){return o.inArray(K,a)===-1});for(D=0,C=a.length;D<C;D++)if(this._model.data[a[D]].state.selected){b=!0;break}for(b&&(this._data.core.selected=o.vakata.array_filter(this._data.core.selected,function(K){return o.inArray(K,a)===-1})),this.trigger("delete_node",{node:e,parent:n.id}),b&&this.trigger("changed",{action:"delete_node",node:e,selected:this._data.core.selected,parent:n.id}),D=0,C=a.length;D<C;D++)delete this._model.data[a[D]];return o.inArray(this._data.core.focused,a)!==-1&&(this._data.core.focused=null,N=this.element[0].scrollTop,W=this.element[0].scrollLeft,n.id===o.jstree.root?this._model.data[o.jstree.root].children[0]&&this.get_node(this._model.data[o.jstree.root].children[0],!0).children(".jstree-anchor").trigger("focus"):this.get_node(n,!0).children(".jstree-anchor").trigger("focus"),this.element[0].scrollTop=N,this.element[0].scrollLeft=W),this.redraw_node(n,!0),!0},check:function(e,i,t,n,r){i=i&&i.id?i:this.get_node(i),t=t&&t.id?t:this.get_node(t);var a=e.match(/^(move_node|copy_node|create_node)$/i)?t:i,l=this.settings.core.check_callback;if(e==="move_node"||e==="copy_node"){if((!r||!r.is_multi)&&e==="move_node"&&o.inArray(i.id,t.children)===n)return this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:e,pos:n,obj:i&&i.id?i.id:!1,par:t&&t.id?t.id:!1})},!1;if((!r||!r.is_multi)&&(i.id===t.id||e==="move_node"&&o.inArray(i.id,t.children)===n||o.inArray(t.id,i.children_d)!==-1))return this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:e,pos:n,obj:i&&i.id?i.id:!1,par:t&&t.id?t.id:!1})},!1}return a&&a.data&&(a=a.data),a&&a.functions&&(a.functions[e]===!1||a.functions[e]===!0)?(a.functions[e]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+e,data:JSON.stringify({chk:e,pos:n,obj:i&&i.id?i.id:!1,par:t&&t.id?t.id:!1})}),a.functions[e]):l===!1||o.vakata.is_function(l)&&l.call(this,e,i,t,n,r)===!1||l&&l[e]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+e,data:JSON.stringify({chk:e,pos:n,obj:i&&i.id?i.id:!1,par:t&&t.id?t.id:!1})},!1):!0},last_error:function(){return this._data.core.last_error},move_node:function(e,i,t,n,r,a,l){var g,D,C,b,N,W,K,E,F,I,j,ie,ee,fe;if(i=this.get_node(i),t=t===d?0:t,!i)return!1;if(!t.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(i))return this.load_node(i,function(){this.move_node(e,i,t,n,!0,!1,l)});if(o.vakata.is_array(e))if(e.length===1)e=e[0];else{for(g=0,D=e.length;g<D;g++)(F=this.move_node(e[g],i,t,n,r,!1,l))&&(i=F,t="after");return this.redraw(),!0}if(e=e&&e.id?e:this.get_node(e),!e||e.id===o.jstree.root)return!1;if(C=(e.parent||o.jstree.root).toString(),N=!t.toString().match(/^(before|after)$/)||i.id===o.jstree.root?i:this.get_node(i.parent),W=l||(this._model.data[e.id]?this:o.jstree.reference(e.id)),K=!W||!W._id||this._id!==W._id,b=W&&W._id&&C&&W._model.data[C]&&W._model.data[C].children?o.inArray(e.id,W._model.data[C].children):-1,W&&W._id&&(e=W._model.data[e.id]),K)return(F=this.copy_node(e,i,t,n,r,!1,l))?(W&&W.delete_node(e),F):!1;switch(i.id===o.jstree.root&&(t==="before"&&(t="first"),t==="after"&&(t="last")),t){case"before":t=o.inArray(i.id,N.children);break;case"after":t=o.inArray(i.id,N.children)+1;break;case"inside":case"first":t=0;break;case"last":t=N.children.length;break;default:t||(t=0);break}if(t>N.children.length&&(t=N.children.length),!this.check("move_node",e,N,t,{core:!0,origin:l,is_multi:W&&W._id&&W._id!==this._id,is_foreign:!W||!W._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(e.parent===N.id){for(E=N.children.concat(),F=o.inArray(e.id,E),F!==-1&&(E=o.vakata.array_remove(E,F),t>F&&t--),F=[],I=0,j=E.length;I<j;I++)F[I>=t?I+1:I]=E[I];F[t]=e.id,N.children=F,this._node_changed(N.id),this.redraw(N.id===o.jstree.root)}else{for(F=e.children_d.concat(),F.push(e.id),I=0,j=e.parents.length;I<j;I++){for(E=[],fe=W._model.data[e.parents[I]].children_d,ie=0,ee=fe.length;ie<ee;ie++)o.inArray(fe[ie],F)===-1&&E.push(fe[ie]);W._model.data[e.parents[I]].children_d=E}for(W._model.data[C].children=o.vakata.array_remove_item(W._model.data[C].children,e.id),I=0,j=N.parents.length;I<j;I++)this._model.data[N.parents[I]].children_d=this._model.data[N.parents[I]].children_d.concat(F);for(E=[],I=0,j=N.children.length;I<j;I++)E[I>=t?I+1:I]=N.children[I];for(E[t]=e.id,N.children=E,N.children_d.push(e.id),N.children_d=N.children_d.concat(e.children_d),e.parent=N.id,F=N.parents.concat(),F.unshift(N.id),fe=e.parents.length,e.parents=F,F=F.concat(),I=0,j=e.children_d.length;I<j;I++)this._model.data[e.children_d[I]].parents=this._model.data[e.children_d[I]].parents.slice(0,fe*-1),Array.prototype.push.apply(this._model.data[e.children_d[I]].parents,F);(C===o.jstree.root||N.id===o.jstree.root)&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(C),this._node_changed(N.id)),a||this.redraw()}return n&&n.call(this,e,N,t),this.trigger("move_node",{node:e,parent:N.id,position:t,old_parent:C,old_position:b,is_multi:W&&W._id&&W._id!==this._id,is_foreign:!W||!W._id,old_instance:W,new_instance:this}),e.id},copy_node:function(e,i,t,n,r,a,l){var g,D,C,b,N,W,K,E,F,I,j;if(i=this.get_node(i),t=t===d?0:t,!i)return!1;if(!t.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(i))return this.load_node(i,function(){this.copy_node(e,i,t,n,!0,!1,l)});if(o.vakata.is_array(e))if(e.length===1)e=e[0];else{for(g=0,D=e.length;g<D;g++)(b=this.copy_node(e[g],i,t,n,r,!0,l))&&(i=b,t="after");return this.redraw(),!0}if(e=e&&e.id?e:this.get_node(e),!e||e.id===o.jstree.root)return!1;switch(E=(e.parent||o.jstree.root).toString(),F=!t.toString().match(/^(before|after)$/)||i.id===o.jstree.root?i:this.get_node(i.parent),I=l||(this._model.data[e.id]?this:o.jstree.reference(e.id)),j=!I||!I._id||this._id!==I._id,I&&I._id&&(e=I._model.data[e.id]),i.id===o.jstree.root&&(t==="before"&&(t="first"),t==="after"&&(t="last")),t){case"before":t=o.inArray(i.id,F.children);break;case"after":t=o.inArray(i.id,F.children)+1;break;case"inside":case"first":t=0;break;case"last":t=F.children.length;break;default:t||(t=0);break}if(t>F.children.length&&(t=F.children.length),!this.check("copy_node",e,F,t,{core:!0,origin:l,is_multi:I&&I._id&&I._id!==this._id,is_foreign:!I||!I._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(K=I?I.get_json(e,{no_id:!0,no_data:!0,no_state:!0}):e,!K||(K.id===!0&&delete K.id,K=this._parse_model_from_json(K,F.id,F.parents.concat()),!K))return!1;for(b=this.get_node(K),e&&e.state&&e.state.loaded===!1&&(b.state.loaded=!1),C=[],C.push(K),C=C.concat(b.children_d),this.trigger("model",{nodes:C,parent:F.id}),N=0,W=F.parents.length;N<W;N++)this._model.data[F.parents[N]].children_d=this._model.data[F.parents[N]].children_d.concat(C);for(C=[],N=0,W=F.children.length;N<W;N++)C[N>=t?N+1:N]=F.children[N];return C[t]=b.id,F.children=C,F.children_d.push(b.id),F.children_d=F.children_d.concat(b.children_d),F.id===o.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(F.id),a||this.redraw(F.id===o.jstree.root),n&&n.call(this,b,F,t),this.trigger("copy_node",{node:b,original:e,parent:F.id,position:t,old_parent:E,old_position:I&&I._id&&E&&I._model.data[E]&&I._model.data[E].children?o.inArray(e.id,I._model.data[E].children):-1,is_multi:I&&I._id&&I._id!==this._id,is_foreign:!I||!I._id,old_instance:I,new_instance:this}),b.id},cut:function(e){if(e||(e=this._data.core.selected.concat()),o.vakata.is_array(e)||(e=[e]),!e.length)return!1;var i=[],t,n,r;for(n=0,r=e.length;n<r;n++)t=this.get_node(e[n]),t&&t.id&&t.id!==o.jstree.root&&i.push(t);if(!i.length)return!1;M=i,u=this,B="move_node",this.trigger("cut",{node:e})},copy:function(e){if(e||(e=this._data.core.selected.concat()),o.vakata.is_array(e)||(e=[e]),!e.length)return!1;var i=[],t,n,r;for(n=0,r=e.length;n<r;n++)t=this.get_node(e[n]),t&&t.id&&t.id!==o.jstree.root&&i.push(t);if(!i.length)return!1;M=i,u=this,B="copy_node",this.trigger("copy",{node:e})},get_buffer:function(){return{mode:B,node:M,inst:u}},can_paste:function(){return B!==!1&&M!==!1},paste:function(e,i){if(e=this.get_node(e),!e||!B||!B.match(/^(copy_node|move_node)$/)||!M)return!1;this[B](M,e,i,!1,!1,!1,u)&&this.trigger("paste",{parent:e.id,node:M,mode:B}),M=!1,B=!1,u=!1},clear_buffer:function(){M=!1,B=!1,u=!1,this.trigger("clear_buffer")},edit:function(e,i,t){var n,r,a,l,g,D,C,b,N,W=!1;if(e=this.get_node(e),!e)return!1;if(!this.check("edit",e,this.get_parent(e)))return this.settings.core.error.call(this,this._data.core.last_error),!1;N=e,i=typeof i=="string"?i:e.text,this.set_text(e,""),e=this._open_to(e),N.text=i,n=this._data.core.rtl,r=this.element.width(),this._data.core.focused=N.id,a=e.children(".jstree-anchor").trigger("focus"),l=o("<span></span>");g=i,D=o("<div></div>",{css:{position:"absolute",top:"-200px",left:n?"0px":"-1000px",visibility:"hidden"}}).appendTo(w.body),C=o("<input />",{value:g,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:function(K){K.stopImmediatePropagation(),K.preventDefault();var E=l.children(".jstree-rename-input"),F=E.val(),I=this.settings.core.force_text,j;F===""&&(F=g),D.remove(),l.replaceWith(a),l.remove(),g=I?g:o("<div></div>").append(o.parseHTML(g)).html(),e=this.get_node(e),this.set_text(e,g),j=!!this.rename_node(e,I?o("<div></div>").text(F).text():o("<div></div>").append(o.parseHTML(F)).html()),j||this.set_text(e,g),this._data.core.focused=N.id,setTimeout(function(){var ie=this.get_node(N.id,!0);ie.length&&(this._data.core.focused=N.id,ie.children(".jstree-anchor").trigger("focus"))}.bind(this),0),t&&t.call(this,N,j,W,F),C=null}.bind(this),keydown:function(K){var E=K.which;E===27&&(W=!0,this.value=g),(E===27||E===13||E===37||E===38||E===39||E===40||E===32)&&K.stopImmediatePropagation(),(E===27||E===13)&&(K.preventDefault(),this.blur())},click:function(K){K.stopImmediatePropagation()},mousedown:function(K){K.stopImmediatePropagation()},keyup:function(K){C.width(Math.min(D.text("pW"+this.value).width(),r))},keypress:function(K){if(K.which===13)return!1}}),b={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""},l.attr("class",a.attr("class")).append(a.contents().clone()).append(C),a.replaceWith(l),D.css(b),C.css(b).width(Math.min(D.text("pW"+C[0].value).width(),r))[0].select(),o(w).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(K){C&&K.target!==C&&o(C).trigger("blur")})},set_theme:function(e,i){if(!e)return!1;if(i===!0){var t=this.settings.core.themes.dir;t||(t=o.jstree.path+"/themes"),i=t+"/"+e+"/style.css"}i&&o.inArray(i,_)===-1&&(o("head").append('<link rel="stylesheet" href="'+i+'" type="text/css" />'),_.push(i)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=e,this.element.addClass("jstree-"+e),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+e+"-responsive"),this.trigger("set_theme",{theme:e})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(e,i){var t,n,r,a;if(o.vakata.is_array(e)){for(e=e.slice(),t=0,n=e.length;t<n;t++)this.set_icon(e[t],i);return!0}return e=this.get_node(e),!e||e.id===o.jstree.root?!1:(a=e.icon,e.icon=i===!0||i===null||i===d||i===""?!0:i,r=this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon"),i===!1?(r.removeClass("jstree-themeicon-custom "+a).css("background","").removeAttr("rel"),this.hide_icon(e)):i===!0||i===null||i===d||i===""?(r.removeClass("jstree-themeicon-custom "+a).css("background","").removeAttr("rel"),a===!1&&this.show_icon(e)):i.indexOf("/")===-1&&i.indexOf(".")===-1?(r.removeClass(a).css("background",""),r.addClass(i+" jstree-themeicon-custom").attr("rel",i),a===!1&&this.show_icon(e)):(r.removeClass(a).css("background",""),r.addClass("jstree-themeicon-custom").css("background","url('"+i+"') center center no-repeat").attr("rel",i),a===!1&&this.show_icon(e)),!0)},get_icon:function(e){return e=this.get_node(e),!e||e.id===o.jstree.root?!1:e.icon},hide_icon:function(e){var i,t;if(o.vakata.is_array(e)){for(e=e.slice(),i=0,t=e.length;i<t;i++)this.hide_icon(e[i]);return!0}return e=this.get_node(e),!e||e===o.jstree.root?!1:(e.icon=!1,this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(e){var i,t,n;if(o.vakata.is_array(e)){for(e=e.slice(),i=0,t=e.length;i<t;i++)this.show_icon(e[i]);return!0}return e=this.get_node(e),!e||e===o.jstree.root?!1:(n=this.get_node(e,!0),e.icon=n.length?n.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0,e.icon||(e.icon=!0),n.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},o.vakata={},o.vakata.attributes=function(e,i){e=o(e)[0];var t=i?{}:[];return e&&e.attributes&&o.each(e.attributes,function(n,r){o.inArray(r.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])===-1&&r.value!==null&&o.vakata.trim(r.value)!==""&&(i?t[r.name]=r.value:t.push(r.name))}),t},o.vakata.array_unique=function(e){var i=[],t,n,r,a={};for(t=0,r=e.length;t<r;t++)a[e[t]]===d&&(i.push(e[t]),a[e[t]]=!0);return i},o.vakata.array_remove=function(e,i){return e.splice(i,1),e},o.vakata.array_remove_item=function(e,i){var t=o.inArray(i,e);return t!==-1?o.vakata.array_remove(e,t):e},o.vakata.array_filter=function(e,i,t,n,r){if(e.filter)return e.filter(i,t);n=[];for(r in e)~~r+""==r+""&&r>=0&&i.call(t,e[r],+r,e)&&n.push(e[r]);return n},o.vakata.trim=function(e){return String.prototype.trim?String.prototype.trim.call(e.toString()):e.toString().replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},o.vakata.is_function=function(e){return typeof e=="function"&&typeof e.nodeType!="number"},o.vakata.is_array=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},Function.prototype.bind||(Function.prototype.bind=function(){var e=this,i=arguments[0],t=Array.prototype.slice.call(arguments,1);if(typeof e!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");return function(){var n=t.concat(Array.prototype.slice.call(arguments));return e.apply(i,n)}}),o.jstree.plugins.changed=function(e,i){var t=[];this.trigger=function(n,r){var a,l;if(r||(r={}),n.replace(".jstree","")==="changed"){r.changed={selected:[],deselected:[]};var g={};for(a=0,l=t.length;a<l;a++)g[t[a]]=1;for(a=0,l=r.selected.length;a<l;a++)g[r.selected[a]]?g[r.selected[a]]=2:r.changed.selected.push(r.selected[a]);for(a=0,l=t.length;a<l;a++)g[t[a]]===1&&r.changed.deselected.push(t[a]);t=r.selected.slice()}i.trigger.call(this,n,r)},this.refresh=function(n,r){return t=[],i.refresh.apply(this,arguments)}};var P=w.createElement("I");P.className="jstree-icon jstree-checkbox",P.setAttribute("role","presentation"),o.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},o.jstree.plugins.checkbox=function(e,i){this.bind=function(){i.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")}.bind(this)).on("loading.jstree",function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()}.bind(this)),this.settings.checkbox.cascade.indexOf("undetermined")!==-1&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)}.bind(this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",function(t,n){var r=this._model.data,a=r[n.parent],l=n.nodes,g,D;for(g=0,D=l.length;g<D;g++)r[l[g]].state.checked=r[l[g]].state.checked||r[l[g]].original&&r[l[g]].original.state&&r[l[g]].original.state.checked,r[l[g]].state.checked&&this._data.checkbox.selected.push(l[g])}.bind(this)),(this.settings.checkbox.cascade.indexOf("up")!==-1||this.settings.checkbox.cascade.indexOf("down")!==-1)&&this.element.on("model.jstree",function(t,n){var r=this._model.data,a=r[n.parent],l=n.nodes,g=[],D,C,b,N,W,K,E=this.settings.checkbox.cascade,F=this.settings.checkbox.tie_selection;if(E.indexOf("down")!==-1){if(a.state[F?"selected":"checked"]){for(C=0,b=l.length;C<b;C++)r[l[C]].state[F?"selected":"checked"]=!0;this._data[F?"core":"checkbox"].selected=this._data[F?"core":"checkbox"].selected.concat(l)}else for(C=0,b=l.length;C<b;C++)if(r[l[C]].state[F?"selected":"checked"]){for(N=0,W=r[l[C]].children_d.length;N<W;N++)r[r[l[C]].children_d[N]].state[F?"selected":"checked"]=!0;this._data[F?"core":"checkbox"].selected=this._data[F?"core":"checkbox"].selected.concat(r[l[C]].children_d)}}if(E.indexOf("up")!==-1){for(C=0,b=a.children_d.length;C<b;C++)r[a.children_d[C]].children.length||g.push(r[a.children_d[C]].parent);for(g=o.vakata.array_unique(g),N=0,W=g.length;N<W;N++)for(a=r[g[N]];a&&a.id!==o.jstree.root;){for(D=0,C=0,b=a.children.length;C<b;C++)D+=r[a.children[C]].state[F?"selected":"checked"];if(D===b)a.state[F?"selected":"checked"]=!0,this._data[F?"core":"checkbox"].selected.push(a.id),K=this.get_node(a,!0),K&&K.length&&K.children(".jstree-anchor").attr("aria-selected",!0).addClass(F?"jstree-clicked":"jstree-checked");else break;a=this.get_node(a.parent)}}this._data[F?"core":"checkbox"].selected=o.vakata.array_unique(this._data[F?"core":"checkbox"].selected)}.bind(this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",function(t,n){var r=this,a=n.node,l=this._model.data,g=this.get_node(a.parent),D,C,b,N,W=this.settings.checkbox.cascade,K=this.settings.checkbox.tie_selection,E={},F=this._data[K?"core":"checkbox"].selected;for(D=0,C=F.length;D<C;D++)E[F[D]]=!0;if(W.indexOf("down")!==-1){var I=this._cascade_new_checked_state(a.id,!0),j=a.children_d.concat(a.id);for(D=0,C=j.length;D<C;D++)I.indexOf(j[D])>-1?E[j[D]]=!0:delete E[j[D]]}if(W.indexOf("up")!==-1)for(;g&&g.id!==o.jstree.root;){for(b=0,D=0,C=g.children.length;D<C;D++)b+=l[g.children[D]].state[K?"selected":"checked"];if(b===C)g.state[K?"selected":"checked"]=!0,E[g.id]=!0,N=this.get_node(g,!0),N&&N.length&&N.children(".jstree-anchor").attr("aria-selected",!0).addClass(K?"jstree-clicked":"jstree-checked");else break;g=this.get_node(g.parent)}F=[];for(D in E)E.hasOwnProperty(D)&&F.push(D);this._data[K?"core":"checkbox"].selected=F}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",function(t,n){var r=this.get_node(o.jstree.root),a=this._model.data,l,g,D;for(l=0,g=r.children_d.length;l<g;l++)D=a[r.children_d[l]],D&&D.original&&D.original.state&&D.original.state.undetermined&&(D.original.state.undetermined=!1)}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",function(t,n){var r=this,a=n.node,l=this.get_node(a,!0),g,D,C,b=this.settings.checkbox.cascade,N=this.settings.checkbox.tie_selection,W=this._data[N?"core":"checkbox"].selected,K={},E=[],F=a.children_d.concat(a.id);if(b.indexOf("down")!==-1){var I=this._cascade_new_checked_state(a.id,!1);W=o.vakata.array_filter(W,function(j){return F.indexOf(j)===-1||I.indexOf(j)>-1})}if(b.indexOf("up")!==-1&&W.indexOf(a.id)===-1){for(g=0,D=a.parents.length;g<D;g++)C=this._model.data[a.parents[g]],C.state[N?"selected":"checked"]=!1,C&&C.original&&C.original.state&&C.original.state.undetermined&&(C.original.state.undetermined=!1),C=this.get_node(a.parents[g],!0),C&&C.length&&C.children(".jstree-anchor").attr("aria-selected",!1).removeClass(N?"jstree-clicked":"jstree-checked");W=o.vakata.array_filter(W,function(j){return a.parents.indexOf(j)===-1})}this._data[N?"core":"checkbox"].selected=W}.bind(this)),this.settings.checkbox.cascade.indexOf("up")!==-1&&this.element.on("delete_node.jstree",function(t,n){for(var r=this.get_node(n.parent),a=this._model.data,l,g,D,C,b=this.settings.checkbox.tie_selection;r&&r.id!==o.jstree.root&&!r.state[b?"selected":"checked"];){for(D=0,l=0,g=r.children.length;l<g;l++)D+=a[r.children[l]].state[b?"selected":"checked"];if(g>0&&D===g)r.state[b?"selected":"checked"]=!0,this._data[b?"core":"checkbox"].selected.push(r.id),C=this.get_node(r,!0),C&&C.length&&C.children(".jstree-anchor").attr("aria-selected",!0).addClass(b?"jstree-clicked":"jstree-checked");else break;r=this.get_node(r.parent)}}.bind(this)).on("move_node.jstree",function(t,n){var r=n.is_multi,a=n.old_parent,l=this.get_node(n.parent),g=this._model.data,D,C,b,N,W,K=this.settings.checkbox.tie_selection;if(!r)for(D=this.get_node(a);D&&D.id!==o.jstree.root&&!D.state[K?"selected":"checked"];){for(C=0,b=0,N=D.children.length;b<N;b++)C+=g[D.children[b]].state[K?"selected":"checked"];if(N>0&&C===N)D.state[K?"selected":"checked"]=!0,this._data[K?"core":"checkbox"].selected.push(D.id),W=this.get_node(D,!0),W&&W.length&&W.children(".jstree-anchor").attr("aria-selected",!0).addClass(K?"jstree-clicked":"jstree-checked");else break;D=this.get_node(D.parent)}for(D=l;D&&D.id!==o.jstree.root;){for(C=0,b=0,N=D.children.length;b<N;b++)C+=g[D.children[b]].state[K?"selected":"checked"];if(C===N)D.state[K?"selected":"checked"]||(D.state[K?"selected":"checked"]=!0,this._data[K?"core":"checkbox"].selected.push(D.id),W=this.get_node(D,!0),W&&W.length&&W.children(".jstree-anchor").attr("aria-selected",!0).addClass(K?"jstree-clicked":"jstree-checked"));else if(D.state[K?"selected":"checked"])D.state[K?"selected":"checked"]=!1,this._data[K?"core":"checkbox"].selected=o.vakata.array_remove_item(this._data[K?"core":"checkbox"].selected,D.id),W=this.get_node(D,!0),W&&W.length&&W.children(".jstree-anchor").attr("aria-selected",!1).removeClass(K?"jstree-clicked":"jstree-checked");else break;D=this.get_node(D.parent)}}.bind(this))},this.get_undetermined=function(t){if(this.settings.checkbox.cascade.indexOf("undetermined")===-1)return[];var n,r,a,l,g={},D=this._model.data,C=this.settings.checkbox.tie_selection,b=this._data[C?"core":"checkbox"].selected,N=[],W=this,K=[];for(n=0,r=b.length;n<r;n++)if(D[b[n]]&&D[b[n]].parents)for(a=0,l=D[b[n]].parents.length;a<l&&g[D[b[n]].parents[a]]===d;a++)D[b[n]].parents[a]!==o.jstree.root&&(g[D[b[n]].parents[a]]=!0,N.push(D[b[n]].parents[a]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var E=W.get_node(this),F;if(!!E){if(E.state.loaded){for(n=0,r=E.children_d.length;n<r;n++)if(F=D[E.children_d[n]],!F.state.loaded&&F.original&&F.original.state&&F.original.state.undetermined&&F.original.state.undetermined===!0)for(g[F.id]===d&&F.id!==o.jstree.root&&(g[F.id]=!0,N.push(F.id)),a=0,l=F.parents.length;a<l;a++)g[F.parents[a]]===d&&F.parents[a]!==o.jstree.root&&(g[F.parents[a]]=!0,N.push(F.parents[a]))}else if(E.original&&E.original.state&&E.original.state.undetermined&&E.original.state.undetermined===!0)for(g[E.id]===d&&E.id!==o.jstree.root&&(g[E.id]=!0,N.push(E.id)),a=0,l=E.parents.length;a<l;a++)g[E.parents[a]]===d&&E.parents[a]!==o.jstree.root&&(g[E.parents[a]]=!0,N.push(E.parents[a]))}}),n=0,r=N.length;n<r;n++)D[N[n]].state[C?"selected":"checked"]||K.push(t?D[N[n]]:N[n]);return K},this._undetermined=function(){if(this.element!==null){var t=this.get_undetermined(!1),n,r,a;for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),n=0,r=t.length;n<r;n++)a=this.get_node(t[n],!0),a&&a.length&&a.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(t,n,r,a){if(t=i.redraw_node.apply(this,arguments),t){var l,g,D=null,C=null;for(l=0,g=t.childNodes.length;l<g;l++)if(t.childNodes[l]&&t.childNodes[l].className&&t.childNodes[l].className.indexOf("jstree-anchor")!==-1){D=t.childNodes[l];break}D&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(D.className+=" jstree-checked"),C=P.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(C.className+=" jstree-checkbox-disabled"),D.insertBefore(C,D.childNodes[0]))}return!r&&this.settings.checkbox.cascade.indexOf("undetermined")!==-1&&(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var n=this.settings.checkbox.cascade,r,a,l=this.settings.checkbox.tie_selection,g=this._data[l?"core":"checkbox"].selected,D=this._model.data;if(!t||t.state[l?"selected":"checked"]===!0||n.indexOf("undetermined")===-1||n.indexOf("down")===-1&&n.indexOf("up")===-1)return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(r=0,a=t.children_d.length;r<a;r++)if(o.inArray(t.children_d[r],g)!==-1||!D[t.children_d[r]].state.loaded&&D[t.children_d[r]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var n,r,a;if(o.vakata.is_array(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.disable_checkbox(t[n]);return!0}if(t=this.get_node(t),!t||t.id===o.jstree.root)return!1;a=this.get_node(t,!0),t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,a&&a.length&&a.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))},this.enable_checkbox=function(t){var n,r,a;if(o.vakata.is_array(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.enable_checkbox(t[n]);return!0}if(t=this.get_node(t),!t||t.id===o.jstree.root)return!1;a=this.get_node(t,!0),t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,a&&a.length&&a.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))},this.activate_node=function(t,n){if(o(n.target).hasClass("jstree-checkbox-disabled"))return!1;if(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||o(n.target).hasClass("jstree-checkbox"))&&(n.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!o(n.target).hasClass("jstree-checkbox"))return i.activate_node.call(this,t,n);if(this.is_disabled(t))return!1;this.is_checked(t)?this.uncheck_node(t,n):this.check_node(t,n),this.trigger("activate_node",{node:this.get_node(t)})},this.delete_node=function(t){if(this.settings.checkbox.tie_selection||o.vakata.is_array(t))return i.delete_node(t);var n,r,a,l=!1;if(t=this.get_node(t),!t||t.id===o.jstree.root)return!1;for(n=t.children_d.concat([]),n.push(t.id),r=0,a=n.length;r<a;r++)if(this._model.data[n[r]].state.checked){l=!0;break}return l&&(this._data.checkbox.selected=o.vakata.array_filter(this._data.checkbox.selected,function(g){return o.inArray(g,n)===-1})),i.delete_node.call(this,t)},this._cascade_new_checked_state=function(t,n){var r=this,a=this.settings.checkbox.tie_selection,l=this._model.data[t],g=[],D=[],C,b,N;if((this.settings.checkbox.cascade_to_disabled||!l.state.disabled)&&(this.settings.checkbox.cascade_to_hidden||!l.state.hidden)){if(l.children)for(C=0,b=l.children.length;C<b;C++){var W=l.children[C];N=r._cascade_new_checked_state(W,n),g=g.concat(N),N.indexOf(W)>-1&&D.push(W)}var K=r.get_node(l,!0),E=D.length>0&&D.length<l.children.length;l.original&&l.original.state&&l.original.state.undetermined&&(l.original.state.undetermined=E),E?(l.state[a?"selected":"checked"]=!1,K.children(".jstree-anchor").attr("aria-selected",!1).removeClass(a?"jstree-clicked":"jstree-checked")):n&&D.length===l.children.length?(l.state[a?"selected":"checked"]=n,g.push(l.id),K.children(".jstree-anchor").attr("aria-selected",!0).addClass(a?"jstree-clicked":"jstree-checked")):(l.state[a?"selected":"checked"]=!1,K.children(".jstree-anchor").attr("aria-selected",!1).removeClass(a?"jstree-clicked":"jstree-checked"))}else N=this.get_checked_descendants(t),l.state[a?"selected":"checked"]&&N.push(l.id),g=g.concat(N);return g},this.get_checked_descendants=function(t){var n=this,r=n.settings.checkbox.tie_selection,a=n._model.data[t];return o.vakata.array_filter(a.children_d,function(l){return n._model.data[l].state[r?"selected":"checked"]})},this.check_node=function(t,n){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,n);var r,a,l,g;if(o.vakata.is_array(t)){for(t=t.slice(),a=0,l=t.length;a<l;a++)this.check_node(t[a],n);return!0}if(t=this.get_node(t),!t||t.id===o.jstree.root)return!1;r=this.get_node(t,!0),t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:n}))},this.uncheck_node=function(t,n){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,n);var r,a,l;if(o.vakata.is_array(t)){for(t=t.slice(),r=0,a=t.length;r<a;r++)this.uncheck_node(t[r],n);return!0}if(t=this.get_node(t),!t||t.id===o.jstree.root)return!1;l=this.get_node(t,!0),t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=o.vakata.array_remove_item(this._data.checkbox.selected,t.id),l.length&&l.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:n}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t=this._data.checkbox.selected.concat([]),n,r;for(this._data.checkbox.selected=this._model.data[o.jstree.root].children_d.concat(),n=0,r=this._data.checkbox.selected.length;n<r;n++)this._model.data[this._data.checkbox.selected[n]]&&(this._model.data[this._data.checkbox.selected[n]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var t=this._data.checkbox.selected.concat([]),n,r;for(n=0,r=this._data.checkbox.selected.length;n<r;n++)this._model.data[this._data.checkbox.selected[n]]&&(this._model.data[this._data.checkbox.selected[n]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:t})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):(t=this.get_node(t),!t||t.id===o.jstree.root?!1:t.state.checked)},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?o.map(this._data.checkbox.selected,function(n){return this.get_node(n)}.bind(this)):this._data.checkbox.selected.slice()},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var n=this.get_checked(!0),r={},a,l,g,D;for(a=0,l=n.length;a<l;a++)r[n[a].id]=n[a];for(a=0,l=n.length;a<l;a++)for(g=0,D=n[a].children_d.length;g<D;g++)r[n[a].children_d[g]]&&delete r[n[a].children_d[g]];n=[];for(a in r)r.hasOwnProperty(a)&&n.push(a);return t?o.map(n,function(C){return this.get_node(C)}.bind(this)):n},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var n=this.get_checked(!0),r=[],a,l;for(a=0,l=n.length;a<l;a++)n[a].children.length||r.push(n[a].id);return t?o.map(r,function(g){return this.get_node(g)}.bind(this)):r},this.load_node=function(t,n){var r,a,l,g,D,C;if(!o.vakata.is_array(t)&&!this.settings.checkbox.tie_selection&&(C=this.get_node(t),C&&C.state.loaded))for(r=0,a=C.children_d.length;r<a;r++)this._model.data[C.children_d[r]].state.checked&&(D=!0,this._data.checkbox.selected=o.vakata.array_remove_item(this._data.checkbox.selected,C.children_d[r]));return i.load_node.apply(this,arguments)},this.get_state=function(){var t=i.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection||(t.checkbox=this._data.checkbox.selected.slice()),t},this.set_state=function(t,n){var r=i.set_state.apply(this,arguments);if(r&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var a=this;o.each(t.checkbox,function(l,g){a.check_node(g)})}return delete t.checkbox,this.set_state(t,n),!1}return r},this.refresh=function(t,n){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),i.refresh.apply(this,arguments)}},o.jstree.defaults.conditionalselect=function(){return!0},o.jstree.plugins.conditionalselect=function(e,i){this.activate_node=function(t,n){if(this.settings.conditionalselect.call(this,this.get_node(t),n))return i.activate_node.call(this,t,n)}},o.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(e,i){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var n=o.jstree.reference(t.reference),r=n.get_node(t.reference);n.create_node(r,{},"last",function(a){try{n.edit(a)}catch{setTimeout(function(){n.edit(a)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var n=o.jstree.reference(t.reference),r=n.get_node(t.reference);n.edit(r)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var n=o.jstree.reference(t.reference),r=n.get_node(t.reference);n.is_selected(r)?n.delete_node(n.get_selected()):n.delete_node(r)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var n=o.jstree.reference(t.reference),r=n.get_node(t.reference);n.is_selected(r)?n.cut(n.get_top_selected()):n.cut(r)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var n=o.jstree.reference(t.reference),r=n.get_node(t.reference);n.is_selected(r)?n.copy(n.get_top_selected()):n.copy(r)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!o.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var n=o.jstree.reference(t.reference),r=n.get_node(t.reference);n.paste(r)}}}}}}},o.jstree.plugins.contextmenu=function(e,i){this.bind=function(){i.bind.call(this);var t=0,n=null,r,a;this.element.on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-contextmenu")}.bind(this)).on("contextmenu.jstree",".jstree-anchor",function(l,g){l.target.tagName.toLowerCase()!=="input"&&(l.preventDefault(),t=l.ctrlKey?+new Date:0,(g||n)&&(t=+new Date+1e4),n&&clearTimeout(n),this.is_loading(l.currentTarget)||this.show_contextmenu(l.currentTarget,l.pageX,l.pageY,l))}.bind(this)).on("click.jstree",".jstree-anchor",function(l){this._data.contextmenu.visible&&(!t||+new Date-t>250)&&o.vakata.context.hide(),t=0}.bind(this)).on("touchstart.jstree",".jstree-anchor",function(l){!l.originalEvent||!l.originalEvent.changedTouches||!l.originalEvent.changedTouches[0]||(r=l.originalEvent.changedTouches[0].clientX,a=l.originalEvent.changedTouches[0].clientY,n=setTimeout(function(){o(l.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(l){n&&l.originalEvent&&l.originalEvent.changedTouches&&l.originalEvent.changedTouches[0]&&(Math.abs(r-l.originalEvent.changedTouches[0].clientX)>10||Math.abs(a-l.originalEvent.changedTouches[0].clientY)>10)&&(clearTimeout(n),o.vakata.context.hide())}).on("touchend.vakata.jstree",function(l){n&&clearTimeout(n)});o(w).on("context_hide.vakata.jstree",function(l,g){this._data.contextmenu.visible=!1,o(g.reference).removeClass("jstree-context")}.bind(this))},this.teardown=function(){this._data.contextmenu.visible&&o.vakata.context.hide(),o(w).off("context_hide.vakata.jstree"),i.teardown.call(this)},this.show_contextmenu=function(t,n,r,a){if(t=this.get_node(t),!t||t.id===o.jstree.root)return!1;var l=this.settings.contextmenu,g=this.get_node(t,!0),D=g.children(".jstree-anchor"),C=!1,b=!1;(l.show_at_node||n===d||r===d)&&(C=D.offset(),n=C.left,r=C.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(t)&&this.activate_node(t,a),b=l.items,o.vakata.is_function(b)&&(b=b.call(this,t,function(N){this._show_contextmenu(t,n,r,N)}.bind(this))),o.isPlainObject(b)&&this._show_contextmenu(t,n,r,b)},this._show_contextmenu=function(t,n,r,a){var l=this.get_node(t,!0),g=l.children(".jstree-anchor");o(w).one("context_show.vakata.jstree",function(D,C){var b="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";o(C.element).addClass(b),g.addClass("jstree-context")}.bind(this)),this._data.contextmenu.visible=!0,o.vakata.context.show(g,{x:n,y:r},a),this.trigger("show_contextmenu",{node:t,x:n,y:r})}},function(e){var i=!1,t={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(n){e(w).triggerHandler("context_"+n+".vakata",{reference:t.reference,element:t.element,position:{x:t.position_x,y:t.position_y}})},_execute:function(n){return n=t.items[n],n&&(!n._disabled||e.vakata.is_function(n._disabled)&&!n._disabled({item:n,reference:t.reference,element:t.element}))&&n.action?n.action.call(null,{item:n,reference:t.reference,element:t.element,position:{x:t.position_x,y:t.position_y}}):!1},_parse:function(n,r){if(!n)return!1;r||(t.html="",t.items=[]);var a="",l=!1,g;return r&&(a+="<ul>"),e.each(n,function(D,C){if(!C)return!0;t.items.push(C),!l&&C.separator_before&&(a+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'class="vakata-context-no-icons"')+">&#160;</a></li>"),l=!1,a+="<li class='"+(C._class||"")+(C._disabled===!0||e.vakata.is_function(C._disabled)&&C._disabled({item:C,reference:t.reference,element:t.element})?" vakata-contextmenu-disabled ":"")+"' "+(C.shortcut?" data-shortcut='"+C.shortcut+"' ":"")+">",a+="<a href='#' rel='"+(t.items.length-1)+"' "+(C.title?"title='"+C.title+"'":"")+">",e.vakata.context.settings.icons&&(a+="<i ",C.icon&&(C.icon.indexOf("/")!==-1||C.icon.indexOf(".")!==-1?a+=` style='background:url("`+C.icon+`") center center no-repeat' `:a+=" class='"+C.icon+"' "),a+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),a+=(e.vakata.is_function(C.label)?C.label({item:D,reference:t.reference,element:t.element}):C.label)+(C.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+C.shortcut+'">'+(C.shortcut_label||"")+"</span>":"")+"</a>",C.submenu&&(g=e.vakata.context._parse(C.submenu,!0),g&&(a+=g)),a+="</li>",C.separator_after&&(a+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'class="vakata-context-no-icons"')+">&#160;</a></li>",l=!0)}),a=a.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),r&&(a+="</ul>"),r||(t.html=a,e.vakata.context._trigger("parse")),a.length>10?a:!1},_show_submenu:function(n){if(n=e(n),!(!n.length||!n.children("ul").length)){var r=n.children("ul"),a=n.offset().left,l=a+n.outerWidth(),g=n.offset().top,D=r.width(),C=r.height(),b=e(window).width()+e(window).scrollLeft(),N=e(window).height()+e(window).scrollTop();i?n[l-(D+10+n.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):n[l+D>b&&a>b-l?"addClass":"removeClass"]("vakata-context-right"),g+C+10>N&&r.css("bottom","-1px"),n.hasClass("vakata-context-right")?a<D&&r.css("margin-right",a-D):b-l<D&&r.css("margin-left",b-l-D),r.show()}},show:function(n,r,a){var l,g,D,C,b,N,W,K,E=!0;switch(t.element&&t.element.length&&t.element.width(""),E){case(!r&&!n):return!1;case(!!r&&!!n):t.reference=n,t.position_x=r.x,t.position_y=r.y;break;case(!r&&!!n):t.reference=n,l=n.offset(),t.position_x=l.left+n.outerHeight(),t.position_y=l.top;break;case(!!r&&!n):t.position_x=r.x,t.position_y=r.y;break}!!n&&!a&&e(n).data("vakata_contextmenu")&&(a=e(n).data("vakata_contextmenu")),e.vakata.context._parse(a)&&t.element.html(t.html),t.items.length&&(t.element.appendTo(w.body),g=t.element,D=t.position_x,C=t.position_y,b=g.width(),N=g.height(),W=e(window).width()+e(window).scrollLeft(),K=e(window).height()+e(window).scrollTop(),i&&(D-=g.outerWidth()-e(n).outerWidth(),D<e(window).scrollLeft()+20&&(D=e(window).scrollLeft()+20)),D+b+20>W&&(D=W-(b+20)),C+N+20>K&&(C=K-(N+20)),t.element.css({left:D,top:C}).show().find("a").first().trigger("focus").parent().addClass("vakata-context-hover"),t.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){t.is_visible&&(t.element.hide().find("ul").hide().end().find(":focus").trigger("blur").end().detach(),t.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){i=e(w.body).css("direction")==="rtl";var n=!1;t.element=e("<ul class='vakata-context'></ul>"),t.element.on("mouseenter","li",function(r){r.stopImmediatePropagation(),!e.contains(this,r.relatedTarget)&&(n&&clearTimeout(n),t.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(r){e.contains(this,r.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(r){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(n=setTimeout(function(a){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(r){r.preventDefault(),!e(this).trigger("blur").parent().hasClass("vakata-context-disabled")&&e.vakata.context._execute(e(this).attr("rel"))!==!1&&e.vakata.context.hide()}).on("keydown","a",function(r){var a=null;switch(r.which){case 13:case 32:r.type="click",r.preventDefault(),e(r.currentTarget).trigger(r);break;case 37:t.is_visible&&(t.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").trigger("focus"),r.stopImmediatePropagation(),r.preventDefault());break;case 38:t.is_visible&&(a=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),a.length||(a=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),a.addClass("vakata-context-hover").children("a").trigger("focus"),r.stopImmediatePropagation(),r.preventDefault());break;case 39:t.is_visible&&(t.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").trigger("focus"),r.stopImmediatePropagation(),r.preventDefault());break;case 40:t.is_visible&&(a=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),a.length||(a=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),a.addClass("vakata-context-hover").children("a").trigger("focus"),r.stopImmediatePropagation(),r.preventDefault());break;case 27:e.vakata.context.hide(),r.preventDefault();break;default:break}}).on("keydown",function(r){r.preventDefault();var a=t.element.find(".vakata-contextmenu-shortcut-"+r.which).parent();a.parent().not(".vakata-context-disabled")&&a.trigger("click")}),e(w).on("mousedown.vakata.jstree",function(r){t.is_visible&&t.element[0]!==r.target&&!e.contains(t.element[0],r.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(r,a){t.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),i&&t.element.addClass("vakata-context-rtl").css("direction","rtl"),t.element.find("ul").hide().end()})})}(o),o.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1,blank_space_drop:!1};var A,S;o.jstree.plugins.dnd=function(e,i){this.init=function(t,n){i.init.call(this,t,n),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in w.createElement("span")},this.bind=function(){i.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",function(t){if(this.settings.dnd.large_drag_target&&o(t.target).closest(".jstree-node")[0]!==t.currentTarget||t.type==="touchstart"&&(!this.settings.dnd.touch||this.settings.dnd.touch==="selected"&&!o(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var n=this.get_node(t.target),r=this.is_selected(n)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,a=r>1?r+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(a=o.vakata.html.escape(a)),n&&n.id&&n.id!==o.jstree.root&&(t.which===1||t.type==="touchstart"||t.type==="dragstart")&&(this.settings.dnd.is_draggable===!0||o.vakata.is_function(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,r>1?this.get_top_selected(!0):[n],t)))if(A={jstree:!0,origin:this,obj:this.get_node(n,!0),nodes:r>1?this.get_top_selected():[n.id]},S=t.currentTarget,this.settings.dnd.use_html5)o.vakata.dnd._trigger("start",t,{helper:o(),element:S,data:A});else return this.element.trigger("mousedown.jstree"),o.vakata.dnd.start(t,A,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+a+'<ins class="jstree-copy">+</ins></div>')}.bind(this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),o.vakata.dnd._trigger("move",t,{helper:o(),element:S,data:A}),!1}).on("drop.jstree",function(t){return t.preventDefault(),o.vakata.dnd._trigger("stop",t,{helper:o(),element:S,data:A}),!1}.bind(this))},this.redraw_node=function(t,n,r,a){if(t=i.redraw_node.apply(this,arguments),t&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)t.setAttribute("draggable",!0);else{var l,g,D=null;for(l=0,g=t.childNodes.length;l<g;l++)if(t.childNodes[l]&&t.childNodes[l].className&&t.childNodes[l].className.indexOf("jstree-anchor")!==-1){D=t.childNodes[l];break}D&&D.setAttribute("draggable",!0)}return t}},o(function(){var e=!1,i=!1,t=!1,n=!1,r=o('<div id="jstree-marker">&#160;</div>').hide();o(w).on("dragover.vakata.jstree",function(a){S&&o.vakata.dnd._trigger("move",a,{helper:o(),element:S,data:A})}).on("drop.vakata.jstree",function(a){S&&(o.vakata.dnd._trigger("stop",a,{helper:o(),element:S,data:A}),S=null,A=null)}).on("dnd_start.vakata.jstree",function(a,l){e=!1,t=!1,!(!l||!l.data||!l.data.jstree)&&r.appendTo(w.body)}).on("dnd_move.vakata.jstree",function(a,l){var g=l.event.target!==t.target;if(n&&(!l.event||l.event.type!=="dragover"||g)&&clearTimeout(n),!(!l||!l.data||!l.data.jstree)&&!(l.event.target.id&&l.event.target.id==="jstree-marker")){t=l.event;var D=o.jstree.reference(l.event.target),C=!1,b=!1,N=!1,W,K,E,F,I,j,ie,ee,fe,ue,ge,q,V,G,ae,de,ne,_e;if(D&&D._data&&D._data.dnd){if(r.attr("class","jstree-"+D.get_theme()+(D.settings.core.themes.responsive?" jstree-dnd-responsive":"")),de=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey)),l.helper.children().attr("class","jstree-"+D.get_theme()+" jstree-"+D.get_theme()+"-"+D.get_theme_variant()+" "+(D.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[de?"show":"hide"](),(l.event.target===D.element[0]||l.event.target===D.get_container_ul()[0])&&(D.get_container_ul().children().length===0||D.settings.dnd.blank_space_drop)){for(ee=!0,fe=0,ue=l.data.nodes.length;fe<ue&&(ee=ee&&D.check(l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",l.data.origin&&l.data.origin!==D?l.data.origin.get_node(l.data.nodes[fe]):l.data.nodes[fe],o.jstree.root,"last",{dnd:!0,ref:D.get_node(o.jstree.root),pos:"i",origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==D,is_foreign:!l.data.origin}),!!ee);fe++);if(ee){e={ins:D,par:o.jstree.root,pos:"last"},r.hide(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=de?"copy":"move");return}}else if(C=D.settings.dnd.large_drop_target?o(l.event.target).closest(".jstree-node").children(".jstree-anchor"):o(l.event.target).closest(".jstree-anchor"),C&&C.length&&C.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(b=C.offset(),N=(l.event.pageY!==d?l.event.pageY:l.event.originalEvent.pageY)-b.top,F=C.outerHeight(),N<F/3?ie=["b","i","a"]:N>F-F/3?ie=["a","i","b"]:ie=N>F/2?["i","a","b"]:["i","b","a"],o.each(ie,function(Fe,Ae){switch(Ae){case"b":K=b.left-6,E=b.top,I=D.get_parent(C),j=C.parent().index(),_e="jstree-below";break;case"i":G=D.settings.dnd.inside_pos,ae=D.get_node(C.parent()),K=b.left-2,E=b.top+F/2+1,I=ae.id,j=G==="first"?0:G==="last"?ae.children.length:Math.min(G,ae.children.length),_e="jstree-inside";break;case"a":K=b.left-6,E=b.top+F,I=D.get_parent(C),j=C.parent().index()+1,_e="jstree-above";break}for(ee=!0,fe=0,ue=l.data.nodes.length;fe<ue;fe++)if(ge=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",q=j,ge==="move_node"&&Ae==="a"&&l.data.origin&&l.data.origin===D&&I===D.get_parent(l.data.nodes[fe])&&(V=D.get_node(I),q>o.inArray(l.data.nodes[fe],V.children)&&(q-=1)),ee=ee&&(D&&D.settings&&D.settings.dnd&&D.settings.dnd.check_while_dragging===!1||D.check(ge,l.data.origin&&l.data.origin!==D?l.data.origin.get_node(l.data.nodes[fe]):l.data.nodes[fe],I,q,{dnd:!0,ref:D.get_node(C.parent()),pos:Ae,origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==D,is_foreign:!l.data.origin})),!ee){D&&D.last_error&&(i=D.last_error());break}if(Ae==="i"&&C.parent().is(".jstree-closed")&&D.settings.dnd.open_timeout&&(!l.event||l.event.type!=="dragover"||g)&&(n&&clearTimeout(n),n=setTimeout(function(ve,Le){return function(){ve.open_node(Le)}}(D,C),D.settings.dnd.open_timeout)),ee)return ne=D.get_node(I,!0),ne.hasClass(".jstree-dnd-parent")||(o(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),ne.addClass("jstree-dnd-parent")),e={ins:D,par:I,pos:Ae==="i"&&G==="last"&&j===0&&!D.is_loaded(ae)?"last":j},r.css({left:K+"px",top:E+"px"}).show(),r.removeClass("jstree-above jstree-inside jstree-below").addClass(_e),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=de?"copy":"move"),i={},ie=!0,!1}),ie===!0))return}o(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),e=!1,l.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),l.event.originalEvent&&l.event.originalEvent.dataTransfer,r.hide()}}).on("dnd_scroll.vakata.jstree",function(a,l){!l||!l.data||!l.data.jstree||(r.hide(),e=!1,t=!1,l.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(a,l){if(o(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),n&&clearTimeout(n),!(!l||!l.data||!l.data.jstree)){r.hide().detach();var g,D,C=[];if(e){for(g=0,D=l.data.nodes.length;g<D;g++)C[g]=l.data.origin?l.data.origin.get_node(l.data.nodes[g]):l.data.nodes[g];e.ins[l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node"](C,e.par,e.pos,!1,!1,!1,l.data.origin)}else g=o(l.event.target).closest(".jstree"),g.length&&i&&i.error&&i.error==="check"&&(g=g.jstree(!0),g&&g.settings.core.error.call(this,i));t=!1,e=!1}}).on("keyup.jstree keydown.jstree",function(a,l){l=o.vakata.dnd._get(),l&&l.data&&l.data.jstree&&(a.type==="keyup"&&a.which===27?(n&&clearTimeout(n),e=!1,i=!1,t=!1,n=!1,r.hide().detach(),o.vakata.dnd._clean()):(l.helper.find(".jstree-copy").first()[l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(a.metaKey||a.ctrlKey))?"show":"hide"](),t&&(t.metaKey=a.metaKey,t.ctrlKey=a.ctrlKey,o.vakata.dnd._trigger("move",t))))})}),function(e){e.vakata.html={div:e("<div></div>"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var i={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(t,n,r){r===d&&(r=e.vakata.dnd._get()),r.event=n,e(w).triggerHandler("dnd_"+t+".vakata",r)},_get:function(){return{data:i.data,element:i.element,helper:i.helper}},_clean:function(){i.helper&&i.helper.remove(),i.scroll_i&&(clearInterval(i.scroll_i),i.scroll_i=!1),i={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},S=null,e(w).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(w).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(t){if(!i.scroll_e||!i.scroll_l&&!i.scroll_t)return i.scroll_i&&(clearInterval(i.scroll_i),i.scroll_i=!1),!1;if(!i.scroll_i)return i.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(t===!0)return!1;var n=i.scroll_e.scrollTop(),r=i.scroll_e.scrollLeft();i.scroll_e.scrollTop(n+i.scroll_t*e.vakata.dnd.settings.scroll_speed),i.scroll_e.scrollLeft(r+i.scroll_l*e.vakata.dnd.settings.scroll_speed),(n!==i.scroll_e.scrollTop()||r!==i.scroll_e.scrollLeft())&&e.vakata.dnd._trigger("scroll",i.scroll_e)},start:function(t,n,r){t.type==="touchstart"&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=w.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),i.is_drag&&e.vakata.dnd.stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.touchAction="none",t.currentTarget.style.msTouchAction="none",t.currentTarget.style.MozUserSelect="none")}catch{}return i.init_x=t.pageX,i.init_y=t.pageY,i.data=n,i.is_down=!0,i.element=t.currentTarget,i.target=t.target,i.is_touch=t.type==="touchstart",r!==!1&&(i.helper=e("<div id='vakata-dnd'></div>").html(r).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(w).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(w).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(t){if(t.type==="touchmove"&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=w.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),!!i.is_down){if(!i.is_drag)if(Math.abs(t.pageX-i.init_x)>(i.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(t.pageY-i.init_y)>(i.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold))i.helper&&(i.helper.appendTo(w.body),i.helper_w=i.helper.outerWidth()),i.is_drag=!0,e(i.target).one("click.vakata",!1),e.vakata.dnd._trigger("start",t);else return;var n=!1,r=!1,a=!1,l=!1,g=!1,D=!1,C=!1,b=!1,N=!1,W=!1;return i.scroll_t=0,i.scroll_l=0,i.scroll_e=!1,e(e(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return this.ownerDocument&&/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var K=e(this),E=K.offset();if(this.scrollHeight>this.offsetHeight&&(E.top+K.height()-t.pageY<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_t=1),t.pageY-E.top<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(E.left+K.width()-t.pageX<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_l=1),t.pageX-E.left<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_l=-1)),i.scroll_t||i.scroll_l)return i.scroll_e=e(this),!1}),i.scroll_e||(n=e(w),r=e(window),a=n.height(),l=r.height(),g=n.width(),D=r.width(),C=n.scrollTop(),b=n.scrollLeft(),a>l&&t.pageY-C<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_t=-1),a>l&&l-(t.pageY-C)<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_t=1),g>D&&t.pageX-b<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_l=-1),g>D&&D-(t.pageX-b)<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_l=1),(i.scroll_t||i.scroll_l)&&(i.scroll_e=n)),i.scroll_e&&e.vakata.dnd._scroll(!0),i.helper&&(N=parseInt(t.pageY+e.vakata.dnd.settings.helper_top,10),W=parseInt(t.pageX+e.vakata.dnd.settings.helper_left,10),a&&N+25>a&&(N=a-50),g&&W+i.helper_w>g&&(W=g-(i.helper_w+2)),i.helper.css({left:W+"px",top:N+"px"})),e.vakata.dnd._trigger("move",t),!1}},stop:function(t){if(t.type==="touchend"&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=w.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),i.is_drag)t.target!==i.target&&e(i.target).off("click.vakata"),e.vakata.dnd._trigger("stop",t);else if(t.type==="touchend"&&t.target===i.target){var n=setTimeout(function(){e(t.target).trigger("click")},100);e(t.target).one("click",function(){n&&clearTimeout(n)})}return e.vakata.dnd._clean(),!1}}}(o),o.jstree.defaults.massload=null,o.jstree.plugins.massload=function(e,i){this.init=function(t,n){this._data.massload={},i.init.call(this,t,n)},this._load_nodes=function(t,n,r,a){var l=this.settings.massload,g=[],D=this._model.data,C,b,N;if(!r){for(C=0,b=t.length;C<b;C++)(!D[t[C]]||!D[t[C]].state.loaded&&!D[t[C]].state.failed||a)&&(g.push(t[C]),N=this.get_node(t[C],!0),N&&N.length&&N.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},g.length){if(o.vakata.is_function(l))return l.call(this,g,function(W){var K,E;if(W)for(K in W)W.hasOwnProperty(K)&&(this._data.massload[K]=W[K]);for(K=0,E=t.length;K<E;K++)N=this.get_node(t[K],!0),N&&N.length&&N.removeClass("jstree-loading").attr("aria-busy",!1);i._load_nodes.call(this,t,n,r,a)}.bind(this));if(typeof l=="object"&&l&&l.url)return l=o.extend(!0,{},l),o.vakata.is_function(l.url)&&(l.url=l.url.call(this,g)),o.vakata.is_function(l.data)&&(l.data=l.data.call(this,g)),o.ajax(l).done(function(W,K,E){var F,I;if(W)for(F in W)W.hasOwnProperty(F)&&(this._data.massload[F]=W[F]);for(F=0,I=t.length;F<I;F++)N=this.get_node(t[F],!0),N&&N.length&&N.removeClass("jstree-loading").attr("aria-busy",!1);i._load_nodes.call(this,t,n,r,a)}.bind(this)).fail(function(W){i._load_nodes.call(this,t,n,r,a)}.bind(this))}}return i._load_nodes.call(this,t,n,r,a)},this._load_node=function(t,n){var r=this._data.massload[t.id],a=null,l;return r?(a=this[typeof r=="string"?"_append_html_data":"_append_json_data"](t,typeof r=="string"?o(o.parseHTML(r)).filter(function(){return this.nodeType!==3}):r,function(g){n.call(this,g)}),l=this.get_node(t.id,!0),l&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],a):i._load_node.call(this,t,n)}},o.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},o.jstree.plugins.search=function(e,i){this.bind=function(){i.bind.call(this),this._data.search.str="",this._data.search.dom=o(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",function(t,n){if(this._data.search.som&&n.res.length){var r=this._model.data,a,l,g=[],D,C;for(a=0,l=n.res.length;a<l;a++)if(r[n.res[a]]&&!r[n.res[a]].state.hidden&&(g.push(n.res[a]),g=g.concat(r[n.res[a]].parents),this._data.search.smc))for(D=0,C=r[n.res[a]].children_d.length;D<C;D++)r[r[n.res[a]].children_d[D]]&&!r[r[n.res[a]].children_d[D]].state.hidden&&g.push(r[n.res[a]].children_d[D]);g=o.vakata.array_remove_item(o.vakata.array_unique(g),o.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(g,!0),this.redraw(!0)}}.bind(this)).on("clear_search.jstree",function(t,n){this._data.search.som&&n.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))}.bind(this))},this.search=function(t,n,r,a,l,g){if(t===!1||o.vakata.trim(t.toString())==="")return this.clear_search();a=this.get_node(a),a=a&&a.id?a.id:null,t=t.toString();var D=this.settings.search,C=D.ajax?D.ajax:!1,b=this._model.data,N=null,W=[],K=[],E,F;if(this._data.search.res.length&&!l&&this.clear_search(),r===d&&(r=D.show_only_matches),g===d&&(g=D.show_only_matches_children),!n&&C!==!1)return o.vakata.is_function(C)?C.call(this,t,function(I){I&&I.d&&(I=I.d),this._load_nodes(o.vakata.is_array(I)?o.vakata.array_unique(I):[],function(){this.search(t,!0,r,a,l,g)})}.bind(this),a):(C=o.extend({},C),C.data||(C.data={}),C.data.str=t,a&&(C.data.inside=a),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=o.ajax(C).fail(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(C)},this.settings.core.error.call(this,this._data.core.last_error)}.bind(this)).done(function(I){I&&I.d&&(I=I.d),this._load_nodes(o.vakata.is_array(I)?o.vakata.array_unique(I):[],function(){this.search(t,!0,r,a,l,g)})}.bind(this)),this._data.search.lastRequest);if(l||(this._data.search.str=t,this._data.search.dom=o(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=r,this._data.search.smc=g),N=new o.vakata.search(t,!0,{caseSensitive:D.case_sensitive,fuzzy:D.fuzzy}),o.each(b[a||o.jstree.root].children_d,function(I,j){var ie=b[j];ie.text&&!ie.state.hidden&&(!D.search_leaves_only||ie.state.loaded&&ie.children.length===0)&&(D.search_callback&&D.search_callback.call(this,t,ie)||!D.search_callback&&N.search(ie.text).isMatch)&&(W.push(j),K=K.concat(ie.parents))}),W.length){for(K=o.vakata.array_unique(K),E=0,F=K.length;E<F;E++)K[E]!==o.jstree.root&&b[K[E]]&&this.open_node(K[E],null,0)===!0&&this._data.search.opn.push(K[E]);l?(this._data.search.dom=this._data.search.dom.add(o(this.element[0].querySelectorAll("#"+o.map(W,function(I){return"0123456789".indexOf(I[0])!==-1?"\\3"+I[0]+" "+I.substr(1).replace(o.jstree.idregex,"\\$&"):I.replace(o.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=o.vakata.array_unique(this._data.search.res.concat(W))):(this._data.search.dom=o(this.element[0].querySelectorAll("#"+o.map(W,function(I){return"0123456789".indexOf(I[0])!==-1?"\\3"+I[0]+" "+I.substr(1).replace(o.jstree.idregex,"\\$&"):I.replace(o.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=W),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:t,res:this._data.search.res,show_only_matches:r})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=o(this.element[0].querySelectorAll("#"+o.map(this._data.search.res,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(o.jstree.idregex,"\\$&"):t.replace(o.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=o()},this.redraw_node=function(t,n,r,a){if(t=i.redraw_node.apply(this,arguments),t&&o.inArray(t.id,this._data.search.res)!==-1){var l,g,D=null;for(l=0,g=t.childNodes.length;l<g;l++)if(t.childNodes[l]&&t.childNodes[l].className&&t.childNodes[l].className.indexOf("jstree-anchor")!==-1){D=t.childNodes[l];break}D&&(D.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(i,t,n){n=n||{},n=e.extend({},e.vakata.search.defaults,n),n.fuzzy!==!1&&(n.fuzzy=!0),i=n.caseSensitive?i:i.toLowerCase();var r=n.location,a=n.distance,l=n.threshold,g=i.length,D,C,b,N;return g>32&&(n.fuzzy=!1),n.fuzzy&&(D=1<<g-1,C=function(){var W={},K=0;for(K=0;K<g;K++)W[i.charAt(K)]=0;for(K=0;K<g;K++)W[i.charAt(K)]|=1<<g-K-1;return W}(),b=function(W,K){var E=W/g,F=Math.abs(r-K);return a?E+F/a:F?1:E}),N=function(W){if(W=n.caseSensitive?W.toString():W.toString().toLowerCase(),i===W||W.indexOf(i)!==-1)return{isMatch:!0,score:0};if(!n.fuzzy)return{isMatch:!1,score:1};var K,E,F=W.length,I=l,j=W.indexOf(i,r),ie,ee,fe=g+F,ue,ge,q,V,G,ae=1,de=[];for(j!==-1&&(I=Math.min(b(0,j),I),j=W.lastIndexOf(i,r+g),j!==-1&&(I=Math.min(b(0,j),I))),j=-1,K=0;K<g;K++){for(ie=0,ee=fe;ie<ee;)b(K,r+ee)<=I?ie=ee:fe=ee,ee=Math.floor((fe-ie)/2+ie);for(fe=ee,ge=Math.max(1,r-ee+1),q=Math.min(r+ee,F)+g,V=new Array(q+2),V[q+1]=(1<<K)-1,E=q;E>=ge;E--)if(G=C[W.charAt(E-1)],K===0?V[E]=(V[E+1]<<1|1)&G:V[E]=(V[E+1]<<1|1)&G|((ue[E+1]|ue[E])<<1|1)|ue[E+1],V[E]&D&&(ae=b(K,E-1),ae<=I))if(I=ae,j=E-1,de.push(j),j>r)ge=Math.max(1,2*r-j);else break;if(b(K+1,r)>I)break;ue=V}return{isMatch:j>=0,score:ae}},t===!0?{search:N}:N(t)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(o),o.jstree.defaults.sort=function(e,i){return this.get_text(e)>this.get_text(i)?1:-1},o.jstree.plugins.sort=function(e,i){this.bind=function(){i.bind.call(this),this.element.on("model.jstree",function(t,n){this.sort(n.parent,!0)}.bind(this)).on("rename_node.jstree create_node.jstree",function(t,n){this.sort(n.parent||n.node.parent,!1),this.redraw_node(n.parent||n.node.parent,!0)}.bind(this)).on("move_node.jstree copy_node.jstree",function(t,n){this.sort(n.parent,!1),this.redraw_node(n.parent,!0)}.bind(this))},this.sort=function(t,n){var r,a;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(this.settings.sort.bind(this)),n))for(r=0,a=t.children_d.length;r<a;r++)this.sort(t.children_d[r],!1)}};var c=!1;o.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},o.jstree.plugins.state=function(e,i){this.bind=function(){i.bind.call(this);var t=function(){this.element.on(this.settings.state.events,function(){c&&clearTimeout(c),c=setTimeout(function(){this.save_state()}.bind(this),100)}.bind(this)),this.trigger("state_ready")}.bind(this);this.element.on("ready.jstree",function(n,r){this.element.one("restore_state.jstree",t),this.restore_state()||t()}.bind(this))},this.save_state=function(){var t=this.get_state();this.settings.state.preserve_loaded||delete t.core.loaded;var n={state:t,ttl:this.settings.state.ttl,sec:+new Date};o.vakata.storage.set(this.settings.state.key,JSON.stringify(n))},this.restore_state=function(){var t=o.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch{return!1}return!!t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl?!1:(!!t&&t.state&&(t=t.state),!!t&&o.vakata.is_function(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),t?(this.settings.state.preserve_loaded||delete t.core.loaded,this.element.one("set_state.jstree",function(n,r){r.instance.trigger("restore_state",{state:o.extend(!0,{},t)})}),this.set_state(t),!0):!1)},this.clear_state=function(){return o.vakata.storage.del(this.settings.state.key)}},function(e,i){e.vakata.storage={set:function(t,n){return window.localStorage.setItem(t,n)},get:function(t){return window.localStorage.getItem(t)},del:function(t){return window.localStorage.removeItem(t)}}}(o),o.jstree.defaults.types={default:{}},o.jstree.defaults.types[o.jstree.root]={},o.jstree.plugins.types=function(e,i){this.init=function(t,n){var r,a;if(n&&n.types&&n.types.default){for(r in n.types)if(r!=="default"&&r!==o.jstree.root&&n.types.hasOwnProperty(r))for(a in n.types.default)n.types.default.hasOwnProperty(a)&&n.types[r][a]===d&&(n.types[r][a]=n.types.default[a])}i.init.call(this,t,n),this._model.data[o.jstree.root].type=o.jstree.root},this.refresh=function(t,n){i.refresh.call(this,t,n),this._model.data[o.jstree.root].type=o.jstree.root},this.bind=function(){this.element.on("model.jstree",function(t,n){var r=this._model.data,a=n.nodes,l=this.settings.types,g,D,C="default",b;for(g=0,D=a.length;g<D;g++){if(C="default",r[a[g]].original&&r[a[g]].original.type&&l[r[a[g]].original.type]&&(C=r[a[g]].original.type),r[a[g]].data&&r[a[g]].data.jstree&&r[a[g]].data.jstree.type&&l[r[a[g]].data.jstree.type]&&(C=r[a[g]].data.jstree.type),r[a[g]].type=C,r[a[g]].icon===!0&&l[C].icon!==d&&(r[a[g]].icon=l[C].icon),l[C].li_attr!==d&&typeof l[C].li_attr=="object"){for(b in l[C].li_attr)if(l[C].li_attr.hasOwnProperty(b)){if(b==="id")continue;r[a[g]].li_attr[b]===d?r[a[g]].li_attr[b]=l[C].li_attr[b]:b==="class"&&(r[a[g]].li_attr.class=l[C].li_attr.class+" "+r[a[g]].li_attr.class)}}if(l[C].a_attr!==d&&typeof l[C].a_attr=="object"){for(b in l[C].a_attr)if(l[C].a_attr.hasOwnProperty(b)){if(b==="id")continue;r[a[g]].a_attr[b]===d?r[a[g]].a_attr[b]=l[C].a_attr[b]:b==="href"&&r[a[g]].a_attr[b]==="#"?r[a[g]].a_attr.href=l[C].a_attr.href:b==="class"&&(r[a[g]].a_attr.class=l[C].a_attr.class+" "+r[a[g]].a_attr.class)}}}r[o.jstree.root].type=o.jstree.root}.bind(this)),i.bind.call(this)},this.get_json=function(t,n,r){var a,l,g=this._model.data,D=n?o.extend(!0,{},n,{no_id:!1}):{},C=i.get_json.call(this,t,D,r);if(C===!1)return!1;if(o.vakata.is_array(C))for(a=0,l=C.length;a<l;a++)C[a].type=C[a].id&&g[C[a].id]&&g[C[a].id].type?g[C[a].id].type:"default",n&&n.no_id&&(delete C[a].id,C[a].li_attr&&C[a].li_attr.id&&delete C[a].li_attr.id,C[a].a_attr&&C[a].a_attr.id&&delete C[a].a_attr.id);else C.type=C.id&&g[C.id]&&g[C.id].type?g[C.id].type:"default",n&&n.no_id&&(C=this._delete_ids(C));return C},this._delete_ids=function(t){if(o.vakata.is_array(t)){for(var n=0,r=t.length;n<r;n++)t[n]=this._delete_ids(t[n]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&o.vakata.is_array(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(t,n,r,a,l){if(i.check.call(this,t,n,r,a,l)===!1)return!1;n=n&&n.id?n:this.get_node(n),r=r&&r.id?r:this.get_node(r);var g=n&&n.id?l&&l.origin?l.origin:o.jstree.reference(n.id):null,D,C,b,N;switch(g=g&&g._model&&g._model.data?g._model.data:null,t){case"create_node":case"move_node":case"copy_node":if(t!=="move_node"||o.inArray(n.id,r.children)===-1){if(D=this.get_rules(r),D.max_children!==d&&D.max_children!==-1&&D.max_children===r.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+t,data:JSON.stringify({chk:t,pos:a,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})},!1;if(D.valid_children!==d&&D.valid_children!==-1&&o.inArray(n.type||"default",D.valid_children)===-1)return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+t,data:JSON.stringify({chk:t,pos:a,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})},!1;if(g&&n.children_d&&n.parents){for(C=0,b=0,N=n.children_d.length;b<N;b++)C=Math.max(C,g[n.children_d[b]].parents.length);C=C-n.parents.length+1}(C<=0||C===d)&&(C=1);do{if(D.max_depth!==d&&D.max_depth!==-1&&D.max_depth<C)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+t,data:JSON.stringify({chk:t,pos:a,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})},!1;r=this.get_node(r.parent),D=this.get_rules(r),C++}while(r)}break}return!0},this.get_rules=function(t){if(t=this.get_node(t),!t)return!1;var n=this.get_type(t,!0);return n.max_depth===d&&(n.max_depth=-1),n.max_children===d&&(n.max_children=-1),n.valid_children===d&&(n.valid_children=-1),n},this.get_type=function(t,n){return t=this.get_node(t),t?n?o.extend({type:t.type},this.settings.types[t.type]):t.type:!1},this.set_type=function(t,n){var r=this._model.data,a,l,g,D,C,b,N,W;if(o.vakata.is_array(t)){for(t=t.slice(),l=0,g=t.length;l<g;l++)this.set_type(t[l],n);return!0}if(a=this.settings.types,t=this.get_node(t),!a[n]||!t)return!1;if(N=this.get_node(t,!0),N&&N.length&&(W=N.children(".jstree-anchor")),D=t.type,C=this.get_icon(t),t.type=n,(C===!0||!a[D]||a[D].icon!==d&&C===a[D].icon)&&this.set_icon(t,a[n].icon!==d?a[n].icon:!0),a[D]&&a[D].li_attr!==d&&typeof a[D].li_attr=="object"){for(b in a[D].li_attr)if(a[D].li_attr.hasOwnProperty(b)){if(b==="id")continue;b==="class"?(r[t.id].li_attr.class=(r[t.id].li_attr.class||"").replace(a[D].li_attr[b],""),N&&N.removeClass(a[D].li_attr[b])):r[t.id].li_attr[b]===a[D].li_attr[b]&&(r[t.id].li_attr[b]=null,N&&N.removeAttr(b))}}if(a[D]&&a[D].a_attr!==d&&typeof a[D].a_attr=="object"){for(b in a[D].a_attr)if(a[D].a_attr.hasOwnProperty(b)){if(b==="id")continue;b==="class"?(r[t.id].a_attr.class=(r[t.id].a_attr.class||"").replace(a[D].a_attr[b],""),W&&W.removeClass(a[D].a_attr[b])):r[t.id].a_attr[b]===a[D].a_attr[b]&&(b==="href"?(r[t.id].a_attr[b]="#",W&&W.attr("href","#")):(delete r[t.id].a_attr[b],W&&W.removeAttr(b)))}}if(a[n].li_attr!==d&&typeof a[n].li_attr=="object"){for(b in a[n].li_attr)if(a[n].li_attr.hasOwnProperty(b)){if(b==="id")continue;r[t.id].li_attr[b]===d?(r[t.id].li_attr[b]=a[n].li_attr[b],N&&(b==="class"?N.addClass(a[n].li_attr[b]):N.attr(b,a[n].li_attr[b]))):b==="class"&&(r[t.id].li_attr.class=a[n].li_attr[b]+" "+r[t.id].li_attr.class,N&&N.addClass(a[n].li_attr[b]))}}if(a[n].a_attr!==d&&typeof a[n].a_attr=="object"){for(b in a[n].a_attr)if(a[n].a_attr.hasOwnProperty(b)){if(b==="id")continue;r[t.id].a_attr[b]===d?(r[t.id].a_attr[b]=a[n].a_attr[b],W&&(b==="class"?W.addClass(a[n].a_attr[b]):W.attr(b,a[n].a_attr[b]))):b==="href"&&r[t.id].a_attr[b]==="#"?(r[t.id].a_attr.href=a[n].a_attr.href,W&&W.attr("href",a[n].a_attr.href)):b==="class"&&(r[t.id].a_attr.class=a[n].a_attr.class+" "+r[t.id].a_attr.class,W&&W.addClass(a[n].a_attr[b]))}}return!0}},o.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(e,i){return e+" ("+i+")"}},o.jstree.plugins.unique=function(e,i){this.check=function(t,n,r,a,l){if(i.check.call(this,t,n,r,a,l)===!1)return!1;if(n=n&&n.id?n:this.get_node(n),r=r&&r.id?r:this.get_node(r),!r||!r.children)return!0;var g=t==="rename_node"?a:n.text,D=[],C=this.settings.unique.case_sensitive,b=this.settings.unique.trim_whitespace,N=this._model.data,W,K,E;for(W=0,K=r.children.length;W<K;W++)E=N[r.children[W]].text,C||(E=E.toLowerCase()),b&&(E=E.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),D.push(E);switch(C||(g=g.toLowerCase()),b&&(g=g.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),t){case"delete_node":return!0;case"rename_node":return E=n.text||"",C||(E=E.toLowerCase()),b&&(E=E.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),W=o.inArray(g,D)===-1||n.text&&E===g,W||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+g+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})}),W;case"create_node":return W=o.inArray(g,D)===-1,W||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+g+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})}),W;case"copy_node":return W=o.inArray(g,D)===-1,W||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+g+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})}),W;case"move_node":return W=n.parent===r.id&&(!l||!l.is_multi)||o.inArray(g,D)===-1,W||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+g+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:n&&n.id?n.id:!1,par:r&&r.id?r.id:!1})}),W}return!0},this.create_node=function(t,n,r,a,l){if(!n||typeof n=="object"&&n.text===d){if(t===null&&(t=o.jstree.root),t=this.get_node(t),!t)return i.create_node.call(this,t,n,r,a,l);if(r=r===d?"last":r,!r.toString().match(/^(before|after)$/)&&!l&&!this.is_loaded(t))return i.create_node.call(this,t,n,r,a,l);n||(n={});var g,D,C,b,N,W=this._model.data,K=this.settings.unique.case_sensitive,E=this.settings.unique.trim_whitespace,F=this.settings.unique.duplicate,I;for(D=g=this.get_string("New node"),C=[],b=0,N=t.children.length;b<N;b++)I=W[t.children[b]].text,K||(I=I.toLowerCase()),E&&(I=I.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),C.push(I);for(b=1,I=D,K||(I=I.toLowerCase()),E&&(I=I.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));o.inArray(I,C)!==-1;)D=F.call(this,g,++b).toString(),I=D,K||(I=I.toLowerCase()),E&&(I=I.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));n.text=D}return i.create_node.call(this,t,n,r,a,l)}};var p=w.createElement("DIV");if(p.setAttribute("unselectable","on"),p.setAttribute("role","presentation"),p.className="jstree-wholerow",p.innerHTML="&#160;",o.jstree.plugins.wholerow=function(e,i){this.bind=function(){i.bind.call(this),this.element.on("ready.jstree set_state.jstree",function(){this.hide_dots()}.bind(this)).on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-wholerow-ul")}.bind(this)).on("deselect_all.jstree",function(t,n){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")}.bind(this)).on("changed.jstree",function(t,n){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var r=!1,a,l;for(a=0,l=n.selected.length;a<l;a++)r=this.get_node(n.selected[a],!0),r&&r.length&&r.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}.bind(this)).on("open_node.jstree",function(t,n){this.get_node(n.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}.bind(this)).on("hover_node.jstree dehover_node.jstree",function(t,n){t.type==="hover_node"&&this.is_disabled(n.node)||this.get_node(n.node,!0).children(".jstree-wholerow")[t.type==="hover_node"?"addClass":"removeClass"]("jstree-wholerow-hovered")}.bind(this)).on("contextmenu.jstree",".jstree-wholerow",function(t){if(this._data.contextmenu){t.preventDefault();var n=o.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});o(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n)}}.bind(this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var n=o.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});o(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).trigger("focus")}).on("dblclick.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var n=o.Event("dblclick",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});o(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).trigger("focus")}).on("click.jstree",".jstree-leaf > .jstree-ocl",function(t){t.stopImmediatePropagation();var n=o.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});o(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).trigger("focus")}.bind(this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",function(t){return t.stopImmediatePropagation(),this.is_disabled(t.currentTarget)||this.hover_node(t.currentTarget),!1}.bind(this)).on("mouseleave.jstree",".jstree-node",function(t){this.dehover_node(t.currentTarget)}.bind(this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),i.teardown.call(this)},this.redraw_node=function(t,n,r,a){if(t=i.redraw_node.apply(this,arguments),t){var l=p.cloneNode(!0);o.inArray(t.id,this._data.core.selected)!==-1&&(l.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(l.className+=" jstree-wholerow-hovered"),t.insertBefore(l,t.childNodes[0])}return t}},window.customElements&&Object&&Object.create){var v=Object.create(HTMLElement.prototype);v.createdCallback=function(){var e={core:{},plugins:[]},i;for(i in o.jstree.plugins)o.jstree.plugins.hasOwnProperty(i)&&this.attributes[i]&&(e.plugins.push(i),this.getAttribute(i)&&JSON.parse(this.getAttribute(i))&&(e[i]=JSON.parse(this.getAttribute(i))));for(i in o.jstree.defaults.core)o.jstree.defaults.core.hasOwnProperty(i)&&this.attributes[i]&&(e.core[i]=JSON.parse(this.getAttribute(i))||this.getAttribute(i));o(this).jstree(e)};try{window.customElements.define("vakata-jstree",function(){},{prototype:v})}catch{}}}})});var Fa=rt((ss,en)=>{(function(o,d){if(typeof ss=="object"&&typeof en=="object")en.exports=d();else if(typeof define=="function"&&define.amd)define([],d);else{var k=d();for(var M in k)(typeof ss=="object"?ss:o)[M]=k[M]}})(self,function(){return(()=>{"use strict";var o={4567:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.AccessibilityManager=void 0;let y=_(9042),w=_(6114),R=_(9924),x=_(3656),P=_(844),A=_(5596),S=_(9631);class c extends P.Disposable{constructor(v,e){super(),this._terminal=v,this._renderService=e,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityTreeRoot=document.createElement("div"),this._accessibilityTreeRoot.classList.add("xterm-accessibility"),this._accessibilityTreeRoot.tabIndex=0,this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let i=0;i<this._terminal.rows;i++)this._rowElements[i]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[i]);if(this._topBoundaryFocusListener=i=>this._handleBoundaryFocus(i,0),this._bottomBoundaryFocusListener=i=>this._handleBoundaryFocus(i,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityTreeRoot.appendChild(this._rowContainer),this._renderRowsDebouncer=new R.TimeBasedDebouncer(this._renderRows.bind(this)),this._refreshRows(),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityTreeRoot.appendChild(this._liveRegion),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityTreeRoot),this.register(this._renderRowsDebouncer),this.register(this._terminal.onResize(i=>this._handleResize(i.rows))),this.register(this._terminal.onRender(i=>this._refreshRows(i.start,i.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(i=>this._handleChar(i))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(i=>this._handleTab(i))),this.register(this._terminal.onKey(i=>this._handleKey(i.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new A.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,x.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this.register((0,P.toDisposable)(()=>{(0,S.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0}))}_handleBoundaryFocus(v,e){let i=v.target,t=this._rowElements[e===0?1:this._rowElements.length-2];if(i.getAttribute("aria-posinset")===(e===0?"1":`${this._terminal.buffer.lines.length}`)||v.relatedTarget!==t)return;let n,r;if(e===0?(n=i,r=this._rowElements.pop(),this._rowContainer.removeChild(r)):(n=this._rowElements.shift(),r=i,this._rowContainer.removeChild(n)),n.removeEventListener("focus",this._topBoundaryFocusListener),r.removeEventListener("focus",this._bottomBoundaryFocusListener),e===0){let a=this._createAccessibilityTreeNode();this._rowElements.unshift(a),this._rowContainer.insertAdjacentElement("afterbegin",a)}else{let a=this._createAccessibilityTreeNode();this._rowElements.push(a),this._rowContainer.appendChild(a)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(e===0?-1:1),this._rowElements[e===0?1:this._rowElements.length-2].focus(),v.preventDefault(),v.stopImmediatePropagation()}_handleResize(v){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let e=this._rowContainer.children.length;e<this._terminal.rows;e++)this._rowElements[e]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[e]);for(;this._rowElements.length>v;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let v=document.createElement("div");return v.setAttribute("role","listitem"),v.tabIndex=-1,this._refreshRowDimensions(v),v}_handleTab(v){for(let e=0;e<v;e++)this._handleChar(" ")}_handleChar(v){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==v&&(this._charsToAnnounce+=v):this._charsToAnnounce+=v,v===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=y.tooMuchOutput)),w.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityTreeRoot.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,w.isMac&&(0,S.removeElementFromParent)(this._liveRegion)}_handleKey(v){this._clearLiveRegion(),/\p{Control}/u.test(v)||this._charsToConsume.push(v)}_refreshRows(v,e){this._renderRowsDebouncer.refresh(v,e,this._terminal.rows)}_renderRows(v,e){let i=this._terminal.buffer,t=i.lines.length.toString();for(let n=v;n<=e;n++){let r=i.translateBufferLineToString(i.ydisp+n,!0),a=(i.ydisp+n+1).toString(),l=this._rowElements[n];l&&(r.length===0?l.innerText="\xA0":l.textContent=r,l.setAttribute("aria-posinset",a),l.setAttribute("aria-setsize",t))}this._announceCharacters()}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityTreeRoot.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let v=0;v<this._terminal.rows;v++)this._refreshRowDimensions(this._rowElements[v])}}_refreshRowDimensions(v){v.style.height=`${this._renderService.dimensions.css.cell.height}px`}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}}u.AccessibilityManager=c},3614:(B,u)=>{function _(x){return x.replace(/\r?\n/g,"\r")}function y(x,P){return P?"\x1B[200~"+x+"\x1B[201~":x}function w(x,P,A){x=y(x=_(x),A.decPrivateModes.bracketedPasteMode),A.triggerDataEvent(x,!0),P.value=""}function R(x,P,A){let S=A.getBoundingClientRect(),c=x.clientX-S.left-10,p=x.clientY-S.top-10;P.style.width="20px",P.style.height="20px",P.style.left=`${c}px`,P.style.top=`${p}px`,P.style.zIndex="1000",P.focus()}Object.defineProperty(u,"__esModule",{value:!0}),u.rightClickHandler=u.moveTextAreaUnderMouseCursor=u.paste=u.handlePasteEvent=u.copyHandler=u.bracketTextForPaste=u.prepareTextForTerminal=void 0,u.prepareTextForTerminal=_,u.bracketTextForPaste=y,u.copyHandler=function(x,P){x.clipboardData&&x.clipboardData.setData("text/plain",P.selectionText),x.preventDefault()},u.handlePasteEvent=function(x,P,A){x.stopPropagation(),x.clipboardData&&w(x.clipboardData.getData("text/plain"),P,A)},u.paste=w,u.moveTextAreaUnderMouseCursor=R,u.rightClickHandler=function(x,P,A,S,c){R(x,P,A),c&&S.rightClickSelect(x),P.value=S.selectionText,P.select()}},7239:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.ColorContrastCache=void 0;let y=_(1505);u.ColorContrastCache=class{constructor(){this._color=new y.TwoKeyMap,this._css=new y.TwoKeyMap}setCss(w,R,x){this._css.set(w,R,x)}getCss(w,R){return this._css.get(w,R)}setColor(w,R,x){this._color.set(w,R,x)}getColor(w,R){return this._color.get(w,R)}clear(){this._color.clear(),this._css.clear()}}},9631:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.removeElementFromParent=void 0,u.removeElementFromParent=function(..._){var y;for(let w of _)(y=w==null?void 0:w.parentElement)===null||y===void 0||y.removeChild(w)}},3656:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.addDisposableDomListener=void 0,u.addDisposableDomListener=function(_,y,w,R){_.addEventListener(y,w,R);let x=!1;return{dispose:()=>{x||(x=!0,_.removeEventListener(y,w,R))}}}},6465:function(B,u,_){var y=this&&this.__decorate||function(c,p,v,e){var i,t=arguments.length,n=t<3?p:e===null?e=Object.getOwnPropertyDescriptor(p,v):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(c,p,v,e);else for(var r=c.length-1;r>=0;r--)(i=c[r])&&(n=(t<3?i(n):t>3?i(p,v,n):i(p,v))||n);return t>3&&n&&Object.defineProperty(p,v,n),n},w=this&&this.__param||function(c,p){return function(v,e){p(v,e,c)}};Object.defineProperty(u,"__esModule",{value:!0}),u.Linkifier2=void 0;let R=_(2585),x=_(8460),P=_(844),A=_(3656),S=class extends P.Disposable{constructor(c){super(),this._bufferService=c,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._activeLine=-1,this._onShowLinkUnderline=this.register(new x.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new x.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,P.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,P.toDisposable)(()=>{this._lastMouseEvent=void 0}))}get currentLink(){return this._currentLink}registerLinkProvider(c){return this._linkProviders.push(c),{dispose:()=>{let p=this._linkProviders.indexOf(c);p!==-1&&this._linkProviders.splice(p,1)}}}attachToDom(c,p,v){this._element=c,this._mouseService=p,this._renderService=v,this.register((0,A.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,A.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,A.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,A.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(c){if(this._lastMouseEvent=c,!this._element||!this._mouseService)return;let p=this._positionFromMouseEvent(c,this._element,this._mouseService);if(!p)return;this._isMouseOut=!1;let v=c.composedPath();for(let e=0;e<v.length;e++){let i=v[e];if(i.classList.contains("xterm"))break;if(i.classList.contains("xterm-hover"))return}this._lastBufferCell&&p.x===this._lastBufferCell.x&&p.y===this._lastBufferCell.y||(this._handleHover(p),this._lastBufferCell=p)}_handleHover(c){if(this._activeLine!==c.y)return this._clearCurrentLink(),void this._askForLink(c,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,c)||(this._clearCurrentLink(),this._askForLink(c,!0))}_askForLink(c,p){var v,e;this._activeProviderReplies&&p||((v=this._activeProviderReplies)===null||v===void 0||v.forEach(t=>{t==null||t.forEach(n=>{n.link.dispose&&n.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=c.y);let i=!1;for(let[t,n]of this._linkProviders.entries())p?!((e=this._activeProviderReplies)===null||e===void 0)&&e.get(t)&&(i=this._checkLinkProviderResult(t,c,i)):n.provideLinks(c.y,r=>{var a,l;if(this._isMouseOut)return;let g=r==null?void 0:r.map(D=>({link:D}));(a=this._activeProviderReplies)===null||a===void 0||a.set(t,g),i=this._checkLinkProviderResult(t,c,i),((l=this._activeProviderReplies)===null||l===void 0?void 0:l.size)===this._linkProviders.length&&this._removeIntersectingLinks(c.y,this._activeProviderReplies)})}_removeIntersectingLinks(c,p){let v=new Set;for(let e=0;e<p.size;e++){let i=p.get(e);if(i)for(let t=0;t<i.length;t++){let n=i[t],r=n.link.range.start.y<c?0:n.link.range.start.x,a=n.link.range.end.y>c?this._bufferService.cols:n.link.range.end.x;for(let l=r;l<=a;l++){if(v.has(l)){i.splice(t--,1);break}v.add(l)}}}}_checkLinkProviderResult(c,p,v){var e;if(!this._activeProviderReplies)return v;let i=this._activeProviderReplies.get(c),t=!1;for(let n=0;n<c;n++)this._activeProviderReplies.has(n)&&!this._activeProviderReplies.get(n)||(t=!0);if(!t&&i){let n=i.find(r=>this._linkAtPosition(r.link,p));n&&(v=!0,this._handleNewLink(n))}if(this._activeProviderReplies.size===this._linkProviders.length&&!v)for(let n=0;n<this._activeProviderReplies.size;n++){let r=(e=this._activeProviderReplies.get(n))===null||e===void 0?void 0:e.find(a=>this._linkAtPosition(a.link,p));if(r){v=!0,this._handleNewLink(r);break}}return v}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(c){if(!this._element||!this._mouseService||!this._currentLink)return;let p=this._positionFromMouseEvent(c,this._element,this._mouseService);p&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,p)&&this._currentLink.link.activate(c,this._currentLink.link.text)}_clearCurrentLink(c,p){this._element&&this._currentLink&&this._lastMouseEvent&&(!c||!p||this._currentLink.link.range.start.y>=c&&this._currentLink.link.range.end.y<=p)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,P.disposeArray)(this._linkCacheDisposables))}_handleNewLink(c){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;let p=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);p&&this._linkAtPosition(c.link,p)&&(this._currentLink=c,this._currentLink.state={decorations:{underline:c.link.decorations===void 0||c.link.decorations.underline,pointerCursor:c.link.decorations===void 0||c.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,c.link,this._lastMouseEvent),c.link.decorations={},Object.defineProperties(c.link.decorations,{pointerCursor:{get:()=>{var v,e;return(e=(v=this._currentLink)===null||v===void 0?void 0:v.state)===null||e===void 0?void 0:e.decorations.pointerCursor},set:v=>{var e,i;((e=this._currentLink)===null||e===void 0?void 0:e.state)&&this._currentLink.state.decorations.pointerCursor!==v&&(this._currentLink.state.decorations.pointerCursor=v,this._currentLink.state.isHovered&&((i=this._element)===null||i===void 0||i.classList.toggle("xterm-cursor-pointer",v)))}},underline:{get:()=>{var v,e;return(e=(v=this._currentLink)===null||v===void 0?void 0:v.state)===null||e===void 0?void 0:e.decorations.underline},set:v=>{var e,i,t;((e=this._currentLink)===null||e===void 0?void 0:e.state)&&((t=(i=this._currentLink)===null||i===void 0?void 0:i.state)===null||t===void 0?void 0:t.decorations.underline)!==v&&(this._currentLink.state.decorations.underline=v,this._currentLink.state.isHovered&&this._fireUnderlineEvent(c.link,v))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(v=>{let e=v.start===0?0:v.start+1+this._bufferService.buffer.ydisp,i=this._currentLink?this._lastMouseEvent:void 0;if(this._clearCurrentLink(e,v.end+1+this._bufferService.buffer.ydisp),i&&this._element){let t=this._positionFromMouseEvent(i,this._element,this._mouseService);t&&this._askForLink(t,!1)}})))}_linkHover(c,p,v){var e;!((e=this._currentLink)===null||e===void 0)&&e.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(p,!0),this._currentLink.state.decorations.pointerCursor&&c.classList.add("xterm-cursor-pointer")),p.hover&&p.hover(v,p.text)}_fireUnderlineEvent(c,p){let v=c.range,e=this._bufferService.buffer.ydisp,i=this._createLinkUnderlineEvent(v.start.x-1,v.start.y-e-1,v.end.x,v.end.y-e-1,void 0);(p?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(i)}_linkLeave(c,p,v){var e;!((e=this._currentLink)===null||e===void 0)&&e.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(p,!1),this._currentLink.state.decorations.pointerCursor&&c.classList.remove("xterm-cursor-pointer")),p.leave&&p.leave(v,p.text)}_linkAtPosition(c,p){let v=c.range.start.y*this._bufferService.cols+c.range.start.x,e=c.range.end.y*this._bufferService.cols+c.range.end.x,i=p.y*this._bufferService.cols+p.x;return v<=i&&i<=e}_positionFromMouseEvent(c,p,v){let e=v.getCoords(c,p,this._bufferService.cols,this._bufferService.rows);if(e)return{x:e[0],y:e[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(c,p,v,e,i){return{x1:c,y1:p,x2:v,y2:e,cols:this._bufferService.cols,fg:i}}};S=y([w(0,R.IBufferService)],S),u.Linkifier2=S},9042:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.tooMuchOutput=u.promptLabel=void 0,u.promptLabel="Terminal input",u.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(B,u,_){var y=this&&this.__decorate||function(S,c,p,v){var e,i=arguments.length,t=i<3?c:v===null?v=Object.getOwnPropertyDescriptor(c,p):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")t=Reflect.decorate(S,c,p,v);else for(var n=S.length-1;n>=0;n--)(e=S[n])&&(t=(i<3?e(t):i>3?e(c,p,t):e(c,p))||t);return i>3&&t&&Object.defineProperty(c,p,t),t},w=this&&this.__param||function(S,c){return function(p,v){c(p,v,S)}};Object.defineProperty(u,"__esModule",{value:!0}),u.OscLinkProvider=void 0;let R=_(511),x=_(2585),P=class{constructor(S,c,p){this._bufferService=S,this._optionsService=c,this._oscLinkService=p}provideLinks(S,c){var p;let v=this._bufferService.buffer.lines.get(S-1);if(!v)return void c(void 0);let e=[],i=this._optionsService.rawOptions.linkHandler,t=new R.CellData,n=v.getTrimmedLength(),r=-1,a=-1,l=!1;for(let g=0;g<n;g++)if(a!==-1||v.hasContent(g)){if(v.loadCell(g,t),t.hasExtendedAttrs()&&t.extended.urlId){if(a===-1){a=g,r=t.extended.urlId;continue}l=t.extended.urlId!==r}else a!==-1&&(l=!0);if(l||a!==-1&&g===n-1){let D=(p=this._oscLinkService.getLinkData(r))===null||p===void 0?void 0:p.uri;if(D){let C={start:{x:a+1,y:S},end:{x:g+(l||g!==n-1?0:1),y:S}},b=!1;if(!(i!=null&&i.allowNonHttpProtocols))try{let N=new URL(D);["http:","https:"].includes(N.protocol)||(b=!0)}catch{b=!0}b||e.push({text:D,range:C,activate:(N,W)=>i?i.activate(N,W,C):A(0,W),hover:(N,W)=>{var K;return(K=i==null?void 0:i.hover)===null||K===void 0?void 0:K.call(i,N,W,C)},leave:(N,W)=>{var K;return(K=i==null?void 0:i.leave)===null||K===void 0?void 0:K.call(i,N,W,C)}})}l=!1,t.hasExtendedAttrs()&&t.extended.urlId?(a=g,r=t.extended.urlId):(a=-1,r=-1)}}c(e)}};function A(S,c){if(confirm(`Do you want to navigate to ${c}?

WARNING: This link could potentially be dangerous`)){let p=window.open();if(p){try{p.opener=null}catch{}p.location.href=c}else console.warn("Opening link blocked as opener could not be cleared")}}P=y([w(0,x.IBufferService),w(1,x.IOptionsService),w(2,x.IOscLinkService)],P),u.OscLinkProvider=P},6193:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.RenderDebouncer=void 0,u.RenderDebouncer=class{constructor(_,y){this._parentWindow=_,this._renderCallback=y,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(_){return this._refreshCallbacks.push(_),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(_,y,w){this._rowCount=w,_=_!==void 0?_:0,y=y!==void 0?y:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,_):_,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,y):y,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();let _=Math.max(this._rowStart,0),y=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(_,y),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let _ of this._refreshCallbacks)_(0);this._refreshCallbacks=[]}}},5596:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.ScreenDprMonitor=void 0;let y=_(844);class w extends y.Disposable{constructor(x){super(),this._parentWindow=x,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,y.toDisposable)(()=>{this.clearListener()}))}setListener(x){this._listener&&this.clearListener(),this._listener=x,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var x;this._outerListener&&((x=this._resolutionMediaMatchList)===null||x===void 0||x.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}u.ScreenDprMonitor=w},3236:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.Terminal=void 0;let y=_(2950),w=_(1680),R=_(3614),x=_(2584),P=_(5435),A=_(9312),S=_(6114),c=_(3656),p=_(9042),v=_(4567),e=_(1296),i=_(7399),t=_(8460),n=_(8437),r=_(3230),a=_(4725),l=_(428),g=_(8934),D=_(6465),C=_(5114),b=_(8969),N=_(8055),W=_(4269),K=_(5941),E=_(3107),F=_(5744),I=_(9074),j=_(2585),ie=_(3730),ee=_(844),fe=_(6731),ue=typeof window<"u"?window.document:null;class ge extends b.CoreTerminal{constructor(V={}){super(V),this.browser=S,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new t.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new t.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new t.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new t.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new t.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new t.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new t.EventEmitter),this._onBlur=this.register(new t.EventEmitter),this._onA11yCharEmitter=this.register(new t.EventEmitter),this._onA11yTabEmitter=this.register(new t.EventEmitter),this._onWillOpen=this.register(new t.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(D.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(ie.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(I.DecorationService),this._instantiationService.setService(j.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((G,ae)=>this.refresh(G,ae))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(G=>this._reportWindowsOptions(G))),this.register(this._inputHandler.onColor(G=>this._handleColorEvent(G))),this.register((0,t.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,t.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,t.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,t.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(G=>this._afterResize(G.cols,G.rows))),this.register((0,ee.toDisposable)(()=>{var G,ae;this._customKeyEventHandler=void 0,(ae=(G=this.element)===null||G===void 0?void 0:G.parentNode)===null||ae===void 0||ae.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(V){if(this._themeService)for(let G of V){let ae,de="";switch(G.index){case 256:ae="foreground",de="10";break;case 257:ae="background",de="11";break;case 258:ae="cursor",de="12";break;default:ae="ansi",de="4;"+G.index}switch(G.type){case 0:let ne=N.color.toColorRGB(ae==="ansi"?this._themeService.colors.ansi[G.index]:this._themeService.colors[ae]);this.coreService.triggerDataEvent(`${x.C0.ESC}]${de};${(0,K.toRgbString)(ne)}${x.C1_ESCAPED.ST}`);break;case 1:if(ae==="ansi")this._themeService.modifyColors(_e=>_e.ansi[G.index]=N.rgba.toColor(...G.color));else{let _e=ae;this._themeService.modifyColors(Fe=>Fe[_e]=N.rgba.toColor(...G.color))}break;case 2:this._themeService.restoreColor(G.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(V){var G;V?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new v.AccessibilityManager(this,this._renderService)):((G=this._accessibilityManager)===null||G===void 0||G.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(V){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(x.C0.ESC+"[I"),this.updateCursorStyle(V),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var V;return(V=this.textarea)===null||V===void 0?void 0:V.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(x.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let V=this.buffer.ybase+this.buffer.y,G=this.buffer.lines.get(V);if(!G)return;let ae=Math.min(this.buffer.x,this.cols-1),de=this._renderService.dimensions.css.cell.height,ne=G.getWidth(ae),_e=this._renderService.dimensions.css.cell.width*ne,Fe=this.buffer.y*this._renderService.dimensions.css.cell.height,Ae=ae*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Ae+"px",this.textarea.style.top=Fe+"px",this.textarea.style.width=_e+"px",this.textarea.style.height=de+"px",this.textarea.style.lineHeight=de+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,c.addDisposableDomListener)(this.element,"copy",G=>{this.hasSelection()&&(0,R.copyHandler)(G,this._selectionService)}));let V=G=>(0,R.handlePasteEvent)(G,this.textarea,this.coreService);this.register((0,c.addDisposableDomListener)(this.textarea,"paste",V)),this.register((0,c.addDisposableDomListener)(this.element,"paste",V)),S.isFirefox?this.register((0,c.addDisposableDomListener)(this.element,"mousedown",G=>{G.button===2&&(0,R.rightClickHandler)(G,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,c.addDisposableDomListener)(this.element,"contextmenu",G=>{(0,R.rightClickHandler)(G,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),S.isLinux&&this.register((0,c.addDisposableDomListener)(this.element,"auxclick",G=>{G.button===1&&(0,R.moveTextAreaUnderMouseCursor)(G,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,c.addDisposableDomListener)(this.textarea,"keyup",V=>this._keyUp(V),!0)),this.register((0,c.addDisposableDomListener)(this.textarea,"keydown",V=>this._keyDown(V),!0)),this.register((0,c.addDisposableDomListener)(this.textarea,"keypress",V=>this._keyPress(V),!0)),this.register((0,c.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,c.addDisposableDomListener)(this.textarea,"compositionupdate",V=>this._compositionHelper.compositionupdate(V))),this.register((0,c.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,c.addDisposableDomListener)(this.textarea,"input",V=>this._inputEvent(V),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(V){var G;if(!V)throw new Error("Terminal requires a parent element.");V.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=V.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),V.appendChild(this.element);let ae=ue.createDocumentFragment();this._viewportElement=ue.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),ae.appendChild(this._viewportElement),this._viewportScrollArea=ue.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=ue.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=ue.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),ae.appendChild(this.screenElement),this.textarea=ue.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",p.promptLabel),S.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(C.CoreBrowserService,this.textarea,(G=this._document.defaultView)!==null&&G!==void 0?G:window),this._instantiationService.setService(a.ICoreBrowserService,this._coreBrowserService),this.register((0,c.addDisposableDomListener)(this.textarea,"focus",de=>this._handleTextAreaFocus(de))),this.register((0,c.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(l.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(a.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(fe.ThemeService),this._instantiationService.setService(a.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(W.CharacterJoinerService),this._instantiationService.setService(a.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(r.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(a.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(de=>this._onRender.fire(de))),this.onResize(de=>this._renderService.resize(de.cols,de.rows)),this._compositionView=ue.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(y.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(ae);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(g.MouseService),this._instantiationService.setService(a.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(w.Viewport,de=>this.scrollLines(de,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(A.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(a.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(de=>this.scrollLines(de.amount,de.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(de=>this._renderService.handleSelectionChanged(de.start,de.end,de.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(de=>{this.textarea.value=de,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(de=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,c.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(E.BufferDecorationRenderer,this.screenElement)),this.register((0,c.addDisposableDomListener)(this.element,"mousedown",de=>this._selectionService.handleMouseDown(de))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new v.AccessibilityManager(this,this._renderService)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",de=>this._handleScreenReaderModeOptionChange(de))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(F.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",de=>{!this._overviewRulerRenderer&&de&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(F.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(e.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){let V=this,G=this.element;function ae(_e){let Fe=V._mouseService.getMouseReportCoords(_e,V.screenElement);if(!Fe)return!1;let Ae,ve;switch(_e.overrideType||_e.type){case"mousemove":ve=32,_e.buttons===void 0?(Ae=3,_e.button!==void 0&&(Ae=_e.button<3?_e.button:3)):Ae=1&_e.buttons?0:4&_e.buttons?1:2&_e.buttons?2:3;break;case"mouseup":ve=0,Ae=_e.button<3?_e.button:3;break;case"mousedown":ve=1,Ae=_e.button<3?_e.button:3;break;case"wheel":if(V.viewport.getLinesScrolled(_e)===0)return!1;ve=_e.deltaY<0?0:1,Ae=4;break;default:return!1}return!(ve===void 0||Ae===void 0||Ae>4)&&V.coreMouseService.triggerMouseEvent({col:Fe.col,row:Fe.row,x:Fe.x,y:Fe.y,button:Ae,action:ve,ctrl:_e.ctrlKey,alt:_e.altKey,shift:_e.shiftKey})}let de={mouseup:null,wheel:null,mousedrag:null,mousemove:null},ne={mouseup:_e=>(ae(_e),_e.buttons||(this._document.removeEventListener("mouseup",de.mouseup),de.mousedrag&&this._document.removeEventListener("mousemove",de.mousedrag)),this.cancel(_e)),wheel:_e=>(ae(_e),this.cancel(_e,!0)),mousedrag:_e=>{_e.buttons&&ae(_e)},mousemove:_e=>{_e.buttons||ae(_e)}};this.register(this.coreMouseService.onProtocolChange(_e=>{_e?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(_e)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&_e?de.mousemove||(G.addEventListener("mousemove",ne.mousemove),de.mousemove=ne.mousemove):(G.removeEventListener("mousemove",de.mousemove),de.mousemove=null),16&_e?de.wheel||(G.addEventListener("wheel",ne.wheel,{passive:!1}),de.wheel=ne.wheel):(G.removeEventListener("wheel",de.wheel),de.wheel=null),2&_e?de.mouseup||(de.mouseup=ne.mouseup):(this._document.removeEventListener("mouseup",de.mouseup),de.mouseup=null),4&_e?de.mousedrag||(de.mousedrag=ne.mousedrag):(this._document.removeEventListener("mousemove",de.mousedrag),de.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,c.addDisposableDomListener)(G,"mousedown",_e=>{if(_e.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(_e))return ae(_e),de.mouseup&&this._document.addEventListener("mouseup",de.mouseup),de.mousedrag&&this._document.addEventListener("mousemove",de.mousedrag),this.cancel(_e)})),this.register((0,c.addDisposableDomListener)(G,"wheel",_e=>{if(!de.wheel){if(!this.buffer.hasScrollback){let Fe=this.viewport.getLinesScrolled(_e);if(Fe===0)return;let Ae=x.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(_e.deltaY<0?"A":"B"),ve="";for(let Le=0;Le<Math.abs(Fe);Le++)ve+=Ae;return this.coreService.triggerDataEvent(ve,!0),this.cancel(_e,!0)}return this.viewport.handleWheel(_e)?this.cancel(_e):void 0}},{passive:!1})),this.register((0,c.addDisposableDomListener)(G,"touchstart",_e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(_e),this.cancel(_e)},{passive:!0})),this.register((0,c.addDisposableDomListener)(G,"touchmove",_e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(_e)?void 0:this.cancel(_e)},{passive:!1}))}refresh(V,G){var ae;(ae=this._renderService)===null||ae===void 0||ae.refreshRows(V,G)}updateCursorStyle(V){var G;!((G=this._selectionService)===null||G===void 0)&&G.shouldColumnSelect(V)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(V,G,ae=0){super.scrollLines(V,G,ae),this.refresh(0,this.rows-1)}paste(V){(0,R.paste)(V,this.textarea,this.coreService)}attachCustomKeyEventHandler(V){this._customKeyEventHandler=V}registerLinkProvider(V){return this.linkifier2.registerLinkProvider(V)}registerCharacterJoiner(V){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let G=this._characterJoinerService.register(V);return this.refresh(0,this.rows-1),G}deregisterCharacterJoiner(V){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(V)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(V){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+V)}registerDecoration(V){return this._decorationService.registerDecoration(V)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(V,G,ae){this._selectionService.setSelection(V,G,ae)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var V;(V=this._selectionService)===null||V===void 0||V.clearSelection()}selectAll(){var V;(V=this._selectionService)===null||V===void 0||V.selectAll()}selectLines(V,G){var ae;(ae=this._selectionService)===null||ae===void 0||ae.selectLines(V,G)}_keyDown(V){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(V)===!1)return!1;let G=this.browser.isMac&&this.options.macOptionIsMeta&&V.altKey;if(!G&&!this._compositionHelper.keydown(V))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;G||V.key!=="Dead"&&V.key!=="AltGraph"||(this._unprocessedDeadKey=!0);let ae=(0,i.evaluateKeyboardEvent)(V,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(V),ae.type===3||ae.type===2){let de=this.rows-1;return this.scrollLines(ae.type===2?-de:de),this.cancel(V,!0)}return ae.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,V)||(ae.cancel&&this.cancel(V,!0),!ae.key||!!(V.key&&!V.ctrlKey&&!V.altKey&&!V.metaKey&&V.key.length===1&&V.key.charCodeAt(0)>=65&&V.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(ae.key!==x.C0.ETX&&ae.key!==x.C0.CR||(this.textarea.value=""),this._onKey.fire({key:ae.key,domEvent:V}),this._showCursor(),this.coreService.triggerDataEvent(ae.key,!0),!this.optionsService.rawOptions.screenReaderMode||V.altKey||V.ctrlKey?this.cancel(V,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(V,G){let ae=V.isMac&&!this.options.macOptionIsMeta&&G.altKey&&!G.ctrlKey&&!G.metaKey||V.isWindows&&G.altKey&&G.ctrlKey&&!G.metaKey||V.isWindows&&G.getModifierState("AltGraph");return G.type==="keypress"?ae:ae&&(!G.keyCode||G.keyCode>47)}_keyUp(V){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(V)===!1||(function(G){return G.keyCode===16||G.keyCode===17||G.keyCode===18}(V)||this.focus(),this.updateCursorStyle(V),this._keyPressHandled=!1)}_keyPress(V){let G;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(V)===!1)return!1;if(this.cancel(V),V.charCode)G=V.charCode;else if(V.which===null||V.which===void 0)G=V.keyCode;else{if(V.which===0||V.charCode===0)return!1;G=V.which}return!(!G||(V.altKey||V.ctrlKey||V.metaKey)&&!this._isThirdLevelShift(this.browser,V)||(G=String.fromCharCode(G),this._onKey.fire({key:G,domEvent:V}),this._showCursor(),this.coreService.triggerDataEvent(G,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(V){if(V.data&&V.inputType==="insertText"&&(!V.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let G=V.data;return this.coreService.triggerDataEvent(G,!0),this.cancel(V),!0}return!1}resize(V,G){V!==this.cols||G!==this.rows?super.resize(V,G):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(V,G){var ae,de;(ae=this._charSizeService)===null||ae===void 0||ae.measure(),(de=this.viewport)===null||de===void 0||de.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let V=1;V<this.rows;V++)this.buffer.lines.push(this.buffer.getBlankLine(n.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var V,G;this.options.rows=this.rows,this.options.cols=this.cols;let ae=this._customKeyEventHandler;this._setup(),super.reset(),(V=this._selectionService)===null||V===void 0||V.reset(),this._decorationService.reset(),this._customKeyEventHandler=ae,this.refresh(0,this.rows-1),(G=this.viewport)===null||G===void 0||G.syncScrollArea()}clearTextureAtlas(){var V;(V=this._renderService)===null||V===void 0||V.clearTextureAtlas()}_reportFocus(){var V;!((V=this.element)===null||V===void 0)&&V.classList.contains("focus")?this.coreService.triggerDataEvent(x.C0.ESC+"[I"):this.coreService.triggerDataEvent(x.C0.ESC+"[O")}_reportWindowsOptions(V){if(this._renderService)switch(V){case P.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:let G=this._renderService.dimensions.css.canvas.width.toFixed(0),ae=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${x.C0.ESC}[4;${ae};${G}t`);break;case P.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:let de=this._renderService.dimensions.css.cell.width.toFixed(0),ne=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${x.C0.ESC}[6;${ne};${de}t`)}}cancel(V,G){if(this.options.cancelEvents||G)return V.preventDefault(),V.stopPropagation(),!1}}u.Terminal=ge},9924:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.TimeBasedDebouncer=void 0,u.TimeBasedDebouncer=class{constructor(_,y=1e3){this._renderCallback=_,this._debounceThresholdMS=y,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(_,y,w){this._rowCount=w,_=_!==void 0?_:0,y=y!==void 0?y:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,_):_,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,y):y;let R=Date.now();if(R-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=R,this._innerRefresh();else if(!this._additionalRefreshRequested){let x=R-this._lastRefreshMs,P=this._debounceThresholdMS-x;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},P)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let _=Math.max(this._rowStart,0),y=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(_,y)}}},1680:function(B,u,_){var y=this&&this.__decorate||function(c,p,v,e){var i,t=arguments.length,n=t<3?p:e===null?e=Object.getOwnPropertyDescriptor(p,v):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(c,p,v,e);else for(var r=c.length-1;r>=0;r--)(i=c[r])&&(n=(t<3?i(n):t>3?i(p,v,n):i(p,v))||n);return t>3&&n&&Object.defineProperty(p,v,n),n},w=this&&this.__param||function(c,p){return function(v,e){p(v,e,c)}};Object.defineProperty(u,"__esModule",{value:!0}),u.Viewport=void 0;let R=_(844),x=_(3656),P=_(4725),A=_(2585),S=class extends R.Disposable{constructor(c,p,v,e,i,t,n,r,a){super(),this._scrollLines=c,this._viewportElement=p,this._scrollArea=v,this._bufferService=e,this._optionsService=i,this._charSizeService=t,this._renderService=n,this._coreBrowserService=r,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,x.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(l=>this._activeBuffer=l.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(l=>this._renderDimensions=l)),this._handleThemeChange(a.colors),this.register(a.onChangeColors(l=>this._handleThemeChange(l))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(c){this._viewportElement.style.backgroundColor=c.background.css}_refresh(c){if(c)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;let p=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==p&&(this._lastRecordedBufferHeight=p,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}let c=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==c&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=c),this._refreshAnimationFrame=null}syncScrollArea(c=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(c);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(c)}_handleScroll(c){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);let p=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(p)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;let c=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(c*(this._smoothScrollState.target-this._smoothScrollState.origin)),c<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(c,p){let v=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(p<0&&this._viewportElement.scrollTop!==0||p>0&&v<this._lastRecordedBufferHeight)||(c.cancelable&&c.preventDefault(),!1)}handleWheel(c){let p=this._getPixelsScrolled(c);return p!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+p:this._smoothScrollState.target+=p,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=p,this._bubbleScroll(c,p))}_getPixelsScrolled(c){if(c.deltaY===0||c.shiftKey)return 0;let p=this._applyScrollModifier(c.deltaY,c);return c.deltaMode===WheelEvent.DOM_DELTA_LINE?p*=this._currentRowHeight:c.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(p*=this._currentRowHeight*this._bufferService.rows),p}getLinesScrolled(c){if(c.deltaY===0||c.shiftKey)return 0;let p=this._applyScrollModifier(c.deltaY,c);return c.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(p/=this._currentRowHeight+0,this._wheelPartialScroll+=p,p=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):c.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(p*=this._bufferService.rows),p}_applyScrollModifier(c,p){let v=this._optionsService.rawOptions.fastScrollModifier;return v==="alt"&&p.altKey||v==="ctrl"&&p.ctrlKey||v==="shift"&&p.shiftKey?c*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:c*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(c){this._lastTouchY=c.touches[0].pageY}handleTouchMove(c){let p=this._lastTouchY-c.touches[0].pageY;return this._lastTouchY=c.touches[0].pageY,p!==0&&(this._viewportElement.scrollTop+=p,this._bubbleScroll(c,p))}};S=y([w(3,A.IBufferService),w(4,A.IOptionsService),w(5,P.ICharSizeService),w(6,P.IRenderService),w(7,P.ICoreBrowserService),w(8,P.IThemeService)],S),u.Viewport=S},3107:function(B,u,_){var y=this&&this.__decorate||function(c,p,v,e){var i,t=arguments.length,n=t<3?p:e===null?e=Object.getOwnPropertyDescriptor(p,v):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(c,p,v,e);else for(var r=c.length-1;r>=0;r--)(i=c[r])&&(n=(t<3?i(n):t>3?i(p,v,n):i(p,v))||n);return t>3&&n&&Object.defineProperty(p,v,n),n},w=this&&this.__param||function(c,p){return function(v,e){p(v,e,c)}};Object.defineProperty(u,"__esModule",{value:!0}),u.BufferDecorationRenderer=void 0;let R=_(3656),x=_(4725),P=_(844),A=_(2585),S=class extends P.Disposable{constructor(c,p,v,e){super(),this._screenElement=c,this._bufferService=p,this._decorationService=v,this._renderService=e,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,R.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(i=>this._removeDecoration(i))),this.register((0,P.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let c of this._decorationService.decorations)this._renderDecoration(c);this._dimensionsChanged=!1}_renderDecoration(c){this._refreshStyle(c),this._dimensionsChanged&&this._refreshXPosition(c)}_createElement(c){var p;let v=document.createElement("div");v.classList.add("xterm-decoration"),v.style.width=`${Math.round((c.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,v.style.height=(c.options.height||1)*this._renderService.dimensions.css.cell.height+"px",v.style.top=(c.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",v.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let e=(p=c.options.x)!==null&&p!==void 0?p:0;return e&&e>this._bufferService.cols&&(v.style.display="none"),this._refreshXPosition(c,v),v}_refreshStyle(c){let p=c.marker.line-this._bufferService.buffers.active.ydisp;if(p<0||p>=this._bufferService.rows)c.element&&(c.element.style.display="none",c.onRenderEmitter.fire(c.element));else{let v=this._decorationElements.get(c);v||(v=this._createElement(c),c.element=v,this._decorationElements.set(c,v),this._container.appendChild(v)),v.style.top=p*this._renderService.dimensions.css.cell.height+"px",v.style.display=this._altBufferIsActive?"none":"block",c.onRenderEmitter.fire(v)}}_refreshXPosition(c,p=c.element){var v;if(!p)return;let e=(v=c.options.x)!==null&&v!==void 0?v:0;(c.options.anchor||"left")==="right"?p.style.right=e?e*this._renderService.dimensions.css.cell.width+"px":"":p.style.left=e?e*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(c){var p;(p=this._decorationElements.get(c))===null||p===void 0||p.remove(),this._decorationElements.delete(c),c.dispose()}};S=y([w(1,A.IBufferService),w(2,A.IDecorationService),w(3,x.IRenderService)],S),u.BufferDecorationRenderer=S},5871:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.ColorZoneStore=void 0,u.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(_){if(_.options.overviewRulerOptions){for(let y of this._zones)if(y.color===_.options.overviewRulerOptions.color&&y.position===_.options.overviewRulerOptions.position){if(this._lineIntersectsZone(y,_.marker.line))return;if(this._lineAdjacentToZone(y,_.marker.line,_.options.overviewRulerOptions.position))return void this._addLineToZone(y,_.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=_.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=_.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=_.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=_.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:_.options.overviewRulerOptions.color,position:_.options.overviewRulerOptions.position,startBufferLine:_.marker.line,endBufferLine:_.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(_){this._linePadding=_}_lineIntersectsZone(_,y){return y>=_.startBufferLine&&y<=_.endBufferLine}_lineAdjacentToZone(_,y,w){return y>=_.startBufferLine-this._linePadding[w||"full"]&&y<=_.endBufferLine+this._linePadding[w||"full"]}_addLineToZone(_,y){_.startBufferLine=Math.min(_.startBufferLine,y),_.endBufferLine=Math.max(_.endBufferLine,y)}}},5744:function(B,u,_){var y=this&&this.__decorate||function(i,t,n,r){var a,l=arguments.length,g=l<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(i,t,n,r);else for(var D=i.length-1;D>=0;D--)(a=i[D])&&(g=(l<3?a(g):l>3?a(t,n,g):a(t,n))||g);return l>3&&g&&Object.defineProperty(t,n,g),g},w=this&&this.__param||function(i,t){return function(n,r){t(n,r,i)}};Object.defineProperty(u,"__esModule",{value:!0}),u.OverviewRulerRenderer=void 0;let R=_(5871),x=_(3656),P=_(4725),A=_(844),S=_(2585),c={full:0,left:0,center:0,right:0},p={full:0,left:0,center:0,right:0},v={full:0,left:0,center:0,right:0},e=class extends A.Disposable{constructor(i,t,n,r,a,l,g){var D;super(),this._viewportElement=i,this._screenElement=t,this._bufferService=n,this._decorationService=r,this._renderService=a,this._optionsService=l,this._coreBrowseService=g,this._colorZoneStore=new R.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(D=this._viewportElement.parentElement)===null||D===void 0||D.insertBefore(this._canvas,this._viewportElement);let C=this._canvas.getContext("2d");if(!C)throw new Error("Ctx cannot be null");this._ctx=C,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,A.toDisposable)(()=>{var b;(b=this._canvas)===null||b===void 0||b.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,x.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){let i=Math.floor(this._canvas.width/3),t=Math.ceil(this._canvas.width/3);p.full=this._canvas.width,p.left=i,p.center=t,p.right=i,this._refreshDrawHeightConstants(),v.full=0,v.left=0,v.center=p.left,v.right=p.left+p.center}_refreshDrawHeightConstants(){c.full=Math.round(2*this._coreBrowseService.dpr);let i=this._canvas.height/this._bufferService.buffer.lines.length,t=Math.round(Math.max(Math.min(i,12),6)*this._coreBrowseService.dpr);c.left=t,c.center=t,c.right=t}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*c.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let t of this._decorationService.decorations)this._colorZoneStore.addDecoration(t);this._ctx.lineWidth=1;let i=this._colorZoneStore.zones;for(let t of i)t.position!=="full"&&this._renderColorZone(t);for(let t of i)t.position==="full"&&this._renderColorZone(t);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(i){this._ctx.fillStyle=i.color,this._ctx.fillRect(v[i.position||"full"],Math.round((this._canvas.height-1)*(i.startBufferLine/this._bufferService.buffers.active.lines.length)-c[i.position||"full"]/2),p[i.position||"full"],Math.round((this._canvas.height-1)*((i.endBufferLine-i.startBufferLine)/this._bufferService.buffers.active.lines.length)+c[i.position||"full"]))}_queueRefresh(i,t){this._shouldUpdateDimensions=i||this._shouldUpdateDimensions,this._shouldUpdateAnchor=t||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};e=y([w(2,S.IBufferService),w(3,S.IDecorationService),w(4,P.IRenderService),w(5,S.IOptionsService),w(6,P.ICoreBrowserService)],e),u.OverviewRulerRenderer=e},2950:function(B,u,_){var y=this&&this.__decorate||function(S,c,p,v){var e,i=arguments.length,t=i<3?c:v===null?v=Object.getOwnPropertyDescriptor(c,p):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")t=Reflect.decorate(S,c,p,v);else for(var n=S.length-1;n>=0;n--)(e=S[n])&&(t=(i<3?e(t):i>3?e(c,p,t):e(c,p))||t);return i>3&&t&&Object.defineProperty(c,p,t),t},w=this&&this.__param||function(S,c){return function(p,v){c(p,v,S)}};Object.defineProperty(u,"__esModule",{value:!0}),u.CompositionHelper=void 0;let R=_(4725),x=_(2585),P=_(2584),A=class{constructor(S,c,p,v,e,i){this._textarea=S,this._compositionView=c,this._bufferService=p,this._optionsService=v,this._coreService=e,this._renderService=i,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(S){this._compositionView.textContent=S.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(S){if(this._isComposing||this._isSendingComposition){if(S.keyCode===229||S.keyCode===16||S.keyCode===17||S.keyCode===18)return!1;this._finalizeComposition(!1)}return S.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(S){if(this._compositionView.classList.remove("active"),this._isComposing=!1,S){let c={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let p;this._isSendingComposition=!1,c.start+=this._dataAlreadySent.length,p=this._isComposing?this._textarea.value.substring(c.start,c.end):this._textarea.value.substring(c.start),p.length>0&&this._coreService.triggerDataEvent(p,!0)}},0)}else{this._isSendingComposition=!1;let c=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(c,!0)}}_handleAnyTextareaChanges(){let S=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let c=this._textarea.value,p=c.replace(S,"");this._dataAlreadySent=p,c.length>S.length?this._coreService.triggerDataEvent(p,!0):c.length<S.length?this._coreService.triggerDataEvent(`${P.C0.DEL}`,!0):c.length===S.length&&c!==S&&this._coreService.triggerDataEvent(c,!0)}},0)}updateCompositionElements(S){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let c=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),p=this._renderService.dimensions.css.cell.height,v=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,e=c*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=e+"px",this._compositionView.style.top=v+"px",this._compositionView.style.height=p+"px",this._compositionView.style.lineHeight=p+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let i=this._compositionView.getBoundingClientRect();this._textarea.style.left=e+"px",this._textarea.style.top=v+"px",this._textarea.style.width=Math.max(i.width,1)+"px",this._textarea.style.height=Math.max(i.height,1)+"px",this._textarea.style.lineHeight=i.height+"px"}S||setTimeout(()=>this.updateCompositionElements(!0),0)}}};A=y([w(2,x.IBufferService),w(3,x.IOptionsService),w(4,x.ICoreService),w(5,R.IRenderService)],A),u.CompositionHelper=A},9806:(B,u)=>{function _(y,w,R){let x=R.getBoundingClientRect(),P=y.getComputedStyle(R),A=parseInt(P.getPropertyValue("padding-left")),S=parseInt(P.getPropertyValue("padding-top"));return[w.clientX-x.left-A,w.clientY-x.top-S]}Object.defineProperty(u,"__esModule",{value:!0}),u.getCoords=u.getCoordsRelativeToElement=void 0,u.getCoordsRelativeToElement=_,u.getCoords=function(y,w,R,x,P,A,S,c,p){if(!A)return;let v=_(y,w,R);return v?(v[0]=Math.ceil((v[0]+(p?S/2:0))/S),v[1]=Math.ceil(v[1]/c),v[0]=Math.min(Math.max(v[0],1),x+(p?1:0)),v[1]=Math.min(Math.max(v[1],1),P),v):void 0}},9504:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.moveToCellSequence=void 0;let y=_(2584);function w(c,p,v,e){let i=c-R(c,v),t=p-R(p,v),n=Math.abs(i-t)-function(r,a,l){let g=0,D=r-R(r,l),C=a-R(a,l);for(let b=0;b<Math.abs(D-C);b++){let N=x(r,a)==="A"?-1:1,W=l.buffer.lines.get(D+N*b);W!=null&&W.isWrapped&&g++}return g}(c,p,v);return S(n,A(x(c,p),e))}function R(c,p){let v=0,e=p.buffer.lines.get(c),i=e==null?void 0:e.isWrapped;for(;i&&c>=0&&c<p.rows;)v++,e=p.buffer.lines.get(--c),i=e==null?void 0:e.isWrapped;return v}function x(c,p){return c>p?"A":"B"}function P(c,p,v,e,i,t){let n=c,r=p,a="";for(;n!==v||r!==e;)n+=i?1:-1,i&&n>t.cols-1?(a+=t.buffer.translateBufferLineToString(r,!1,c,n),n=0,c=0,r++):!i&&n<0&&(a+=t.buffer.translateBufferLineToString(r,!1,0,c+1),n=t.cols-1,c=n,r--);return a+t.buffer.translateBufferLineToString(r,!1,c,n)}function A(c,p){let v=p?"O":"[";return y.C0.ESC+v+c}function S(c,p){c=Math.floor(c);let v="";for(let e=0;e<c;e++)v+=p;return v}u.moveToCellSequence=function(c,p,v,e){let i=v.buffer.x,t=v.buffer.y;if(!v.buffer.hasScrollback)return function(a,l,g,D,C,b){return w(l,D,C,b).length===0?"":S(P(a,l,a,l-R(l,C),!1,C).length,A("D",b))}(i,t,0,p,v,e)+w(t,p,v,e)+function(a,l,g,D,C,b){let N;N=w(l,D,C,b).length>0?D-R(D,C):l;let W=D,K=function(E,F,I,j,ie,ee){let fe;return fe=w(I,j,ie,ee).length>0?j-R(j,ie):F,E<I&&fe<=j||E>=I&&fe<j?"C":"D"}(a,l,g,D,C,b);return S(P(a,N,g,W,K==="C",C).length,A(K,b))}(i,t,c,p,v,e);let n;if(t===p)return n=i>c?"D":"C",S(Math.abs(i-c),A(n,e));n=t>p?"D":"C";let r=Math.abs(t-p);return S(function(a,l){return l.cols-a}(t>p?c:i,v)+(r-1)*v.cols+1+((t>p?i:c)-1),A(n,e))}},1296:function(B,u,_){var y=this&&this.__decorate||function(a,l,g,D){var C,b=arguments.length,N=b<3?l:D===null?D=Object.getOwnPropertyDescriptor(l,g):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(a,l,g,D);else for(var W=a.length-1;W>=0;W--)(C=a[W])&&(N=(b<3?C(N):b>3?C(l,g,N):C(l,g))||N);return b>3&&N&&Object.defineProperty(l,g,N),N},w=this&&this.__param||function(a,l){return function(g,D){l(g,D,a)}};Object.defineProperty(u,"__esModule",{value:!0}),u.DomRenderer=void 0;let R=_(9631),x=_(3787),P=_(2223),A=_(6171),S=_(4725),c=_(8055),p=_(8460),v=_(844),e=_(2585),i="xterm-dom-renderer-owner-",t="xterm-focus",n=1,r=class extends v.Disposable{constructor(a,l,g,D,C,b,N,W,K,E){super(),this._element=a,this._screenElement=l,this._viewportElement=g,this._linkifier2=D,this._charSizeService=b,this._optionsService=N,this._bufferService=W,this._coreBrowserService=K,this._terminalClass=n++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new p.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,A.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(E.onChangeColors(F=>this._injectCss(F))),this._injectCss(E.colors),this._rowFactory=C.createInstance(x.DomRendererRowFactory,document),this._element.classList.add(i+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(F=>this._handleLinkHover(F))),this.register(this._linkifier2.onHideLinkUnderline(F=>this._handleLinkLeave(F))),this.register((0,v.toDisposable)(()=>{this._element.classList.remove(i+this._terminalClass),(0,R.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement)}))}_updateDimensions(){let a=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*a,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*a),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/a),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/a),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let g of this._rowElements)g.style.width=`${this.dimensions.css.canvas.width}px`,g.style.height=`${this.dimensions.css.cell.height}px`,g.style.lineHeight=`${this.dimensions.css.cell.height}px`,g.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let l=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=l,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(a){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let l=`${this._terminalSelector} .xterm-rows { color: ${a.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;l+=`${this._terminalSelector} span:not(.${x.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${x.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${x.ITALIC_CLASS} { font-style: italic;}`,l+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",l+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${a.cursor.css};  color: ${a.cursorAccent.css}; } 50% {  background-color: ${a.cursorAccent.css};  color: ${a.cursor.css}; }}`,l+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${x.CURSOR_CLASS}.${x.CURSOR_STYLE_BLOCK_CLASS} { outline: 1px solid ${a.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${x.CURSOR_CLASS}.${x.CURSOR_BLINK_CLASS}:not(.${x.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${x.CURSOR_CLASS}.${x.CURSOR_BLINK_CLASS}.${x.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${x.CURSOR_CLASS}.${x.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${a.cursor.css}; color: ${a.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${x.CURSOR_CLASS}.${x.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${a.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${x.CURSOR_CLASS}.${x.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${a.cursor.css} inset;}`,l+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${a.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${a.selectionInactiveBackgroundOpaque.css};}`;for(let[g,D]of a.ansi.entries())l+=`${this._terminalSelector} .xterm-fg-${g} { color: ${D.css}; }${this._terminalSelector} .xterm-bg-${g} { background-color: ${D.css}; }`;l+=`${this._terminalSelector} .xterm-fg-${P.INVERTED_DEFAULT_COLOR} { color: ${c.color.opaque(a.background).css}; }${this._terminalSelector} .xterm-bg-${P.INVERTED_DEFAULT_COLOR} { background-color: ${a.foreground.css}; }`,this._themeStyleElement.textContent=l}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(a,l){for(let g=this._rowElements.length;g<=l;g++){let D=document.createElement("div");this._rowContainer.appendChild(D),this._rowElements.push(D)}for(;this._rowElements.length>l;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(a,l){this._refreshRowElements(a,l),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(t)}handleFocus(){this._rowContainer.classList.add(t)}handleSelectionChanged(a,l,g){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(a,l,g),this.renderRows(0,this._bufferService.rows-1),!a||!l)return;let D=a[1]-this._bufferService.buffer.ydisp,C=l[1]-this._bufferService.buffer.ydisp,b=Math.max(D,0),N=Math.min(C,this._bufferService.rows-1);if(b>=this._bufferService.rows||N<0)return;let W=document.createDocumentFragment();if(g){let K=a[0]>l[0];W.appendChild(this._createSelectionElement(b,K?l[0]:a[0],K?a[0]:l[0],N-b+1))}else{let K=D===b?a[0]:0,E=b===C?l[0]:this._bufferService.cols;W.appendChild(this._createSelectionElement(b,K,E));let F=N-b-1;if(W.appendChild(this._createSelectionElement(b+1,0,this._bufferService.cols,F)),b!==N){let I=C===N?l[0]:this._bufferService.cols;W.appendChild(this._createSelectionElement(N,0,I))}}this._selectionContainer.appendChild(W)}_createSelectionElement(a,l,g,D=1){let C=document.createElement("div");return C.style.height=D*this.dimensions.css.cell.height+"px",C.style.top=a*this.dimensions.css.cell.height+"px",C.style.left=l*this.dimensions.css.cell.width+"px",C.style.width=this.dimensions.css.cell.width*(g-l)+"px",C}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions()}clear(){for(let a of this._rowElements)a.replaceChildren()}renderRows(a,l){let g=this._bufferService.buffer.ybase+this._bufferService.buffer.y,D=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),C=this._optionsService.rawOptions.cursorBlink;for(let b=a;b<=l;b++){let N=this._rowElements[b],W=b+this._bufferService.buffer.ydisp,K=this._bufferService.buffer.lines.get(W),E=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[b]&&this._cellToRowElements[b].length===this._bufferService.cols||(this._cellToRowElements[b]=new Int16Array(this._bufferService.cols)),N.replaceChildren(this._rowFactory.createRow(K,W,W===g,E,D,C,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[b]))}}get _terminalSelector(){return`.${i}${this._terminalClass}`}_handleLinkHover(a){this._setCellUnderline(a.x1,a.x2,a.y1,a.y2,a.cols,!0)}_handleLinkLeave(a){this._setCellUnderline(a.x1,a.x2,a.y1,a.y2,a.cols,!1)}_setCellUnderline(a,l,g,D,C,b){if(a=this._cellToRowElements[g][a],l=this._cellToRowElements[D][l],a!==-1&&l!==-1)for(;a!==l||g!==D;){let N=this._rowElements[g];if(!N)return;let W=N.children[a];W&&(W.style.textDecoration=b?"underline":"none"),++a>=C&&(a=0,g++)}}};r=y([w(4,e.IInstantiationService),w(5,S.ICharSizeService),w(6,e.IOptionsService),w(7,e.IBufferService),w(8,S.ICoreBrowserService),w(9,S.IThemeService)],r),u.DomRenderer=r},3787:function(B,u,_){var y=this&&this.__decorate||function(n,r,a,l){var g,D=arguments.length,C=D<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,a):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(n,r,a,l);else for(var b=n.length-1;b>=0;b--)(g=n[b])&&(C=(D<3?g(C):D>3?g(r,a,C):g(r,a))||C);return D>3&&C&&Object.defineProperty(r,a,C),C},w=this&&this.__param||function(n,r){return function(a,l){r(a,l,n)}};Object.defineProperty(u,"__esModule",{value:!0}),u.DomRendererRowFactory=u.CURSOR_STYLE_UNDERLINE_CLASS=u.CURSOR_STYLE_BAR_CLASS=u.CURSOR_STYLE_BLOCK_CLASS=u.CURSOR_BLINK_CLASS=u.CURSOR_CLASS=u.STRIKETHROUGH_CLASS=u.UNDERLINE_CLASS=u.ITALIC_CLASS=u.DIM_CLASS=u.BOLD_CLASS=void 0;let R=_(2223),x=_(643),P=_(511),A=_(2585),S=_(8055),c=_(4725),p=_(4269),v=_(6171),e=_(3734);u.BOLD_CLASS="xterm-bold",u.DIM_CLASS="xterm-dim",u.ITALIC_CLASS="xterm-italic",u.UNDERLINE_CLASS="xterm-underline",u.STRIKETHROUGH_CLASS="xterm-strikethrough",u.CURSOR_CLASS="xterm-cursor",u.CURSOR_BLINK_CLASS="xterm-cursor-blink",u.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",u.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",u.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let i=class{constructor(n,r,a,l,g,D,C){this._document=n,this._characterJoinerService=r,this._optionsService=a,this._coreBrowserService=l,this._coreService=g,this._decorationService=D,this._themeService=C,this._workCell=new P.CellData,this._columnSelectMode=!1}handleSelectionChanged(n,r,a){this._selectionStart=n,this._selectionEnd=r,this._columnSelectMode=a}createRow(n,r,a,l,g,D,C,b,N){let W=this._document.createDocumentFragment(),K=this._characterJoinerService.getJoinedCharacters(r),E=0;for(let ie=Math.min(n.length,b)-1;ie>=0;ie--)if(n.loadCell(ie,this._workCell).getCode()!==x.NULL_CELL_CODE||a&&ie===g){E=ie+1;break}let F=this._themeService.colors,I=-1,j=0;for(;j<E;j++){n.loadCell(j,this._workCell);let ie=this._workCell.getWidth();if(ie===0){N[j]=I;continue}let ee=!1,fe=j,ue=this._workCell;if(K.length>0&&j===K[0][0]){ee=!0;let Le=K.shift();ue=new p.JoinedCellData(this._workCell,n.translateToString(!0,Le[0],Le[1]),Le[1]-Le[0]),fe=Le[1]-1,ie=ue.getWidth()}let ge=this._document.createElement("span");if(ie>1&&(ge.style.width=C*ie+"px"),ee&&(ge.style.display="inline",g>=j&&g<=fe&&(g=j)),!this._coreService.isCursorHidden&&a&&j===g)switch(ge.classList.add(u.CURSOR_CLASS),D&&ge.classList.add(u.CURSOR_BLINK_CLASS),l){case"bar":ge.classList.add(u.CURSOR_STYLE_BAR_CLASS);break;case"underline":ge.classList.add(u.CURSOR_STYLE_UNDERLINE_CLASS);break;default:ge.classList.add(u.CURSOR_STYLE_BLOCK_CLASS)}if(ue.isBold()&&ge.classList.add(u.BOLD_CLASS),ue.isItalic()&&ge.classList.add(u.ITALIC_CLASS),ue.isDim()&&ge.classList.add(u.DIM_CLASS),ue.isInvisible()?ge.textContent=x.WHITESPACE_CELL_CHAR:ge.textContent=ue.getChars()||x.WHITESPACE_CELL_CHAR,ue.isUnderline()&&(ge.classList.add(`${u.UNDERLINE_CLASS}-${ue.extended.underlineStyle}`),ge.textContent===" "&&(ge.textContent="\xA0"),!ue.isUnderlineColorDefault()))if(ue.isUnderlineColorRGB())ge.style.textDecorationColor=`rgb(${e.AttributeData.toColorRGB(ue.getUnderlineColor()).join(",")})`;else{let Le=ue.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&ue.isBold()&&Le<8&&(Le+=8),ge.style.textDecorationColor=F.ansi[Le].css}ue.isStrikethrough()&&ge.classList.add(u.STRIKETHROUGH_CLASS);let q=ue.getFgColor(),V=ue.getFgColorMode(),G=ue.getBgColor(),ae=ue.getBgColorMode(),de=!!ue.isInverse();if(de){let Le=q;q=G,G=Le;let De=V;V=ae,ae=De}let ne,_e,Fe=!1;this._decorationService.forEachDecorationAtCell(j,r,void 0,Le=>{Le.options.layer!=="top"&&Fe||(Le.backgroundColorRGB&&(ae=50331648,G=Le.backgroundColorRGB.rgba>>8&16777215,ne=Le.backgroundColorRGB),Le.foregroundColorRGB&&(V=50331648,q=Le.foregroundColorRGB.rgba>>8&16777215,_e=Le.foregroundColorRGB),Fe=Le.options.layer==="top")});let Ae=this._isCellInSelection(j,r),ve;switch(Fe||F.selectionForeground&&Ae&&(V=50331648,q=F.selectionForeground.rgba>>8&16777215,_e=F.selectionForeground),Ae&&(ne=this._coreBrowserService.isFocused?F.selectionBackgroundOpaque:F.selectionInactiveBackgroundOpaque,Fe=!0),Fe&&ge.classList.add("xterm-decoration-top"),ae){case 16777216:case 33554432:ve=F.ansi[G],ge.classList.add(`xterm-bg-${G}`);break;case 50331648:ve=S.rgba.toColor(G>>16,G>>8&255,255&G),this._addStyle(ge,`background-color:#${t((G>>>0).toString(16),"0",6)}`);break;default:de?(ve=F.foreground,ge.classList.add(`xterm-bg-${R.INVERTED_DEFAULT_COLOR}`)):ve=F.background}switch(ne||ue.isDim()&&(ne=S.color.multiplyOpacity(ve,.5)),V){case 16777216:case 33554432:ue.isBold()&&q<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(q+=8),this._applyMinimumContrast(ge,ve,F.ansi[q],ue,ne,void 0)||ge.classList.add(`xterm-fg-${q}`);break;case 50331648:let Le=S.rgba.toColor(q>>16&255,q>>8&255,255&q);this._applyMinimumContrast(ge,ve,Le,ue,ne,_e)||this._addStyle(ge,`color:#${t(q.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(ge,ve,F.foreground,ue,ne,void 0)||de&&ge.classList.add(`xterm-fg-${R.INVERTED_DEFAULT_COLOR}`)}W.appendChild(ge),N[j]=++I,j=fe}return j<b-1&&N.subarray(j).fill(++I),W}_applyMinimumContrast(n,r,a,l,g,D){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,v.excludeFromContrastRatioDemands)(l.getCode()))return!1;let C;return g||D||(C=this._themeService.colors.contrastCache.getColor(r.rgba,a.rgba)),C===void 0&&(C=S.color.ensureContrastRatio(g||r,D||a,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((g||r).rgba,(D||a).rgba,C!=null?C:null)),!!C&&(this._addStyle(n,`color:${C.css}`),!0)}_addStyle(n,r){n.setAttribute("style",`${n.getAttribute("style")||""}${r};`)}_isCellInSelection(n,r){let a=this._selectionStart,l=this._selectionEnd;return!(!a||!l)&&(this._columnSelectMode?a[0]<=l[0]?n>=a[0]&&r>=a[1]&&n<l[0]&&r<=l[1]:n<a[0]&&r>=a[1]&&n>=l[0]&&r<=l[1]:r>a[1]&&r<l[1]||a[1]===l[1]&&r===a[1]&&n>=a[0]&&n<l[0]||a[1]<l[1]&&r===l[1]&&n<l[0]||a[1]<l[1]&&r===a[1]&&n>=a[0])}};function t(n,r,a){for(;n.length<a;)n=r+n;return n}i=y([w(1,c.ICharacterJoinerService),w(2,A.IOptionsService),w(3,c.ICoreBrowserService),w(4,A.ICoreService),w(5,A.IDecorationService),w(6,c.IThemeService)],i),u.DomRendererRowFactory=i},2223:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.TEXT_BASELINE=u.DIM_OPACITY=u.INVERTED_DEFAULT_COLOR=void 0;let y=_(6114);u.INVERTED_DEFAULT_COLOR=257,u.DIM_OPACITY=.5,u.TEXT_BASELINE=y.isFirefox||y.isLegacyEdge?"bottom":"ideographic"},6171:(B,u)=>{function _(y){return 57508<=y&&y<=57558}Object.defineProperty(u,"__esModule",{value:!0}),u.createRenderDimensions=u.excludeFromContrastRatioDemands=u.isRestrictedPowerlineGlyph=u.isPowerlineGlyph=u.throwIfFalsy=void 0,u.throwIfFalsy=function(y){if(!y)throw new Error("value must not be falsy");return y},u.isPowerlineGlyph=_,u.isRestrictedPowerlineGlyph=function(y){return 57520<=y&&y<=57527},u.excludeFromContrastRatioDemands=function(y){return _(y)||function(w){return 9472<=w&&w<=9631}(y)},u.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.SelectionModel=void 0,u.SelectionModel=class{constructor(_){this._bufferService=_,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let _=this.selectionStart[0]+this.selectionStartLength;return _>this._bufferService.cols?_%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(_/this._bufferService.cols)-1]:[_%this._bufferService.cols,this.selectionStart[1]+Math.floor(_/this._bufferService.cols)]:[_,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let _=this.selectionStart[0]+this.selectionStartLength;return _>this._bufferService.cols?[_%this._bufferService.cols,this.selectionStart[1]+Math.floor(_/this._bufferService.cols)]:[Math.max(_,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let _=this.selectionStart,y=this.selectionEnd;return!(!_||!y)&&(_[1]>y[1]||_[1]===y[1]&&_[0]>y[0])}handleTrim(_){return this.selectionStart&&(this.selectionStart[1]-=_),this.selectionEnd&&(this.selectionEnd[1]-=_),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(B,u,_){var y=this&&this.__decorate||function(c,p,v,e){var i,t=arguments.length,n=t<3?p:e===null?e=Object.getOwnPropertyDescriptor(p,v):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(c,p,v,e);else for(var r=c.length-1;r>=0;r--)(i=c[r])&&(n=(t<3?i(n):t>3?i(p,v,n):i(p,v))||n);return t>3&&n&&Object.defineProperty(p,v,n),n},w=this&&this.__param||function(c,p){return function(v,e){p(v,e,c)}};Object.defineProperty(u,"__esModule",{value:!0}),u.CharSizeService=void 0;let R=_(2585),x=_(8460),P=_(844),A=class extends P.Disposable{constructor(c,p,v){super(),this._optionsService=v,this.width=0,this.height=0,this._onCharSizeChange=this.register(new x.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new S(c,p,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let c=this._measureStrategy.measure();c.width===this.width&&c.height===this.height||(this.width=c.width,this.height=c.height,this._onCharSizeChange.fire())}};A=y([w(2,R.IOptionsService)],A),u.CharSizeService=A;class S{constructor(p,v,e){this._document=p,this._parentElement=v,this._optionsService=e,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;let p=this._measureElement.getBoundingClientRect();return p.width!==0&&p.height!==0&&(this._result.width=p.width,this._result.height=Math.ceil(p.height)),this._result}}},4269:function(B,u,_){var y=this&&this.__decorate||function(p,v,e,i){var t,n=arguments.length,r=n<3?v:i===null?i=Object.getOwnPropertyDescriptor(v,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(p,v,e,i);else for(var a=p.length-1;a>=0;a--)(t=p[a])&&(r=(n<3?t(r):n>3?t(v,e,r):t(v,e))||r);return n>3&&r&&Object.defineProperty(v,e,r),r},w=this&&this.__param||function(p,v){return function(e,i){v(e,i,p)}};Object.defineProperty(u,"__esModule",{value:!0}),u.CharacterJoinerService=u.JoinedCellData=void 0;let R=_(3734),x=_(643),P=_(511),A=_(2585);class S extends R.AttributeData{constructor(v,e,i){super(),this.content=0,this.combinedData="",this.fg=v.fg,this.bg=v.bg,this.combinedData=e,this._width=i}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(v){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}u.JoinedCellData=S;let c=class Pa{constructor(v){this._bufferService=v,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new P.CellData}register(v){let e={id:this._nextCharacterJoinerId++,handler:v};return this._characterJoiners.push(e),e.id}deregister(v){for(let e=0;e<this._characterJoiners.length;e++)if(this._characterJoiners[e].id===v)return this._characterJoiners.splice(e,1),!0;return!1}getJoinedCharacters(v){if(this._characterJoiners.length===0)return[];let e=this._bufferService.buffer.lines.get(v);if(!e||e.length===0)return[];let i=[],t=e.translateToString(!0),n=0,r=0,a=0,l=e.getFg(0),g=e.getBg(0);for(let D=0;D<e.getTrimmedLength();D++)if(e.loadCell(D,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==l||this._workCell.bg!==g){if(D-n>1){let C=this._getJoinedRanges(t,a,r,e,n);for(let b=0;b<C.length;b++)i.push(C[b])}n=D,a=r,l=this._workCell.fg,g=this._workCell.bg}r+=this._workCell.getChars().length||x.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-n>1){let D=this._getJoinedRanges(t,a,r,e,n);for(let C=0;C<D.length;C++)i.push(D[C])}return i}_getJoinedRanges(v,e,i,t,n){let r=v.substring(e,i),a=[];try{a=this._characterJoiners[0].handler(r)}catch(l){console.error(l)}for(let l=1;l<this._characterJoiners.length;l++)try{let g=this._characterJoiners[l].handler(r);for(let D=0;D<g.length;D++)Pa._mergeRanges(a,g[D])}catch(g){console.error(g)}return this._stringRangesToCellRanges(a,t,n),a}_stringRangesToCellRanges(v,e,i){let t=0,n=!1,r=0,a=v[t];if(a){for(let l=i;l<this._bufferService.cols;l++){let g=e.getWidth(l),D=e.getString(l).length||x.WHITESPACE_CELL_CHAR.length;if(g!==0){if(!n&&a[0]<=r&&(a[0]=l,n=!0),a[1]<=r){if(a[1]=l,a=v[++t],!a)break;a[0]<=r?(a[0]=l,n=!0):n=!1}r+=D}}a&&(a[1]=this._bufferService.cols)}}static _mergeRanges(v,e){let i=!1;for(let t=0;t<v.length;t++){let n=v[t];if(i){if(e[1]<=n[0])return v[t-1][1]=e[1],v;if(e[1]<=n[1])return v[t-1][1]=Math.max(e[1],n[1]),v.splice(t,1),v;v.splice(t,1),t--}else{if(e[1]<=n[0])return v.splice(t,0,e),v;if(e[1]<=n[1])return n[0]=Math.min(e[0],n[0]),v;e[0]<n[1]&&(n[0]=Math.min(e[0],n[0]),i=!0)}}return i?v[v.length-1][1]=e[1]:v.push(e),v}};c=y([w(0,A.IBufferService)],c),u.CharacterJoinerService=c},5114:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.CoreBrowserService=void 0,u.CoreBrowserService=class{constructor(_,y){this._textarea=_,this.window=y,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(B,u,_){var y=this&&this.__decorate||function(A,S,c,p){var v,e=arguments.length,i=e<3?S:p===null?p=Object.getOwnPropertyDescriptor(S,c):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(A,S,c,p);else for(var t=A.length-1;t>=0;t--)(v=A[t])&&(i=(e<3?v(i):e>3?v(S,c,i):v(S,c))||i);return e>3&&i&&Object.defineProperty(S,c,i),i},w=this&&this.__param||function(A,S){return function(c,p){S(c,p,A)}};Object.defineProperty(u,"__esModule",{value:!0}),u.MouseService=void 0;let R=_(4725),x=_(9806),P=class{constructor(A,S){this._renderService=A,this._charSizeService=S}getCoords(A,S,c,p,v){return(0,x.getCoords)(window,A,S,c,p,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,v)}getMouseReportCoords(A,S){let c=(0,x.getCoordsRelativeToElement)(window,A,S);if(!(!this._charSizeService.hasValidSize||c[0]<0||c[1]<0||c[0]>=this._renderService.dimensions.css.canvas.width||c[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(c[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(c[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(c[0]),y:Math.floor(c[1])}}};P=y([w(0,R.IRenderService),w(1,R.ICharSizeService)],P),u.MouseService=P},3230:function(B,u,_){var y=this&&this.__decorate||function(i,t,n,r){var a,l=arguments.length,g=l<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(i,t,n,r);else for(var D=i.length-1;D>=0;D--)(a=i[D])&&(g=(l<3?a(g):l>3?a(t,n,g):a(t,n))||g);return l>3&&g&&Object.defineProperty(t,n,g),g},w=this&&this.__param||function(i,t){return function(n,r){t(n,r,i)}};Object.defineProperty(u,"__esModule",{value:!0}),u.RenderService=void 0;let R=_(6193),x=_(8460),P=_(844),A=_(5596),S=_(3656),c=_(2585),p=_(4725),v=_(7226),e=class extends P.Disposable{constructor(i,t,n,r,a,l,g,D){if(super(),this._rowCount=i,this._charSizeService=r,this._pausedResizeTask=new v.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new x.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new x.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new x.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new x.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var C;return(C=this._renderer)===null||C===void 0?void 0:C.dispose()}}),this._renderDebouncer=new R.RenderDebouncer(g.window,(C,b)=>this._renderRows(C,b)),this.register(this._renderDebouncer),this._screenDprMonitor=new A.ScreenDprMonitor(g.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(l.onResize(()=>this._fullRefresh())),this.register(l.buffers.onBufferActivate(()=>{var C;return(C=this._renderer)===null||C===void 0?void 0:C.clear()})),this.register(n.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(a.onDecorationRegistered(()=>this._fullRefresh())),this.register(a.onDecorationRemoved(()=>this._fullRefresh())),this.register(n.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(l.cols,l.rows),this._fullRefresh()})),this.register(n.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(l.buffer.y,l.buffer.y,!0))),this.register((0,S.addDisposableDomListener)(g.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(D.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in g.window){let C=new g.window.IntersectionObserver(b=>this._handleIntersectionChange(b[b.length-1]),{threshold:0});C.observe(t),this.register({dispose:()=>C.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(i){this._isPaused=i.isIntersecting===void 0?i.intersectionRatio===0:!i.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(i,t,n=!1){this._isPaused?this._needsFullRefresh=!0:(n||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(i,t,this._rowCount))}_renderRows(i,t){this._renderer&&(this._renderer.renderRows(i,t),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:i,end:t}),this._onRender.fire({start:i,end:t}),this._isNextRenderRedrawOnly=!0)}resize(i,t){this._rowCount=t,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(i){var t;(t=this._renderer)===null||t===void 0||t.dispose(),this._renderer=i,this._renderer.onRequestRedraw(n=>this.refreshRows(n.start,n.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(i){return this._renderDebouncer.addRefreshCallback(i)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var i,t;this._renderer&&((t=(i=this._renderer).clearTextureAtlas)===null||t===void 0||t.call(i),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(i,t){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(i,t)):this._renderer.handleResize(i,t),this._fullRefresh())}handleCharSizeChanged(){var i;(i=this._renderer)===null||i===void 0||i.handleCharSizeChanged()}handleBlur(){var i;(i=this._renderer)===null||i===void 0||i.handleBlur()}handleFocus(){var i;(i=this._renderer)===null||i===void 0||i.handleFocus()}handleSelectionChanged(i,t,n){var r;this._selectionState.start=i,this._selectionState.end=t,this._selectionState.columnSelectMode=n,(r=this._renderer)===null||r===void 0||r.handleSelectionChanged(i,t,n)}handleCursorMove(){var i;(i=this._renderer)===null||i===void 0||i.handleCursorMove()}clear(){var i;(i=this._renderer)===null||i===void 0||i.clear()}};e=y([w(2,c.IOptionsService),w(3,p.ICharSizeService),w(4,c.IDecorationService),w(5,c.IBufferService),w(6,p.ICoreBrowserService),w(7,p.IThemeService)],e),u.RenderService=e},9312:function(B,u,_){var y=this&&this.__decorate||function(a,l,g,D){var C,b=arguments.length,N=b<3?l:D===null?D=Object.getOwnPropertyDescriptor(l,g):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(a,l,g,D);else for(var W=a.length-1;W>=0;W--)(C=a[W])&&(N=(b<3?C(N):b>3?C(l,g,N):C(l,g))||N);return b>3&&N&&Object.defineProperty(l,g,N),N},w=this&&this.__param||function(a,l){return function(g,D){l(g,D,a)}};Object.defineProperty(u,"__esModule",{value:!0}),u.SelectionService=void 0;let R=_(6114),x=_(456),P=_(511),A=_(8460),S=_(4725),c=_(2585),p=_(9806),v=_(9504),e=_(844),i=_(4841),t=String.fromCharCode(160),n=new RegExp(t,"g"),r=class extends e.Disposable{constructor(a,l,g,D,C,b,N,W,K){super(),this._element=a,this._screenElement=l,this._linkifier=g,this._bufferService=D,this._coreService=C,this._mouseService=b,this._optionsService=N,this._renderService=W,this._coreBrowserService=K,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new P.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new A.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new A.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new A.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new A.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=E=>this._handleMouseMove(E),this._mouseUpListener=E=>this._handleMouseUp(E),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(E=>this._handleTrim(E)),this.register(this._bufferService.buffers.onBufferActivate(E=>this._handleBufferActivate(E))),this.enable(),this._model=new x.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,e.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let a=this._model.finalSelectionStart,l=this._model.finalSelectionEnd;return!(!a||!l||a[0]===l[0]&&a[1]===l[1])}get selectionText(){let a=this._model.finalSelectionStart,l=this._model.finalSelectionEnd;if(!a||!l)return"";let g=this._bufferService.buffer,D=[];if(this._activeSelectionMode===3){if(a[0]===l[0])return"";let C=a[0]<l[0]?a[0]:l[0],b=a[0]<l[0]?l[0]:a[0];for(let N=a[1];N<=l[1];N++){let W=g.translateBufferLineToString(N,!0,C,b);D.push(W)}}else{let C=a[1]===l[1]?l[0]:void 0;D.push(g.translateBufferLineToString(a[1],!0,a[0],C));for(let b=a[1]+1;b<=l[1]-1;b++){let N=g.lines.get(b),W=g.translateBufferLineToString(b,!0);N!=null&&N.isWrapped?D[D.length-1]+=W:D.push(W)}if(a[1]!==l[1]){let b=g.lines.get(l[1]),N=g.translateBufferLineToString(l[1],!0,0,l[0]);b&&b.isWrapped?D[D.length-1]+=N:D.push(N)}}return D.map(C=>C.replace(n," ")).join(R.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(a){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),R.isLinux&&a&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(a){let l=this._getMouseBufferCoords(a),g=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!!(g&&D&&l)&&this._areCoordsInSelection(l,g,D)}isCellInSelection(a,l){let g=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!(!g||!D)&&this._areCoordsInSelection([a,l],g,D)}_areCoordsInSelection(a,l,g){return a[1]>l[1]&&a[1]<g[1]||l[1]===g[1]&&a[1]===l[1]&&a[0]>=l[0]&&a[0]<g[0]||l[1]<g[1]&&a[1]===g[1]&&a[0]<g[0]||l[1]<g[1]&&a[1]===l[1]&&a[0]>=l[0]}_selectWordAtCursor(a,l){var g,D;let C=(D=(g=this._linkifier.currentLink)===null||g===void 0?void 0:g.link)===null||D===void 0?void 0:D.range;if(C)return this._model.selectionStart=[C.start.x-1,C.start.y-1],this._model.selectionStartLength=(0,i.getRangeLength)(C,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let b=this._getMouseBufferCoords(a);return!!b&&(this._selectWordAt(b,l),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(a,l){this._model.clearSelection(),a=Math.max(a,0),l=Math.min(l,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,a],this._model.selectionEnd=[this._bufferService.cols,l],this.refresh(),this._onSelectionChange.fire()}_handleTrim(a){this._model.handleTrim(a)&&this.refresh()}_getMouseBufferCoords(a){let l=this._mouseService.getCoords(a,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(l)return l[0]--,l[1]--,l[1]+=this._bufferService.buffer.ydisp,l}_getMouseEventScrollAmount(a){let l=(0,p.getCoordsRelativeToElement)(this._coreBrowserService.window,a,this._screenElement)[1],g=this._renderService.dimensions.css.canvas.height;return l>=0&&l<=g?0:(l>g&&(l-=g),l=Math.min(Math.max(l,-50),50),l/=50,l/Math.abs(l)+Math.round(14*l))}shouldForceSelection(a){return R.isMac?a.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:a.shiftKey}handleMouseDown(a){if(this._mouseDownTimeStamp=a.timeStamp,(a.button!==2||!this.hasSelection)&&a.button===0){if(!this._enabled){if(!this.shouldForceSelection(a))return;a.stopPropagation()}a.preventDefault(),this._dragScrollAmount=0,this._enabled&&a.shiftKey?this._handleIncrementalClick(a):a.detail===1?this._handleSingleClick(a):a.detail===2?this._handleDoubleClick(a):a.detail===3&&this._handleTripleClick(a),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(a){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(a))}_handleSingleClick(a){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(a)?3:0,this._model.selectionStart=this._getMouseBufferCoords(a),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let l=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);l&&l.length!==this._model.selectionStart[0]&&l.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(a){this._selectWordAtCursor(a,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(a){let l=this._getMouseBufferCoords(a);l&&(this._activeSelectionMode=2,this._selectLineAt(l[1]))}shouldColumnSelect(a){return a.altKey&&!(R.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(a){if(a.stopImmediatePropagation(),!this._model.selectionStart)return;let l=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(a),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(a),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let g=this._bufferService.buffer;if(this._model.selectionEnd[1]<g.lines.length){let D=g.lines.get(this._model.selectionEnd[1]);D&&D.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}l&&l[0]===this._model.selectionEnd[0]&&l[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let a=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(a.ydisp+this._bufferService.rows,a.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=a.ydisp),this.refresh()}}_handleMouseUp(a){let l=a.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&l<500&&a.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let g=this._mouseService.getCoords(a,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(g&&g[0]!==void 0&&g[1]!==void 0){let D=(0,v.moveToCellSequence)(g[0]-1,g[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(D,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let a=this._model.finalSelectionStart,l=this._model.finalSelectionEnd,g=!(!a||!l||a[0]===l[0]&&a[1]===l[1]);g?a&&l&&(this._oldSelectionStart&&this._oldSelectionEnd&&a[0]===this._oldSelectionStart[0]&&a[1]===this._oldSelectionStart[1]&&l[0]===this._oldSelectionEnd[0]&&l[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(a,l,g)):this._oldHasSelection&&this._fireOnSelectionChange(a,l,g)}_fireOnSelectionChange(a,l,g){this._oldSelectionStart=a,this._oldSelectionEnd=l,this._oldHasSelection=g,this._onSelectionChange.fire()}_handleBufferActivate(a){this.clearSelection(),this._trimListener.dispose(),this._trimListener=a.activeBuffer.lines.onTrim(l=>this._handleTrim(l))}_convertViewportColToCharacterIndex(a,l){let g=l;for(let D=0;l>=D;D++){let C=a.loadCell(D,this._workCell).getChars().length;this._workCell.getWidth()===0?g--:C>1&&l!==D&&(g+=C-1)}return g}setSelection(a,l,g){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[a,l],this._model.selectionStartLength=g,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(a){this._isClickInSelection(a)||(this._selectWordAtCursor(a,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(a,l,g=!0,D=!0){if(a[0]>=this._bufferService.cols)return;let C=this._bufferService.buffer,b=C.lines.get(a[1]);if(!b)return;let N=C.translateBufferLineToString(a[1],!1),W=this._convertViewportColToCharacterIndex(b,a[0]),K=W,E=a[0]-W,F=0,I=0,j=0,ie=0;if(N.charAt(W)===" "){for(;W>0&&N.charAt(W-1)===" ";)W--;for(;K<N.length&&N.charAt(K+1)===" ";)K++}else{let ue=a[0],ge=a[0];b.getWidth(ue)===0&&(F++,ue--),b.getWidth(ge)===2&&(I++,ge++);let q=b.getString(ge).length;for(q>1&&(ie+=q-1,K+=q-1);ue>0&&W>0&&!this._isCharWordSeparator(b.loadCell(ue-1,this._workCell));){b.loadCell(ue-1,this._workCell);let V=this._workCell.getChars().length;this._workCell.getWidth()===0?(F++,ue--):V>1&&(j+=V-1,W-=V-1),W--,ue--}for(;ge<b.length&&K+1<N.length&&!this._isCharWordSeparator(b.loadCell(ge+1,this._workCell));){b.loadCell(ge+1,this._workCell);let V=this._workCell.getChars().length;this._workCell.getWidth()===2?(I++,ge++):V>1&&(ie+=V-1,K+=V-1),K++,ge++}}K++;let ee=W+E-F+j,fe=Math.min(this._bufferService.cols,K-W+F+I-j-ie);if(l||N.slice(W,K).trim()!==""){if(g&&ee===0&&b.getCodePoint(0)!==32){let ue=C.lines.get(a[1]-1);if(ue&&b.isWrapped&&ue.getCodePoint(this._bufferService.cols-1)!==32){let ge=this._getWordAt([this._bufferService.cols-1,a[1]-1],!1,!0,!1);if(ge){let q=this._bufferService.cols-ge.start;ee-=q,fe+=q}}}if(D&&ee+fe===this._bufferService.cols&&b.getCodePoint(this._bufferService.cols-1)!==32){let ue=C.lines.get(a[1]+1);if((ue==null?void 0:ue.isWrapped)&&ue.getCodePoint(0)!==32){let ge=this._getWordAt([0,a[1]+1],!1,!1,!0);ge&&(fe+=ge.length)}}return{start:ee,length:fe}}}_selectWordAt(a,l){let g=this._getWordAt(a,l);if(g){for(;g.start<0;)g.start+=this._bufferService.cols,a[1]--;this._model.selectionStart=[g.start,a[1]],this._model.selectionStartLength=g.length}}_selectToWordAt(a){let l=this._getWordAt(a,!0);if(l){let g=a[1];for(;l.start<0;)l.start+=this._bufferService.cols,g--;if(!this._model.areSelectionValuesReversed())for(;l.start+l.length>this._bufferService.cols;)l.length-=this._bufferService.cols,g++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?l.start:l.start+l.length,g]}}_isCharWordSeparator(a){return a.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(a.getChars())>=0}_selectLineAt(a){let l=this._bufferService.buffer.getWrappedRangeForLine(a),g={start:{x:0,y:l.first},end:{x:this._bufferService.cols-1,y:l.last}};this._model.selectionStart=[0,l.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,i.getRangeLength)(g,this._bufferService.cols)}};r=y([w(3,c.IBufferService),w(4,c.ICoreService),w(5,S.IMouseService),w(6,c.IOptionsService),w(7,S.IRenderService),w(8,S.ICoreBrowserService)],r),u.SelectionService=r},4725:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.IThemeService=u.ICharacterJoinerService=u.ISelectionService=u.IRenderService=u.IMouseService=u.ICoreBrowserService=u.ICharSizeService=void 0;let y=_(8343);u.ICharSizeService=(0,y.createDecorator)("CharSizeService"),u.ICoreBrowserService=(0,y.createDecorator)("CoreBrowserService"),u.IMouseService=(0,y.createDecorator)("MouseService"),u.IRenderService=(0,y.createDecorator)("RenderService"),u.ISelectionService=(0,y.createDecorator)("SelectionService"),u.ICharacterJoinerService=(0,y.createDecorator)("CharacterJoinerService"),u.IThemeService=(0,y.createDecorator)("ThemeService")},6731:function(B,u,_){var y=this&&this.__decorate||function(r,a,l,g){var D,C=arguments.length,b=C<3?a:g===null?g=Object.getOwnPropertyDescriptor(a,l):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,a,l,g);else for(var N=r.length-1;N>=0;N--)(D=r[N])&&(b=(C<3?D(b):C>3?D(a,l,b):D(a,l))||b);return C>3&&b&&Object.defineProperty(a,l,b),b},w=this&&this.__param||function(r,a){return function(l,g){a(l,g,r)}};Object.defineProperty(u,"__esModule",{value:!0}),u.ThemeService=u.DEFAULT_ANSI_COLORS=void 0;let R=_(7239),x=_(8055),P=_(8460),A=_(844),S=_(2585),c=x.css.toColor("#ffffff"),p=x.css.toColor("#000000"),v=x.css.toColor("#ffffff"),e=x.css.toColor("#000000"),i={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};u.DEFAULT_ANSI_COLORS=Object.freeze((()=>{let r=[x.css.toColor("#2e3436"),x.css.toColor("#cc0000"),x.css.toColor("#4e9a06"),x.css.toColor("#c4a000"),x.css.toColor("#3465a4"),x.css.toColor("#75507b"),x.css.toColor("#06989a"),x.css.toColor("#d3d7cf"),x.css.toColor("#555753"),x.css.toColor("#ef2929"),x.css.toColor("#8ae234"),x.css.toColor("#fce94f"),x.css.toColor("#729fcf"),x.css.toColor("#ad7fa8"),x.css.toColor("#34e2e2"),x.css.toColor("#eeeeec")],a=[0,95,135,175,215,255];for(let l=0;l<216;l++){let g=a[l/36%6|0],D=a[l/6%6|0],C=a[l%6];r.push({css:x.channels.toCss(g,D,C),rgba:x.channels.toRgba(g,D,C)})}for(let l=0;l<24;l++){let g=8+10*l;r.push({css:x.channels.toCss(g,g,g),rgba:x.channels.toRgba(g,g,g)})}return r})());let t=class extends A.Disposable{constructor(r){super(),this._optionsService=r,this._onChangeColors=this.register(new P.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new R.ColorContrastCache,this._colors={foreground:c,background:p,cursor:v,cursorAccent:e,selectionForeground:void 0,selectionBackgroundTransparent:i,selectionBackgroundOpaque:x.color.blend(p,i),selectionInactiveBackgroundTransparent:i,selectionInactiveBackgroundOpaque:x.color.blend(p,i),ansi:u.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(r={}){let a=this._colors;if(a.foreground=n(r.foreground,c),a.background=n(r.background,p),a.cursor=n(r.cursor,v),a.cursorAccent=n(r.cursorAccent,e),a.selectionBackgroundTransparent=n(r.selectionBackground,i),a.selectionBackgroundOpaque=x.color.blend(a.background,a.selectionBackgroundTransparent),a.selectionInactiveBackgroundTransparent=n(r.selectionInactiveBackground,a.selectionBackgroundTransparent),a.selectionInactiveBackgroundOpaque=x.color.blend(a.background,a.selectionInactiveBackgroundTransparent),a.selectionForeground=r.selectionForeground?n(r.selectionForeground,x.NULL_COLOR):void 0,a.selectionForeground===x.NULL_COLOR&&(a.selectionForeground=void 0),x.color.isOpaque(a.selectionBackgroundTransparent)&&(a.selectionBackgroundTransparent=x.color.opacity(a.selectionBackgroundTransparent,.3)),x.color.isOpaque(a.selectionInactiveBackgroundTransparent)&&(a.selectionInactiveBackgroundTransparent=x.color.opacity(a.selectionInactiveBackgroundTransparent,.3)),a.ansi=u.DEFAULT_ANSI_COLORS.slice(),a.ansi[0]=n(r.black,u.DEFAULT_ANSI_COLORS[0]),a.ansi[1]=n(r.red,u.DEFAULT_ANSI_COLORS[1]),a.ansi[2]=n(r.green,u.DEFAULT_ANSI_COLORS[2]),a.ansi[3]=n(r.yellow,u.DEFAULT_ANSI_COLORS[3]),a.ansi[4]=n(r.blue,u.DEFAULT_ANSI_COLORS[4]),a.ansi[5]=n(r.magenta,u.DEFAULT_ANSI_COLORS[5]),a.ansi[6]=n(r.cyan,u.DEFAULT_ANSI_COLORS[6]),a.ansi[7]=n(r.white,u.DEFAULT_ANSI_COLORS[7]),a.ansi[8]=n(r.brightBlack,u.DEFAULT_ANSI_COLORS[8]),a.ansi[9]=n(r.brightRed,u.DEFAULT_ANSI_COLORS[9]),a.ansi[10]=n(r.brightGreen,u.DEFAULT_ANSI_COLORS[10]),a.ansi[11]=n(r.brightYellow,u.DEFAULT_ANSI_COLORS[11]),a.ansi[12]=n(r.brightBlue,u.DEFAULT_ANSI_COLORS[12]),a.ansi[13]=n(r.brightMagenta,u.DEFAULT_ANSI_COLORS[13]),a.ansi[14]=n(r.brightCyan,u.DEFAULT_ANSI_COLORS[14]),a.ansi[15]=n(r.brightWhite,u.DEFAULT_ANSI_COLORS[15]),r.extendedAnsi){let l=Math.min(a.ansi.length-16,r.extendedAnsi.length);for(let g=0;g<l;g++)a.ansi[g+16]=n(r.extendedAnsi[g],u.DEFAULT_ANSI_COLORS[g+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(r){this._restoreColor(r),this._onChangeColors.fire(this.colors)}_restoreColor(r){if(r!==void 0)switch(r){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[r]=this._restoreColors.ansi[r]}else for(let a=0;a<this._restoreColors.ansi.length;++a)this._colors.ansi[a]=this._restoreColors.ansi[a]}modifyColors(r){r(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function n(r,a){if(r!==void 0)try{return x.css.toColor(r)}catch{}return a}t=y([w(0,S.IOptionsService)],t),u.ThemeService=t},6349:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.CircularList=void 0;let y=_(8460),w=_(844);class R extends w.Disposable{constructor(P){super(),this._maxLength=P,this.onDeleteEmitter=this.register(new y.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new y.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new y.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(P){if(this._maxLength===P)return;let A=new Array(P);for(let S=0;S<Math.min(P,this.length);S++)A[S]=this._array[this._getCyclicIndex(S)];this._array=A,this._maxLength=P,this._startIndex=0}get length(){return this._length}set length(P){if(P>this._length)for(let A=this._length;A<P;A++)this._array[A]=void 0;this._length=P}get(P){return this._array[this._getCyclicIndex(P)]}set(P,A){this._array[this._getCyclicIndex(P)]=A}push(P){this._array[this._getCyclicIndex(this._length)]=P,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(P,A,...S){if(A){for(let c=P;c<this._length-A;c++)this._array[this._getCyclicIndex(c)]=this._array[this._getCyclicIndex(c+A)];this._length-=A,this.onDeleteEmitter.fire({index:P,amount:A})}for(let c=this._length-1;c>=P;c--)this._array[this._getCyclicIndex(c+S.length)]=this._array[this._getCyclicIndex(c)];for(let c=0;c<S.length;c++)this._array[this._getCyclicIndex(P+c)]=S[c];if(S.length&&this.onInsertEmitter.fire({index:P,amount:S.length}),this._length+S.length>this._maxLength){let c=this._length+S.length-this._maxLength;this._startIndex+=c,this._length=this._maxLength,this.onTrimEmitter.fire(c)}else this._length+=S.length}trimStart(P){P>this._length&&(P=this._length),this._startIndex+=P,this._length-=P,this.onTrimEmitter.fire(P)}shiftElements(P,A,S){if(!(A<=0)){if(P<0||P>=this._length)throw new Error("start argument out of range");if(P+S<0)throw new Error("Cannot shift elements in list beyond index 0");if(S>0){for(let p=A-1;p>=0;p--)this.set(P+p+S,this.get(P+p));let c=P+A+S-this._length;if(c>0)for(this._length+=c;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let c=0;c<A;c++)this.set(P+c+S,this.get(P+c))}}_getCyclicIndex(P){return(this._startIndex+P)%this._maxLength}}u.CircularList=R},1439:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.clone=void 0,u.clone=function _(y,w=5){if(typeof y!="object")return y;let R=Array.isArray(y)?[]:{};for(let x in y)R[x]=w<=1?y[x]:y[x]&&_(y[x],w-1);return R}},8055:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.contrastRatio=u.toPaddedHex=u.rgba=u.rgb=u.css=u.color=u.channels=u.NULL_COLOR=void 0;let y=_(6114),w=0,R=0,x=0,P=0;var A,S,c;function p(e){let i=e.toString(16);return i.length<2?"0"+i:i}function v(e,i){return e<i?(i+.05)/(e+.05):(e+.05)/(i+.05)}u.NULL_COLOR={css:"#00000000",rgba:0},function(e){e.toCss=function(i,t,n,r){return r!==void 0?`#${p(i)}${p(t)}${p(n)}${p(r)}`:`#${p(i)}${p(t)}${p(n)}`},e.toRgba=function(i,t,n,r=255){return(i<<24|t<<16|n<<8|r)>>>0}}(A=u.channels||(u.channels={})),function(e){function i(t,n){return P=Math.round(255*n),[w,R,x]=c.toChannels(t.rgba),{css:A.toCss(w,R,x,P),rgba:A.toRgba(w,R,x,P)}}e.blend=function(t,n){if(P=(255&n.rgba)/255,P===1)return{css:n.css,rgba:n.rgba};let r=n.rgba>>24&255,a=n.rgba>>16&255,l=n.rgba>>8&255,g=t.rgba>>24&255,D=t.rgba>>16&255,C=t.rgba>>8&255;return w=g+Math.round((r-g)*P),R=D+Math.round((a-D)*P),x=C+Math.round((l-C)*P),{css:A.toCss(w,R,x),rgba:A.toRgba(w,R,x)}},e.isOpaque=function(t){return(255&t.rgba)==255},e.ensureContrastRatio=function(t,n,r){let a=c.ensureContrastRatio(t.rgba,n.rgba,r);if(a)return c.toColor(a>>24&255,a>>16&255,a>>8&255)},e.opaque=function(t){let n=(255|t.rgba)>>>0;return[w,R,x]=c.toChannels(n),{css:A.toCss(w,R,x),rgba:n}},e.opacity=i,e.multiplyOpacity=function(t,n){return P=255&t.rgba,i(t,P*n/255)},e.toColorRGB=function(t){return[t.rgba>>24&255,t.rgba>>16&255,t.rgba>>8&255]}}(u.color||(u.color={})),function(e){let i,t;if(!y.isNode){let n=document.createElement("canvas");n.width=1,n.height=1;let r=n.getContext("2d",{willReadFrequently:!0});r&&(i=r,i.globalCompositeOperation="copy",t=i.createLinearGradient(0,0,1,1))}e.toColor=function(n){if(n.match(/#[\da-f]{3,8}/i))switch(n.length){case 4:return w=parseInt(n.slice(1,2).repeat(2),16),R=parseInt(n.slice(2,3).repeat(2),16),x=parseInt(n.slice(3,4).repeat(2),16),c.toColor(w,R,x);case 5:return w=parseInt(n.slice(1,2).repeat(2),16),R=parseInt(n.slice(2,3).repeat(2),16),x=parseInt(n.slice(3,4).repeat(2),16),P=parseInt(n.slice(4,5).repeat(2),16),c.toColor(w,R,x,P);case 7:return{css:n,rgba:(parseInt(n.slice(1),16)<<8|255)>>>0};case 9:return{css:n,rgba:parseInt(n.slice(1),16)>>>0}}let r=n.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(r)return w=parseInt(r[1]),R=parseInt(r[2]),x=parseInt(r[3]),P=Math.round(255*(r[5]===void 0?1:parseFloat(r[5]))),c.toColor(w,R,x,P);if(!i||!t)throw new Error("css.toColor: Unsupported css format");if(i.fillStyle=t,i.fillStyle=n,typeof i.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(i.fillRect(0,0,1,1),[w,R,x,P]=i.getImageData(0,0,1,1).data,P!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:A.toRgba(w,R,x,P),css:n}}}(u.css||(u.css={})),function(e){function i(t,n,r){let a=t/255,l=n/255,g=r/255;return .2126*(a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4))+.7152*(l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4))+.0722*(g<=.03928?g/12.92:Math.pow((g+.055)/1.055,2.4))}e.relativeLuminance=function(t){return i(t>>16&255,t>>8&255,255&t)},e.relativeLuminance2=i}(S=u.rgb||(u.rgb={})),function(e){function i(n,r,a){let l=n>>24&255,g=n>>16&255,D=n>>8&255,C=r>>24&255,b=r>>16&255,N=r>>8&255,W=v(S.relativeLuminance2(C,b,N),S.relativeLuminance2(l,g,D));for(;W<a&&(C>0||b>0||N>0);)C-=Math.max(0,Math.ceil(.1*C)),b-=Math.max(0,Math.ceil(.1*b)),N-=Math.max(0,Math.ceil(.1*N)),W=v(S.relativeLuminance2(C,b,N),S.relativeLuminance2(l,g,D));return(C<<24|b<<16|N<<8|255)>>>0}function t(n,r,a){let l=n>>24&255,g=n>>16&255,D=n>>8&255,C=r>>24&255,b=r>>16&255,N=r>>8&255,W=v(S.relativeLuminance2(C,b,N),S.relativeLuminance2(l,g,D));for(;W<a&&(C<255||b<255||N<255);)C=Math.min(255,C+Math.ceil(.1*(255-C))),b=Math.min(255,b+Math.ceil(.1*(255-b))),N=Math.min(255,N+Math.ceil(.1*(255-N))),W=v(S.relativeLuminance2(C,b,N),S.relativeLuminance2(l,g,D));return(C<<24|b<<16|N<<8|255)>>>0}e.ensureContrastRatio=function(n,r,a){let l=S.relativeLuminance(n>>8),g=S.relativeLuminance(r>>8);if(v(l,g)<a){if(g<l){let b=i(n,r,a),N=v(l,S.relativeLuminance(b>>8));if(N<a){let W=t(n,r,a);return N>v(l,S.relativeLuminance(W>>8))?b:W}return b}let D=t(n,r,a),C=v(l,S.relativeLuminance(D>>8));if(C<a){let b=i(n,r,a);return C>v(l,S.relativeLuminance(b>>8))?D:b}return D}},e.reduceLuminance=i,e.increaseLuminance=t,e.toChannels=function(n){return[n>>24&255,n>>16&255,n>>8&255,255&n]},e.toColor=function(n,r,a,l){return{css:A.toCss(n,r,a,l),rgba:A.toRgba(n,r,a,l)}}}(c=u.rgba||(u.rgba={})),u.toPaddedHex=p,u.contrastRatio=v},8969:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.CoreTerminal=void 0;let y=_(844),w=_(2585),R=_(4348),x=_(7866),P=_(744),A=_(7302),S=_(6975),c=_(8460),p=_(1753),v=_(1480),e=_(7994),i=_(9282),t=_(5435),n=_(5981),r=_(2660),a=!1;class l extends y.Disposable{constructor(D){super(),this._onBinary=this.register(new c.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new c.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new c.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new c.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new c.EventEmitter),this._instantiationService=new R.InstantiationService,this.optionsService=this.register(new A.OptionsService(D)),this._instantiationService.setService(w.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(P.BufferService)),this._instantiationService.setService(w.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(x.LogService)),this._instantiationService.setService(w.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(S.CoreService)),this._instantiationService.setService(w.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(p.CoreMouseService)),this._instantiationService.setService(w.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(v.UnicodeService)),this._instantiationService.setService(w.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(e.CharsetService),this._instantiationService.setService(w.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(r.OscLinkService),this._instantiationService.setService(w.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new t.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,c.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,c.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,c.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,c.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",C=>this._handleWindowsModeOptionChange(C))),this.register(this._bufferService.onScroll(C=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(C=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new n.WriteBuffer((C,b)=>this._inputHandler.parse(C,b))),this.register((0,c.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,y.toDisposable)(()=>{var C;(C=this._windowsMode)===null||C===void 0||C.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new c.EventEmitter),this._onScroll.event(D=>{var C;(C=this._onScrollApi)===null||C===void 0||C.fire(D.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(D){for(let C in D)this.optionsService.options[C]=D[C]}write(D,C){this._writeBuffer.write(D,C)}writeSync(D,C){this._logService.logLevel<=w.LogLevelEnum.WARN&&!a&&(this._logService.warn("writeSync is unreliable and will be removed soon."),a=!0),this._writeBuffer.writeSync(D,C)}resize(D,C){isNaN(D)||isNaN(C)||(D=Math.max(D,P.MINIMUM_COLS),C=Math.max(C,P.MINIMUM_ROWS),this._bufferService.resize(D,C))}scroll(D,C=!1){this._bufferService.scroll(D,C)}scrollLines(D,C,b){this._bufferService.scrollLines(D,C,b)}scrollPages(D){this._bufferService.scrollPages(D)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(D){this._bufferService.scrollToLine(D)}registerEscHandler(D,C){return this._inputHandler.registerEscHandler(D,C)}registerDcsHandler(D,C){return this._inputHandler.registerDcsHandler(D,C)}registerCsiHandler(D,C){return this._inputHandler.registerCsiHandler(D,C)}registerOscHandler(D,C){return this._inputHandler.registerOscHandler(D,C)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(D){var C;D?this._enableWindowsMode():((C=this._windowsMode)===null||C===void 0||C.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){let D=[];D.push(this.onLineFeed(i.updateWindowsModeWrappedState.bind(null,this._bufferService))),D.push(this.registerCsiHandler({final:"H"},()=>((0,i.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsMode={dispose:()=>{for(let C of D)C.dispose()}}}}}u.CoreTerminal=l},8460:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.forwardEvent=u.EventEmitter=void 0,u.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=_=>(this._listeners.push(_),{dispose:()=>{if(!this._disposed){for(let y=0;y<this._listeners.length;y++)if(this._listeners[y]===_)return void this._listeners.splice(y,1)}}})),this._event}fire(_,y){let w=[];for(let R=0;R<this._listeners.length;R++)w.push(this._listeners[R]);for(let R=0;R<w.length;R++)w[R].call(void 0,_,y)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},u.forwardEvent=function(_,y){return _(w=>y.fire(w))}},5435:function(B,u,_){var y=this&&this.__decorate||function(K,E,F,I){var j,ie=arguments.length,ee=ie<3?E:I===null?I=Object.getOwnPropertyDescriptor(E,F):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ee=Reflect.decorate(K,E,F,I);else for(var fe=K.length-1;fe>=0;fe--)(j=K[fe])&&(ee=(ie<3?j(ee):ie>3?j(E,F,ee):j(E,F))||ee);return ie>3&&ee&&Object.defineProperty(E,F,ee),ee},w=this&&this.__param||function(K,E){return function(F,I){E(F,I,K)}};Object.defineProperty(u,"__esModule",{value:!0}),u.InputHandler=u.WindowsOptionsReportType=void 0;let R=_(2584),x=_(7116),P=_(2015),A=_(844),S=_(482),c=_(8437),p=_(8460),v=_(643),e=_(511),i=_(3734),t=_(2585),n=_(6242),r=_(6351),a=_(5941),l={"(":0,")":1,"*":2,"+":3,"-":1,".":2},g=131072;function D(K,E){if(K>24)return E.setWinLines||!1;switch(K){case 1:return!!E.restoreWin;case 2:return!!E.minimizeWin;case 3:return!!E.setWinPosition;case 4:return!!E.setWinSizePixels;case 5:return!!E.raiseWin;case 6:return!!E.lowerWin;case 7:return!!E.refreshWin;case 8:return!!E.setWinSizeChars;case 9:return!!E.maximizeWin;case 10:return!!E.fullscreenWin;case 11:return!!E.getWinState;case 13:return!!E.getWinPosition;case 14:return!!E.getWinSizePixels;case 15:return!!E.getScreenSizePixels;case 16:return!!E.getCellSizePixels;case 18:return!!E.getWinSizeChars;case 19:return!!E.getScreenSizeChars;case 20:return!!E.getIconTitle;case 21:return!!E.getWinTitle;case 22:return!!E.pushTitle;case 23:return!!E.popTitle;case 24:return!!E.setWinLines}return!1}var C;(function(K){K[K.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",K[K.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(C=u.WindowsOptionsReportType||(u.WindowsOptionsReportType={}));let b=0;class N extends A.Disposable{constructor(E,F,I,j,ie,ee,fe,ue,ge=new P.EscapeSequenceParser){super(),this._bufferService=E,this._charsetService=F,this._coreService=I,this._logService=j,this._optionsService=ie,this._oscLinkService=ee,this._coreMouseService=fe,this._unicodeService=ue,this._parser=ge,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new S.StringToUtf32,this._utf8Decoder=new S.Utf8ToUtf32,this._workCell=new e.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=c.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new p.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new p.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new p.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new p.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new p.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new p.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new p.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new p.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new p.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new p.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new p.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new p.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new p.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new W(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(q=>this._activeBuffer=q.activeBuffer)),this._parser.setCsiHandlerFallback((q,V)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(q),params:V.toArray()})}),this._parser.setEscHandlerFallback(q=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(q)})}),this._parser.setExecuteHandlerFallback(q=>{this._logService.debug("Unknown EXECUTE code: ",{code:q})}),this._parser.setOscHandlerFallback((q,V,G)=>{this._logService.debug("Unknown OSC code: ",{identifier:q,action:V,data:G})}),this._parser.setDcsHandlerFallback((q,V,G)=>{V==="HOOK"&&(G=G.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(q),action:V,payload:G})}),this._parser.setPrintHandler((q,V,G)=>this.print(q,V,G)),this._parser.registerCsiHandler({final:"@"},q=>this.insertChars(q)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},q=>this.scrollLeft(q)),this._parser.registerCsiHandler({final:"A"},q=>this.cursorUp(q)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},q=>this.scrollRight(q)),this._parser.registerCsiHandler({final:"B"},q=>this.cursorDown(q)),this._parser.registerCsiHandler({final:"C"},q=>this.cursorForward(q)),this._parser.registerCsiHandler({final:"D"},q=>this.cursorBackward(q)),this._parser.registerCsiHandler({final:"E"},q=>this.cursorNextLine(q)),this._parser.registerCsiHandler({final:"F"},q=>this.cursorPrecedingLine(q)),this._parser.registerCsiHandler({final:"G"},q=>this.cursorCharAbsolute(q)),this._parser.registerCsiHandler({final:"H"},q=>this.cursorPosition(q)),this._parser.registerCsiHandler({final:"I"},q=>this.cursorForwardTab(q)),this._parser.registerCsiHandler({final:"J"},q=>this.eraseInDisplay(q,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},q=>this.eraseInDisplay(q,!0)),this._parser.registerCsiHandler({final:"K"},q=>this.eraseInLine(q,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},q=>this.eraseInLine(q,!0)),this._parser.registerCsiHandler({final:"L"},q=>this.insertLines(q)),this._parser.registerCsiHandler({final:"M"},q=>this.deleteLines(q)),this._parser.registerCsiHandler({final:"P"},q=>this.deleteChars(q)),this._parser.registerCsiHandler({final:"S"},q=>this.scrollUp(q)),this._parser.registerCsiHandler({final:"T"},q=>this.scrollDown(q)),this._parser.registerCsiHandler({final:"X"},q=>this.eraseChars(q)),this._parser.registerCsiHandler({final:"Z"},q=>this.cursorBackwardTab(q)),this._parser.registerCsiHandler({final:"`"},q=>this.charPosAbsolute(q)),this._parser.registerCsiHandler({final:"a"},q=>this.hPositionRelative(q)),this._parser.registerCsiHandler({final:"b"},q=>this.repeatPrecedingCharacter(q)),this._parser.registerCsiHandler({final:"c"},q=>this.sendDeviceAttributesPrimary(q)),this._parser.registerCsiHandler({prefix:">",final:"c"},q=>this.sendDeviceAttributesSecondary(q)),this._parser.registerCsiHandler({final:"d"},q=>this.linePosAbsolute(q)),this._parser.registerCsiHandler({final:"e"},q=>this.vPositionRelative(q)),this._parser.registerCsiHandler({final:"f"},q=>this.hVPosition(q)),this._parser.registerCsiHandler({final:"g"},q=>this.tabClear(q)),this._parser.registerCsiHandler({final:"h"},q=>this.setMode(q)),this._parser.registerCsiHandler({prefix:"?",final:"h"},q=>this.setModePrivate(q)),this._parser.registerCsiHandler({final:"l"},q=>this.resetMode(q)),this._parser.registerCsiHandler({prefix:"?",final:"l"},q=>this.resetModePrivate(q)),this._parser.registerCsiHandler({final:"m"},q=>this.charAttributes(q)),this._parser.registerCsiHandler({final:"n"},q=>this.deviceStatus(q)),this._parser.registerCsiHandler({prefix:"?",final:"n"},q=>this.deviceStatusPrivate(q)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},q=>this.softReset(q)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},q=>this.setCursorStyle(q)),this._parser.registerCsiHandler({final:"r"},q=>this.setScrollRegion(q)),this._parser.registerCsiHandler({final:"s"},q=>this.saveCursor(q)),this._parser.registerCsiHandler({final:"t"},q=>this.windowOptions(q)),this._parser.registerCsiHandler({final:"u"},q=>this.restoreCursor(q)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},q=>this.insertColumns(q)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},q=>this.deleteColumns(q)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},q=>this.selectProtected(q)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},q=>this.requestMode(q,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},q=>this.requestMode(q,!1)),this._parser.setExecuteHandler(R.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(R.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(R.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(R.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(R.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(R.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(R.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(R.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(R.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(R.C1.IND,()=>this.index()),this._parser.setExecuteHandler(R.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(R.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new n.OscHandler(q=>(this.setTitle(q),this.setIconName(q),!0))),this._parser.registerOscHandler(1,new n.OscHandler(q=>this.setIconName(q))),this._parser.registerOscHandler(2,new n.OscHandler(q=>this.setTitle(q))),this._parser.registerOscHandler(4,new n.OscHandler(q=>this.setOrReportIndexedColor(q))),this._parser.registerOscHandler(8,new n.OscHandler(q=>this.setHyperlink(q))),this._parser.registerOscHandler(10,new n.OscHandler(q=>this.setOrReportFgColor(q))),this._parser.registerOscHandler(11,new n.OscHandler(q=>this.setOrReportBgColor(q))),this._parser.registerOscHandler(12,new n.OscHandler(q=>this.setOrReportCursorColor(q))),this._parser.registerOscHandler(104,new n.OscHandler(q=>this.restoreIndexedColor(q))),this._parser.registerOscHandler(110,new n.OscHandler(q=>this.restoreFgColor(q))),this._parser.registerOscHandler(111,new n.OscHandler(q=>this.restoreBgColor(q))),this._parser.registerOscHandler(112,new n.OscHandler(q=>this.restoreCursorColor(q))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let q in x.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:q},()=>this.selectCharset("("+q)),this._parser.registerEscHandler({intermediates:")",final:q},()=>this.selectCharset(")"+q)),this._parser.registerEscHandler({intermediates:"*",final:q},()=>this.selectCharset("*"+q)),this._parser.registerEscHandler({intermediates:"+",final:q},()=>this.selectCharset("+"+q)),this._parser.registerEscHandler({intermediates:"-",final:q},()=>this.selectCharset("-"+q)),this._parser.registerEscHandler({intermediates:".",final:q},()=>this.selectCharset("."+q)),this._parser.registerEscHandler({intermediates:"/",final:q},()=>this.selectCharset("/"+q));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(q=>(this._logService.error("Parsing error: ",q),q)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new r.DcsHandler((q,V)=>this.requestStatusString(q,V)))}getAttrData(){return this._curAttrData}_preserveStack(E,F,I,j){this._parseStack.paused=!0,this._parseStack.cursorStartX=E,this._parseStack.cursorStartY=F,this._parseStack.decodedLength=I,this._parseStack.position=j}_logSlowResolvingAsync(E){this._logService.logLevel<=t.LogLevelEnum.WARN&&Promise.race([E,new Promise((F,I)=>setTimeout(()=>I("#SLOW_TIMEOUT"),5e3))]).catch(F=>{if(F!=="#SLOW_TIMEOUT")throw F;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(E,F){let I,j=this._activeBuffer.x,ie=this._activeBuffer.y,ee=0,fe=this._parseStack.paused;if(fe){if(I=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,F))return this._logSlowResolvingAsync(I),I;j=this._parseStack.cursorStartX,ie=this._parseStack.cursorStartY,this._parseStack.paused=!1,E.length>g&&(ee=this._parseStack.position+g)}if(this._logService.logLevel<=t.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof E=="string"?` "${E}"`:` "${Array.prototype.map.call(E,ue=>String.fromCharCode(ue)).join("")}"`),typeof E=="string"?E.split("").map(ue=>ue.charCodeAt(0)):E),this._parseBuffer.length<E.length&&this._parseBuffer.length<g&&(this._parseBuffer=new Uint32Array(Math.min(E.length,g))),fe||this._dirtyRowTracker.clearRange(),E.length>g)for(let ue=ee;ue<E.length;ue+=g){let ge=ue+g<E.length?ue+g:E.length,q=typeof E=="string"?this._stringDecoder.decode(E.substring(ue,ge),this._parseBuffer):this._utf8Decoder.decode(E.subarray(ue,ge),this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,q))return this._preserveStack(j,ie,q,ue),this._logSlowResolvingAsync(I),I}else if(!fe){let ue=typeof E=="string"?this._stringDecoder.decode(E,this._parseBuffer):this._utf8Decoder.decode(E,this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,ue))return this._preserveStack(j,ie,ue,0),this._logSlowResolvingAsync(I),I}this._activeBuffer.x===j&&this._activeBuffer.y===ie||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(E,F,I){let j,ie,ee=this._charsetService.charset,fe=this._optionsService.rawOptions.screenReaderMode,ue=this._bufferService.cols,ge=this._coreService.decPrivateModes.wraparound,q=this._coreService.modes.insertMode,V=this._curAttrData,G=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&I-F>0&&G.getWidth(this._activeBuffer.x-1)===2&&G.setCellFromCodePoint(this._activeBuffer.x-1,0,1,V.fg,V.bg,V.extended);for(let ae=F;ae<I;++ae){if(j=E[ae],ie=this._unicodeService.wcwidth(j),j<127&&ee){let de=ee[String.fromCharCode(j)];de&&(j=de.charCodeAt(0))}if(fe&&this._onA11yChar.fire((0,S.stringFromCodePoint)(j)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),ie||!this._activeBuffer.x){if(this._activeBuffer.x+ie-1>=ue){if(ge){for(;this._activeBuffer.x<ue;)G.setCellFromCodePoint(this._activeBuffer.x++,0,1,V.fg,V.bg,V.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),G=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=ue-1,ie===2)continue}if(q&&(G.insertCells(this._activeBuffer.x,ie,this._activeBuffer.getNullCell(V),V),G.getWidth(ue-1)===2&&G.setCellFromCodePoint(ue-1,v.NULL_CELL_CODE,v.NULL_CELL_WIDTH,V.fg,V.bg,V.extended)),G.setCellFromCodePoint(this._activeBuffer.x++,j,ie,V.fg,V.bg,V.extended),ie>0)for(;--ie;)G.setCellFromCodePoint(this._activeBuffer.x++,0,0,V.fg,V.bg,V.extended)}else G.getWidth(this._activeBuffer.x-1)?G.addCodepointToCell(this._activeBuffer.x-1,j):G.addCodepointToCell(this._activeBuffer.x-2,j)}I-F>0&&(G.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<ue&&I-F>0&&G.getWidth(this._activeBuffer.x)===0&&!G.hasContent(this._activeBuffer.x)&&G.setCellFromCodePoint(this._activeBuffer.x,0,1,V.fg,V.bg,V.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(E,F){return E.final!=="t"||E.prefix||E.intermediates?this._parser.registerCsiHandler(E,F):this._parser.registerCsiHandler(E,I=>!D(I.params[0],this._optionsService.rawOptions.windowOptions)||F(I))}registerDcsHandler(E,F){return this._parser.registerDcsHandler(E,new r.DcsHandler(F))}registerEscHandler(E,F){return this._parser.registerEscHandler(E,F)}registerOscHandler(E,F){return this._parser.registerOscHandler(E,new n.OscHandler(F))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var E;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||E===void 0?void 0:E.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);F.hasWidth(this._activeBuffer.x)&&!F.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-E),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(E=this._bufferService.cols-1){this._activeBuffer.x=Math.min(E,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(E,F){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=E,this._activeBuffer.y=this._activeBuffer.scrollTop+F):(this._activeBuffer.x=E,this._activeBuffer.y=F),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(E,F){this._restrictCursor(),this._setCursor(this._activeBuffer.x+E,this._activeBuffer.y+F)}cursorUp(E){let F=this._activeBuffer.y-this._activeBuffer.scrollTop;return F>=0?this._moveCursor(0,-Math.min(F,E.params[0]||1)):this._moveCursor(0,-(E.params[0]||1)),!0}cursorDown(E){let F=this._activeBuffer.scrollBottom-this._activeBuffer.y;return F>=0?this._moveCursor(0,Math.min(F,E.params[0]||1)):this._moveCursor(0,E.params[0]||1),!0}cursorForward(E){return this._moveCursor(E.params[0]||1,0),!0}cursorBackward(E){return this._moveCursor(-(E.params[0]||1),0),!0}cursorNextLine(E){return this.cursorDown(E),this._activeBuffer.x=0,!0}cursorPrecedingLine(E){return this.cursorUp(E),this._activeBuffer.x=0,!0}cursorCharAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(E){return this._setCursor(E.length>=2?(E.params[1]||1)-1:0,(E.params[0]||1)-1),!0}charPosAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(E){return this._moveCursor(E.params[0]||1,0),!0}linePosAbsolute(E){return this._setCursor(this._activeBuffer.x,(E.params[0]||1)-1),!0}vPositionRelative(E){return this._moveCursor(0,E.params[0]||1),!0}hVPosition(E){return this.cursorPosition(E),!0}tabClear(E){let F=E.params[0];return F===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:F===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let F=E.params[0]||1;for(;F--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let F=E.params[0]||1;for(;F--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(E){let F=E.params[0];return F===1&&(this._curAttrData.bg|=536870912),F!==2&&F!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(E,F,I,j=!1,ie=!1){let ee=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);ee.replaceCells(F,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),ie),j&&(ee.isWrapped=!1)}_resetBufferLine(E,F=!1){let I=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);I.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),F),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+E),I.isWrapped=!1}eraseInDisplay(E,F=!1){let I;switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,F);I<this._bufferService.rows;I++)this._resetBufferLine(I,F);this._dirtyRowTracker.markDirty(I);break;case 1:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I,0,this._activeBuffer.x+1,!0,F),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(I+1).isWrapped=!1);I--;)this._resetBufferLine(I,F);this._dirtyRowTracker.markDirty(0);break;case 2:for(I=this._bufferService.rows,this._dirtyRowTracker.markDirty(I-1);I--;)this._resetBufferLine(I,F);this._dirtyRowTracker.markDirty(0);break;case 3:let j=this._activeBuffer.lines.length-this._bufferService.rows;j>0&&(this._activeBuffer.lines.trimStart(j),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-j,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-j,0),this._onScroll.fire(0))}return!0}eraseInLine(E,F=!1){switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,F);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,F);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,F)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(E){this._restrictCursor();let F=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let I=this._activeBuffer.ybase+this._activeBuffer.y,j=this._bufferService.rows-1-this._activeBuffer.scrollBottom,ie=this._bufferService.rows-1+this._activeBuffer.ybase-j+1;for(;F--;)this._activeBuffer.lines.splice(ie-1,1),this._activeBuffer.lines.splice(I,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(E){this._restrictCursor();let F=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let I=this._activeBuffer.ybase+this._activeBuffer.y,j;for(j=this._bufferService.rows-1-this._activeBuffer.scrollBottom,j=this._bufferService.rows-1+this._activeBuffer.ybase-j;F--;)this._activeBuffer.lines.splice(I,1),this._activeBuffer.lines.splice(j,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(E){this._restrictCursor();let F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.insertCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(E){this._restrictCursor();let F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.deleteCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(E){let F=E.params[0]||1;for(;F--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(E){let F=E.params[0]||1;for(;F--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(c.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let F=E.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){let j=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);j.deleteCells(0,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),j.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let F=E.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){let j=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);j.insertCells(0,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),j.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let F=E.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){let j=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);j.insertCells(this._activeBuffer.x,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),j.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let F=E.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){let j=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);j.deleteCells(this._activeBuffer.x,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),j.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(E){this._restrictCursor();let F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(E.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(E){if(!this._parser.precedingCodepoint)return!0;let F=E.params[0]||1,I=new Uint32Array(F);for(let j=0;j<F;++j)I[j]=this._parser.precedingCodepoint;return this.print(I,0,I.length),!0}sendDeviceAttributesPrimary(E){return E.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(R.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(R.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(E){return E.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(R.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(R.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(E.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(R.C0.ESC+"[>83;40003;0c")),!0}_is(E){return(this._optionsService.rawOptions.termName+"").indexOf(E)===0}setMode(E){for(let F=0;F<E.length;F++)switch(E.params[F]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(E){for(let F=0;F<E.length;F++)switch(E.params[F]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,x.DEFAULT_CHARSET),this._charsetService.setgCharset(1,x.DEFAULT_CHARSET),this._charsetService.setgCharset(2,x.DEFAULT_CHARSET),this._charsetService.setgCharset(3,x.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(E){for(let F=0;F<E.length;F++)switch(E.params[F]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(E){for(let F=0;F<E.length;F++)switch(E.params[F]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),E.params[F]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(E,F){let I=this._coreService.decPrivateModes,{activeProtocol:j,activeEncoding:ie}=this._coreMouseService,ee=this._coreService,{buffers:fe,cols:ue}=this._bufferService,{active:ge,alt:q}=fe,V=this._optionsService.rawOptions,G=_e=>_e?1:2,ae=E.params[0];return de=ae,ne=F?ae===2?3:ae===4?G(ee.modes.insertMode):ae===12?4:ae===20?G(V.convertEol):0:ae===1?G(I.applicationCursorKeys):ae===3?V.windowOptions.setWinLines?ue===80?2:ue===132?1:0:0:ae===6?G(I.origin):ae===7?G(I.wraparound):ae===8?3:ae===9?G(j==="X10"):ae===12?G(V.cursorBlink):ae===25?G(!ee.isCursorHidden):ae===45?G(I.reverseWraparound):ae===66?G(I.applicationKeypad):ae===1e3?G(j==="VT200"):ae===1002?G(j==="DRAG"):ae===1003?G(j==="ANY"):ae===1004?G(I.sendFocus):ae===1005?4:ae===1006?G(ie==="SGR"):ae===1015?4:ae===1016?G(ie==="SGR_PIXELS"):ae===1048?1:ae===47||ae===1047||ae===1049?G(ge===q):ae===2004?G(I.bracketedPasteMode):0,ee.triggerDataEvent(`${R.C0.ESC}[${F?"":"?"}${de};${ne}$y`),!0;var de,ne}_updateAttrColor(E,F,I,j,ie){return F===2?(E|=50331648,E&=-16777216,E|=i.AttributeData.fromColorRGB([I,j,ie])):F===5&&(E&=-50331904,E|=33554432|255&I),E}_extractColor(E,F,I){let j=[0,0,-1,0,0,0],ie=0,ee=0;do{if(j[ee+ie]=E.params[F+ee],E.hasSubParams(F+ee)){let fe=E.getSubParams(F+ee),ue=0;do j[1]===5&&(ie=1),j[ee+ue+1+ie]=fe[ue];while(++ue<fe.length&&ue+ee+1+ie<j.length);break}if(j[1]===5&&ee+ie>=2||j[1]===2&&ee+ie>=5)break;j[1]&&(ie=1)}while(++ee+F<E.length&&ee+ie<j.length);for(let fe=2;fe<j.length;++fe)j[fe]===-1&&(j[fe]=0);switch(j[0]){case 38:I.fg=this._updateAttrColor(I.fg,j[1],j[3],j[4],j[5]);break;case 48:I.bg=this._updateAttrColor(I.bg,j[1],j[3],j[4],j[5]);break;case 58:I.extended=I.extended.clone(),I.extended.underlineColor=this._updateAttrColor(I.extended.underlineColor,j[1],j[3],j[4],j[5])}return ee}_processUnderline(E,F){F.extended=F.extended.clone(),(!~E||E>5)&&(E=1),F.extended.underlineStyle=E,F.fg|=268435456,E===0&&(F.fg&=-268435457),F.updateExtended()}_processSGR0(E){E.fg=c.DEFAULT_ATTR_DATA.fg,E.bg=c.DEFAULT_ATTR_DATA.bg,E.extended=E.extended.clone(),E.extended.underlineStyle=0,E.extended.underlineColor&=-67108864,E.updateExtended()}charAttributes(E){if(E.length===1&&E.params[0]===0)return this._processSGR0(this._curAttrData),!0;let F=E.length,I,j=this._curAttrData;for(let ie=0;ie<F;ie++)I=E.params[ie],I>=30&&I<=37?(j.fg&=-50331904,j.fg|=16777216|I-30):I>=40&&I<=47?(j.bg&=-50331904,j.bg|=16777216|I-40):I>=90&&I<=97?(j.fg&=-50331904,j.fg|=16777224|I-90):I>=100&&I<=107?(j.bg&=-50331904,j.bg|=16777224|I-100):I===0?this._processSGR0(j):I===1?j.fg|=134217728:I===3?j.bg|=67108864:I===4?(j.fg|=268435456,this._processUnderline(E.hasSubParams(ie)?E.getSubParams(ie)[0]:1,j)):I===5?j.fg|=536870912:I===7?j.fg|=67108864:I===8?j.fg|=1073741824:I===9?j.fg|=2147483648:I===2?j.bg|=134217728:I===21?this._processUnderline(2,j):I===22?(j.fg&=-134217729,j.bg&=-134217729):I===23?j.bg&=-67108865:I===24?(j.fg&=-268435457,this._processUnderline(0,j)):I===25?j.fg&=-536870913:I===27?j.fg&=-67108865:I===28?j.fg&=-1073741825:I===29?j.fg&=2147483647:I===39?(j.fg&=-67108864,j.fg|=16777215&c.DEFAULT_ATTR_DATA.fg):I===49?(j.bg&=-67108864,j.bg|=16777215&c.DEFAULT_ATTR_DATA.bg):I===38||I===48||I===58?ie+=this._extractColor(E,ie,j):I===59?(j.extended=j.extended.clone(),j.extended.underlineColor=-1,j.updateExtended()):I===100?(j.fg&=-67108864,j.fg|=16777215&c.DEFAULT_ATTR_DATA.fg,j.bg&=-67108864,j.bg|=16777215&c.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",I);return!0}deviceStatus(E){switch(E.params[0]){case 5:this._coreService.triggerDataEvent(`${R.C0.ESC}[0n`);break;case 6:let F=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${R.C0.ESC}[${F};${I}R`)}return!0}deviceStatusPrivate(E){if(E.params[0]===6){let F=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${R.C0.ESC}[?${F};${I}R`)}return!0}softReset(E){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(E){let F=E.params[0]||1;switch(F){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}let I=F%2==1;return this._optionsService.options.cursorBlink=I,!0}setScrollRegion(E){let F=E.params[0]||1,I;return(E.length<2||(I=E.params[1])>this._bufferService.rows||I===0)&&(I=this._bufferService.rows),I>F&&(this._activeBuffer.scrollTop=F-1,this._activeBuffer.scrollBottom=I-1,this._setCursor(0,0)),!0}windowOptions(E){if(!D(E.params[0],this._optionsService.rawOptions.windowOptions))return!0;let F=E.length>1?E.params[1]:0;switch(E.params[0]){case 14:F!==2&&this._onRequestWindowsOptionsReport.fire(C.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(C.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${R.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:F!==0&&F!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),F!==0&&F!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:F!==0&&F!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),F!==0&&F!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(E){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(E){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(E){return this._windowTitle=E,this._onTitleChange.fire(E),!0}setIconName(E){return this._iconName=E,!0}setOrReportIndexedColor(E){let F=[],I=E.split(";");for(;I.length>1;){let j=I.shift(),ie=I.shift();if(/^\d+$/.exec(j)){let ee=parseInt(j);if(0<=ee&&ee<256)if(ie==="?")F.push({type:0,index:ee});else{let fe=(0,a.parseColor)(ie);fe&&F.push({type:1,index:ee,color:fe})}}}return F.length&&this._onColor.fire(F),!0}setHyperlink(E){let F=E.split(";");return!(F.length<2)&&(F[1]?this._createHyperlink(F[0],F[1]):!F[0]&&this._finishHyperlink())}_createHyperlink(E,F){this._getCurrentLinkId()&&this._finishHyperlink();let I=E.split(":"),j,ie=I.findIndex(ee=>ee.startsWith("id="));return ie!==-1&&(j=I[ie].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:j,uri:F}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(E,F){let I=E.split(";");for(let j=0;j<I.length&&!(F>=this._specialColors.length);++j,++F)if(I[j]==="?")this._onColor.fire([{type:0,index:this._specialColors[F]}]);else{let ie=(0,a.parseColor)(I[j]);ie&&this._onColor.fire([{type:1,index:this._specialColors[F],color:ie}])}return!0}setOrReportFgColor(E){return this._setOrReportSpecialColor(E,0)}setOrReportBgColor(E){return this._setOrReportSpecialColor(E,1)}setOrReportCursorColor(E){return this._setOrReportSpecialColor(E,2)}restoreIndexedColor(E){if(!E)return this._onColor.fire([{type:2}]),!0;let F=[],I=E.split(";");for(let j=0;j<I.length;++j)if(/^\d+$/.exec(I[j])){let ie=parseInt(I[j]);0<=ie&&ie<256&&F.push({type:2,index:ie})}return F.length&&this._onColor.fire(F),!0}restoreFgColor(E){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(E){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(E){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,x.DEFAULT_CHARSET),!0}selectCharset(E){return E.length!==2?(this.selectDefaultCharset(),!0):(E[0]==="/"||this._charsetService.setgCharset(l[E[0]],x.CHARSETS[E[1]]||x.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let E=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,E,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=c.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=c.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(E){return this._charsetService.setgLevel(E),!0}screenAlignmentPattern(){let E=new e.CellData;E.content=4194304|"E".charCodeAt(0),E.fg=this._curAttrData.fg,E.bg=this._curAttrData.bg,this._setCursor(0,0);for(let F=0;F<this._bufferService.rows;++F){let I=this._activeBuffer.ybase+this._activeBuffer.y+F,j=this._activeBuffer.lines.get(I);j&&(j.fill(E),j.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(E,F){let I=this._bufferService.buffer,j=this._optionsService.rawOptions;return(ie=>(this._coreService.triggerDataEvent(`${R.C0.ESC}${ie}${R.C0.ESC}\\`),!0))(E==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:E==='"p'?'P1$r61;1"p':E==="r"?`P1$r${I.scrollTop+1};${I.scrollBottom+1}r`:E==="m"?"P1$r0m":E===" q"?`P1$r${{block:2,underline:4,bar:6}[j.cursorStyle]-(j.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(E,F){this._dirtyRowTracker.markRangeDirty(E,F)}}u.InputHandler=N;let W=class{constructor(K){this._bufferService=K,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(K){K<this.start?this.start=K:K>this.end&&(this.end=K)}markRangeDirty(K,E){K>E&&(b=K,K=E,E=b),K<this.start&&(this.start=K),E>this.end&&(this.end=E)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};W=y([w(0,t.IBufferService)],W)},844:(B,u)=>{function _(y){for(let w of y)w.dispose();y.length=0}Object.defineProperty(u,"__esModule",{value:!0}),u.getDisposeArrayDisposable=u.disposeArray=u.toDisposable=u.Disposable=void 0,u.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let y of this._disposables)y.dispose();this._disposables.length=0}register(y){return this._disposables.push(y),y}unregister(y){let w=this._disposables.indexOf(y);w!==-1&&this._disposables.splice(w,1)}},u.toDisposable=function(y){return{dispose:y}},u.disposeArray=_,u.getDisposeArrayDisposable=function(y){return{dispose:()=>_(y)}}},1505:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.FourKeyMap=u.TwoKeyMap=void 0;class _{constructor(){this._data={}}set(w,R,x){this._data[w]||(this._data[w]={}),this._data[w][R]=x}get(w,R){return this._data[w]?this._data[w][R]:void 0}clear(){this._data={}}}u.TwoKeyMap=_,u.FourKeyMap=class{constructor(){this._data=new _}set(y,w,R,x,P){this._data.get(y,w)||this._data.set(y,w,new _),this._data.get(y,w).set(R,x,P)}get(y,w,R,x){var P;return(P=this._data.get(y,w))===null||P===void 0?void 0:P.get(R,x)}clear(){this._data.clear()}}},6114:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.isChromeOS=u.isLinux=u.isWindows=u.isIphone=u.isIpad=u.isMac=u.getSafariVersion=u.isSafari=u.isLegacyEdge=u.isFirefox=u.isNode=void 0,u.isNode=typeof navigator>"u";let _=u.isNode?"node":navigator.userAgent,y=u.isNode?"node":navigator.platform;u.isFirefox=_.includes("Firefox"),u.isLegacyEdge=_.includes("Edge"),u.isSafari=/^((?!chrome|android).)*safari/i.test(_),u.getSafariVersion=function(){if(!u.isSafari)return 0;let w=_.match(/Version\/(\d+)/);return w===null||w.length<2?0:parseInt(w[1])},u.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(y),u.isIpad=y==="iPad",u.isIphone=y==="iPhone",u.isWindows=["Windows","Win16","Win32","WinCE"].includes(y),u.isLinux=y.indexOf("Linux")>=0,u.isChromeOS=/\bCrOS\b/.test(_)},6106:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.SortedList=void 0;let _=0;u.SortedList=class{constructor(y){this._getKey=y,this._array=[]}clear(){this._array.length=0}insert(y){this._array.length!==0?(_=this._search(this._getKey(y),0,this._array.length-1),this._array.splice(_,0,y)):this._array.push(y)}delete(y){if(this._array.length===0)return!1;let w=this._getKey(y);if(w===void 0||(_=this._search(w,0,this._array.length-1),_===-1)||this._getKey(this._array[_])!==w)return!1;do if(this._array[_]===y)return this._array.splice(_,1),!0;while(++_<this._array.length&&this._getKey(this._array[_])===w);return!1}*getKeyIterator(y){if(this._array.length!==0&&(_=this._search(y,0,this._array.length-1),!(_<0||_>=this._array.length)&&this._getKey(this._array[_])===y))do yield this._array[_];while(++_<this._array.length&&this._getKey(this._array[_])===y)}forEachByKey(y,w){if(this._array.length!==0&&(_=this._search(y,0,this._array.length-1),!(_<0||_>=this._array.length)&&this._getKey(this._array[_])===y))do w(this._array[_]);while(++_<this._array.length&&this._getKey(this._array[_])===y)}values(){return this._array.values()}_search(y,w,R){if(R<w)return w;let x=Math.floor((w+R)/2),P=this._getKey(this._array[x]);if(P>y)return this._search(y,w,x-1);if(P<y)return this._search(y,x+1,R);for(;x>0&&this._getKey(this._array[x-1])===y;)x--;return x}}},7226:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.DebouncedIdleTask=u.IdleTaskQueue=u.PriorityTaskQueue=void 0;let y=_(6114);class w{constructor(){this._tasks=[],this._i=0}enqueue(P){this._tasks.push(P),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(P){this._idleCallback=void 0;let A=0,S=0,c=P.timeRemaining(),p=0;for(;this._i<this._tasks.length;){if(A=Date.now(),this._tasks[this._i]()||this._i++,A=Math.max(1,Date.now()-A),S=Math.max(A,S),p=P.timeRemaining(),1.5*S>p)return c-A<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(c-A))}ms`),void this._start();c=p}this.clear()}}class R extends w{_requestCallback(P){return setTimeout(()=>P(this._createDeadline(16)))}_cancelCallback(P){clearTimeout(P)}_createDeadline(P){let A=Date.now()+P;return{timeRemaining:()=>Math.max(0,A-Date.now())}}}u.PriorityTaskQueue=R,u.IdleTaskQueue=!y.isNode&&"requestIdleCallback"in window?class extends w{_requestCallback(x){return requestIdleCallback(x)}_cancelCallback(x){cancelIdleCallback(x)}}:R,u.DebouncedIdleTask=class{constructor(){this._queue=new u.IdleTaskQueue}set(x){this._queue.clear(),this._queue.enqueue(x)}flush(){this._queue.flush()}}},9282:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.updateWindowsModeWrappedState=void 0;let y=_(643);u.updateWindowsModeWrappedState=function(w){let R=w.buffer.lines.get(w.buffer.ybase+w.buffer.y-1),x=R==null?void 0:R.get(w.cols-1),P=w.buffer.lines.get(w.buffer.ybase+w.buffer.y);P&&x&&(P.isWrapped=x[y.CHAR_DATA_CODE_INDEX]!==y.NULL_CELL_CODE&&x[y.CHAR_DATA_CODE_INDEX]!==y.WHITESPACE_CELL_CODE)}},3734:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.ExtendedAttrs=u.AttributeData=void 0;class _{constructor(){this.fg=0,this.bg=0,this.extended=new y}static toColorRGB(R){return[R>>>16&255,R>>>8&255,255&R]}static fromColorRGB(R){return(255&R[0])<<16|(255&R[1])<<8|255&R[2]}clone(){let R=new _;return R.fg=this.fg,R.bg=this.bg,R.extended=this.extended.clone(),R}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}u.AttributeData=_;class y{constructor(R=0,x=0){this._ext=0,this._urlId=0,this._ext=R,this._urlId=x}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(R){this._ext=R}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(R){this._ext&=-469762049,this._ext|=R<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(R){this._ext&=-67108864,this._ext|=67108863&R}get urlId(){return this._urlId}set urlId(R){this._urlId=R}clone(){return new y(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}u.ExtendedAttrs=y},9092:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.BufferStringIterator=u.Buffer=u.MAX_BUFFER_SIZE=void 0;let y=_(6349),w=_(8437),R=_(511),x=_(643),P=_(4634),A=_(4863),S=_(7116),c=_(3734),p=_(7226);u.MAX_BUFFER_SIZE=4294967295,u.Buffer=class{constructor(e,i,t){this._hasScrollback=e,this._optionsService=i,this._bufferService=t,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=w.DEFAULT_ATTR_DATA.clone(),this.savedCharset=S.DEFAULT_CHARSET,this.markers=[],this._nullCell=R.CellData.fromCharData([0,x.NULL_CELL_CHAR,x.NULL_CELL_WIDTH,x.NULL_CELL_CODE]),this._whitespaceCell=R.CellData.fromCharData([0,x.WHITESPACE_CELL_CHAR,x.WHITESPACE_CELL_WIDTH,x.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new p.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new y.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new c.ExtendedAttrs),this._nullCell}getWhitespaceCell(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new c.ExtendedAttrs),this._whitespaceCell}getBlankLine(e,i){return new w.BufferLine(this._bufferService.cols,this.getNullCell(e),i)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}_getCorrectBufferLength(e){if(!this._hasScrollback)return e;let i=e+this._optionsService.rawOptions.scrollback;return i>u.MAX_BUFFER_SIZE?u.MAX_BUFFER_SIZE:i}fillViewportRows(e){if(this.lines.length===0){e===void 0&&(e=w.DEFAULT_ATTR_DATA);let i=this._rows;for(;i--;)this.lines.push(this.getBlankLine(e))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new y.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(e,i){let t=this.getNullCell(w.DEFAULT_ATTR_DATA),n=0,r=this._getCorrectBufferLength(i);if(r>this.lines.maxLength&&(this.lines.maxLength=r),this.lines.length>0){if(this._cols<e)for(let l=0;l<this.lines.length;l++)n+=+this.lines.get(l).resize(e,t);let a=0;if(this._rows<i)for(let l=this._rows;l<i;l++)this.lines.length<i+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new w.BufferLine(e,t)):this.ybase>0&&this.lines.length<=this.ybase+this.y+a+1?(this.ybase--,a++,this.ydisp>0&&this.ydisp--):this.lines.push(new w.BufferLine(e,t)));else for(let l=this._rows;l>i;l--)this.lines.length>i+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(r<this.lines.maxLength){let l=this.lines.length-r;l>0&&(this.lines.trimStart(l),this.ybase=Math.max(this.ybase-l,0),this.ydisp=Math.max(this.ydisp-l,0),this.savedY=Math.max(this.savedY-l,0)),this.lines.maxLength=r}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,i-1),a&&(this.y+=a),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=i-1,this._isReflowEnabled&&(this._reflow(e,i),this._cols>e))for(let a=0;a<this.lines.length;a++)n+=+this.lines.get(a).resize(e,t);this._cols=e,this._rows=i,this._memoryCleanupQueue.clear(),n>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);let i=0;for(;this._memoryCleanupPosition<this.lines.length;)if(i+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),i>100)return!0;return e}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(e,i){this._cols!==e&&(e>this._cols?this._reflowLarger(e,i):this._reflowSmaller(e,i))}_reflowLarger(e,i){let t=(0,P.reflowLargerGetLinesToRemove)(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(w.DEFAULT_ATTR_DATA));if(t.length>0){let n=(0,P.reflowLargerCreateNewLayout)(this.lines,t);(0,P.reflowLargerApplyNewLayout)(this.lines,n.layout),this._reflowLargerAdjustViewport(e,i,n.countRemoved)}}_reflowLargerAdjustViewport(e,i,t){let n=this.getNullCell(w.DEFAULT_ATTR_DATA),r=t;for(;r-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<i&&this.lines.push(new w.BufferLine(e,n))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-t,0)}_reflowSmaller(e,i){let t=this.getNullCell(w.DEFAULT_ATTR_DATA),n=[],r=0;for(let a=this.lines.length-1;a>=0;a--){let l=this.lines.get(a);if(!l||!l.isWrapped&&l.getTrimmedLength()<=e)continue;let g=[l];for(;l.isWrapped&&a>0;)l=this.lines.get(--a),g.unshift(l);let D=this.ybase+this.y;if(D>=a&&D<a+g.length)continue;let C=g[g.length-1].getTrimmedLength(),b=(0,P.reflowSmallerGetNewLineLengths)(g,this._cols,e),N=b.length-g.length,W;W=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+N):Math.max(0,this.lines.length-this.lines.maxLength+N);let K=[];for(let ee=0;ee<N;ee++){let fe=this.getBlankLine(w.DEFAULT_ATTR_DATA,!0);K.push(fe)}K.length>0&&(n.push({start:a+g.length+r,newLines:K}),r+=K.length),g.push(...K);let E=b.length-1,F=b[E];F===0&&(E--,F=b[E]);let I=g.length-N-1,j=C;for(;I>=0;){let ee=Math.min(j,F);if(g[E]===void 0)break;if(g[E].copyCellsFrom(g[I],j-ee,F-ee,ee,!0),F-=ee,F===0&&(E--,F=b[E]),j-=ee,j===0){I--;let fe=Math.max(I,0);j=(0,P.getWrappedLineTrimmedLength)(g,fe,this._cols)}}for(let ee=0;ee<g.length;ee++)b[ee]<e&&g[ee].setCell(b[ee],t);let ie=N-W;for(;ie-- >0;)this.ybase===0?this.y<i-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+r)-i&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+N,this.ybase+i-1)}if(n.length>0){let a=[],l=[];for(let E=0;E<this.lines.length;E++)l.push(this.lines.get(E));let g=this.lines.length,D=g-1,C=0,b=n[C];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+r);let N=0;for(let E=Math.min(this.lines.maxLength-1,g+r-1);E>=0;E--)if(b&&b.start>D+N){for(let F=b.newLines.length-1;F>=0;F--)this.lines.set(E--,b.newLines[F]);E++,a.push({index:D+1,amount:b.newLines.length}),N+=b.newLines.length,b=n[++C]}else this.lines.set(E,l[D--]);let W=0;for(let E=a.length-1;E>=0;E--)a[E].index+=W,this.lines.onInsertEmitter.fire(a[E]),W+=a[E].amount;let K=Math.max(0,g+r-this.lines.maxLength);K>0&&this.lines.onTrimEmitter.fire(K)}}stringIndexToBufferIndex(e,i,t=!1){for(;i;){let n=this.lines.get(e);if(!n)return[-1,-1];let r=t?n.getTrimmedLength():n.length;for(let a=0;a<r;++a)if(n.get(a)[x.CHAR_DATA_WIDTH_INDEX]&&(i-=n.get(a)[x.CHAR_DATA_CHAR_INDEX].length||1),i<0)return[e,a];e++}return[e,0]}translateBufferLineToString(e,i,t=0,n){let r=this.lines.get(e);return r?r.translateToString(i,t,n):""}getWrappedRangeForLine(e){let i=e,t=e;for(;i>0&&this.lines.get(i).isWrapped;)i--;for(;t+1<this.lines.length&&this.lines.get(t+1).isWrapped;)t++;return{first:i,last:t}}setupTabStops(e){for(e!=null?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}prevStop(e){for(e==null&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}nextStop(e){for(e==null&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}clearMarkers(e){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].line===e&&(this.markers[i].dispose(),this.markers.splice(i--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].dispose(),this.markers.splice(e--,1);this._isClearing=!1}addMarker(e){let i=new A.Marker(e);return this.markers.push(i),i.register(this.lines.onTrim(t=>{i.line-=t,i.line<0&&i.dispose()})),i.register(this.lines.onInsert(t=>{i.line>=t.index&&(i.line+=t.amount)})),i.register(this.lines.onDelete(t=>{i.line>=t.index&&i.line<t.index+t.amount&&i.dispose(),i.line>t.index&&(i.line-=t.amount)})),i.register(i.onDispose(()=>this._removeMarker(i))),i}_removeMarker(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}iterator(e,i,t,n,r){return new v(this,e,i,t,n,r)}};class v{constructor(i,t,n=0,r=i.lines.length,a=0,l=0){this._buffer=i,this._trimRight=t,this._startIndex=n,this._endIndex=r,this._startOverscan=a,this._endOverscan=l,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}hasNext(){return this._current<this._endIndex}next(){let i=this._buffer.getWrappedRangeForLine(this._current);i.first<this._startIndex-this._startOverscan&&(i.first=this._startIndex-this._startOverscan),i.last>this._endIndex+this._endOverscan&&(i.last=this._endIndex+this._endOverscan),i.first=Math.max(i.first,0),i.last=Math.min(i.last,this._buffer.lines.length);let t="";for(let n=i.first;n<=i.last;++n)t+=this._buffer.translateBufferLineToString(n,this._trimRight);return this._current=i.last+1,{range:i,content:t}}}u.BufferStringIterator=v},8437:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.BufferLine=u.DEFAULT_ATTR_DATA=void 0;let y=_(482),w=_(643),R=_(511),x=_(3734);u.DEFAULT_ATTR_DATA=Object.freeze(new x.AttributeData);let P=0;class A{constructor(c,p,v=!1){this.isWrapped=v,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*c);let e=p||R.CellData.fromCharData([0,w.NULL_CELL_CHAR,w.NULL_CELL_WIDTH,w.NULL_CELL_CODE]);for(let i=0;i<c;++i)this.setCell(i,e);this.length=c}get(c){let p=this._data[3*c+0],v=2097151&p;return[this._data[3*c+1],2097152&p?this._combined[c]:v?(0,y.stringFromCodePoint)(v):"",p>>22,2097152&p?this._combined[c].charCodeAt(this._combined[c].length-1):v]}set(c,p){this._data[3*c+1]=p[w.CHAR_DATA_ATTR_INDEX],p[w.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[c]=p[1],this._data[3*c+0]=2097152|c|p[w.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*c+0]=p[w.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|p[w.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(c){return this._data[3*c+0]>>22}hasWidth(c){return 12582912&this._data[3*c+0]}getFg(c){return this._data[3*c+1]}getBg(c){return this._data[3*c+2]}hasContent(c){return 4194303&this._data[3*c+0]}getCodePoint(c){let p=this._data[3*c+0];return 2097152&p?this._combined[c].charCodeAt(this._combined[c].length-1):2097151&p}isCombined(c){return 2097152&this._data[3*c+0]}getString(c){let p=this._data[3*c+0];return 2097152&p?this._combined[c]:2097151&p?(0,y.stringFromCodePoint)(2097151&p):""}isProtected(c){return 536870912&this._data[3*c+2]}loadCell(c,p){return P=3*c,p.content=this._data[P+0],p.fg=this._data[P+1],p.bg=this._data[P+2],2097152&p.content&&(p.combinedData=this._combined[c]),268435456&p.bg&&(p.extended=this._extendedAttrs[c]),p}setCell(c,p){2097152&p.content&&(this._combined[c]=p.combinedData),268435456&p.bg&&(this._extendedAttrs[c]=p.extended),this._data[3*c+0]=p.content,this._data[3*c+1]=p.fg,this._data[3*c+2]=p.bg}setCellFromCodePoint(c,p,v,e,i,t){268435456&i&&(this._extendedAttrs[c]=t),this._data[3*c+0]=p|v<<22,this._data[3*c+1]=e,this._data[3*c+2]=i}addCodepointToCell(c,p){let v=this._data[3*c+0];2097152&v?this._combined[c]+=(0,y.stringFromCodePoint)(p):(2097151&v?(this._combined[c]=(0,y.stringFromCodePoint)(2097151&v)+(0,y.stringFromCodePoint)(p),v&=-2097152,v|=2097152):v=p|4194304,this._data[3*c+0]=v)}insertCells(c,p,v,e){if((c%=this.length)&&this.getWidth(c-1)===2&&this.setCellFromCodePoint(c-1,0,1,(e==null?void 0:e.fg)||0,(e==null?void 0:e.bg)||0,(e==null?void 0:e.extended)||new x.ExtendedAttrs),p<this.length-c){let i=new R.CellData;for(let t=this.length-c-p-1;t>=0;--t)this.setCell(c+p+t,this.loadCell(c+t,i));for(let t=0;t<p;++t)this.setCell(c+t,v)}else for(let i=c;i<this.length;++i)this.setCell(i,v);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(e==null?void 0:e.fg)||0,(e==null?void 0:e.bg)||0,(e==null?void 0:e.extended)||new x.ExtendedAttrs)}deleteCells(c,p,v,e){if(c%=this.length,p<this.length-c){let i=new R.CellData;for(let t=0;t<this.length-c-p;++t)this.setCell(c+t,this.loadCell(c+p+t,i));for(let t=this.length-p;t<this.length;++t)this.setCell(t,v)}else for(let i=c;i<this.length;++i)this.setCell(i,v);c&&this.getWidth(c-1)===2&&this.setCellFromCodePoint(c-1,0,1,(e==null?void 0:e.fg)||0,(e==null?void 0:e.bg)||0,(e==null?void 0:e.extended)||new x.ExtendedAttrs),this.getWidth(c)!==0||this.hasContent(c)||this.setCellFromCodePoint(c,0,1,(e==null?void 0:e.fg)||0,(e==null?void 0:e.bg)||0,(e==null?void 0:e.extended)||new x.ExtendedAttrs)}replaceCells(c,p,v,e,i=!1){if(i)for(c&&this.getWidth(c-1)===2&&!this.isProtected(c-1)&&this.setCellFromCodePoint(c-1,0,1,(e==null?void 0:e.fg)||0,(e==null?void 0:e.bg)||0,(e==null?void 0:e.extended)||new x.ExtendedAttrs),p<this.length&&this.getWidth(p-1)===2&&!this.isProtected(p)&&this.setCellFromCodePoint(p,0,1,(e==null?void 0:e.fg)||0,(e==null?void 0:e.bg)||0,(e==null?void 0:e.extended)||new x.ExtendedAttrs);c<p&&c<this.length;)this.isProtected(c)||this.setCell(c,v),c++;else for(c&&this.getWidth(c-1)===2&&this.setCellFromCodePoint(c-1,0,1,(e==null?void 0:e.fg)||0,(e==null?void 0:e.bg)||0,(e==null?void 0:e.extended)||new x.ExtendedAttrs),p<this.length&&this.getWidth(p-1)===2&&this.setCellFromCodePoint(p,0,1,(e==null?void 0:e.fg)||0,(e==null?void 0:e.bg)||0,(e==null?void 0:e.extended)||new x.ExtendedAttrs);c<p&&c<this.length;)this.setCell(c++,v)}resize(c,p){if(c===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;let v=3*c;if(c>this.length){if(this._data.buffer.byteLength>=4*v)this._data=new Uint32Array(this._data.buffer,0,v);else{let e=new Uint32Array(v);e.set(this._data),this._data=e}for(let e=this.length;e<c;++e)this.setCell(e,p)}else{this._data=this._data.subarray(0,v);let e=Object.keys(this._combined);for(let t=0;t<e.length;t++){let n=parseInt(e[t],10);n>=c&&delete this._combined[n]}let i=Object.keys(this._extendedAttrs);for(let t=0;t<i.length;t++){let n=parseInt(i[t],10);n>=c&&delete this._extendedAttrs[n]}}return this.length=c,4*v*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){let c=new Uint32Array(this._data.length);return c.set(this._data),this._data=c,1}return 0}fill(c,p=!1){if(p)for(let v=0;v<this.length;++v)this.isProtected(v)||this.setCell(v,c);else{this._combined={},this._extendedAttrs={};for(let v=0;v<this.length;++v)this.setCell(v,c)}}copyFrom(c){this.length!==c.length?this._data=new Uint32Array(c._data):this._data.set(c._data),this.length=c.length,this._combined={};for(let p in c._combined)this._combined[p]=c._combined[p];this._extendedAttrs={};for(let p in c._extendedAttrs)this._extendedAttrs[p]=c._extendedAttrs[p];this.isWrapped=c.isWrapped}clone(){let c=new A(0);c._data=new Uint32Array(this._data),c.length=this.length;for(let p in this._combined)c._combined[p]=this._combined[p];for(let p in this._extendedAttrs)c._extendedAttrs[p]=this._extendedAttrs[p];return c.isWrapped=this.isWrapped,c}getTrimmedLength(){for(let c=this.length-1;c>=0;--c)if(4194303&this._data[3*c+0])return c+(this._data[3*c+0]>>22);return 0}copyCellsFrom(c,p,v,e,i){let t=c._data;if(i)for(let r=e-1;r>=0;r--){for(let a=0;a<3;a++)this._data[3*(v+r)+a]=t[3*(p+r)+a];268435456&t[3*(p+r)+2]&&(this._extendedAttrs[v+r]=c._extendedAttrs[p+r])}else for(let r=0;r<e;r++){for(let a=0;a<3;a++)this._data[3*(v+r)+a]=t[3*(p+r)+a];268435456&t[3*(p+r)+2]&&(this._extendedAttrs[v+r]=c._extendedAttrs[p+r])}let n=Object.keys(c._combined);for(let r=0;r<n.length;r++){let a=parseInt(n[r],10);a>=p&&(this._combined[a-p+v]=c._combined[a])}}translateToString(c=!1,p=0,v=this.length){c&&(v=Math.min(v,this.getTrimmedLength()));let e="";for(;p<v;){let i=this._data[3*p+0],t=2097151&i;e+=2097152&i?this._combined[p]:t?(0,y.stringFromCodePoint)(t):w.WHITESPACE_CELL_CHAR,p+=i>>22||1}return e}}u.BufferLine=A},4841:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.getRangeLength=void 0,u.getRangeLength=function(_,y){if(_.start.y>_.end.y)throw new Error(`Buffer range end (${_.end.x}, ${_.end.y}) cannot be before start (${_.start.x}, ${_.start.y})`);return y*(_.end.y-_.start.y)+(_.end.x-_.start.x+1)}},4634:(B,u)=>{function _(y,w,R){if(w===y.length-1)return y[w].getTrimmedLength();let x=!y[w].hasContent(R-1)&&y[w].getWidth(R-1)===1,P=y[w+1].getWidth(0)===2;return x&&P?R-1:R}Object.defineProperty(u,"__esModule",{value:!0}),u.getWrappedLineTrimmedLength=u.reflowSmallerGetNewLineLengths=u.reflowLargerApplyNewLayout=u.reflowLargerCreateNewLayout=u.reflowLargerGetLinesToRemove=void 0,u.reflowLargerGetLinesToRemove=function(y,w,R,x,P){let A=[];for(let S=0;S<y.length-1;S++){let c=S,p=y.get(++c);if(!p.isWrapped)continue;let v=[y.get(S)];for(;c<y.length&&p.isWrapped;)v.push(p),p=y.get(++c);if(x>=S&&x<c){S+=v.length-1;continue}let e=0,i=_(v,e,w),t=1,n=0;for(;t<v.length;){let a=_(v,t,w),l=a-n,g=R-i,D=Math.min(l,g);v[e].copyCellsFrom(v[t],n,i,D,!1),i+=D,i===R&&(e++,i=0),n+=D,n===a&&(t++,n=0),i===0&&e!==0&&v[e-1].getWidth(R-1)===2&&(v[e].copyCellsFrom(v[e-1],R-1,i++,1,!1),v[e-1].setCell(R-1,P))}v[e].replaceCells(i,R,P);let r=0;for(let a=v.length-1;a>0&&(a>e||v[a].getTrimmedLength()===0);a--)r++;r>0&&(A.push(S+v.length-r),A.push(r)),S+=v.length-1}return A},u.reflowLargerCreateNewLayout=function(y,w){let R=[],x=0,P=w[x],A=0;for(let S=0;S<y.length;S++)if(P===S){let c=w[++x];y.onDeleteEmitter.fire({index:S-A,amount:c}),S+=c-1,A+=c,P=w[++x]}else R.push(S);return{layout:R,countRemoved:A}},u.reflowLargerApplyNewLayout=function(y,w){let R=[];for(let x=0;x<w.length;x++)R.push(y.get(w[x]));for(let x=0;x<R.length;x++)y.set(x,R[x]);y.length=w.length},u.reflowSmallerGetNewLineLengths=function(y,w,R){let x=[],P=y.map((p,v)=>_(y,v,w)).reduce((p,v)=>p+v),A=0,S=0,c=0;for(;c<P;){if(P-c<R){x.push(P-c);break}A+=R;let p=_(y,S,w);A>p&&(A-=p,S++);let v=y[S].getWidth(A-1)===2;v&&A--;let e=v?R-1:R;x.push(e),c+=e}return x},u.getWrappedLineTrimmedLength=_},5295:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.BufferSet=void 0;let y=_(9092),w=_(8460),R=_(844);class x extends R.Disposable{constructor(A,S){super(),this._optionsService=A,this._bufferService=S,this._onBufferActivate=this.register(new w.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new y.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new y.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(A){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(A),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(A,S){this._normal.resize(A,S),this._alt.resize(A,S),this.setupTabStops(A)}setupTabStops(A){this._normal.setupTabStops(A),this._alt.setupTabStops(A)}}u.BufferSet=x},511:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.CellData=void 0;let y=_(482),w=_(643),R=_(3734);class x extends R.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new R.ExtendedAttrs,this.combinedData=""}static fromCharData(A){let S=new x;return S.setFromCharData(A),S}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,y.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(A){this.fg=A[w.CHAR_DATA_ATTR_INDEX],this.bg=0;let S=!1;if(A[w.CHAR_DATA_CHAR_INDEX].length>2)S=!0;else if(A[w.CHAR_DATA_CHAR_INDEX].length===2){let c=A[w.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=c&&c<=56319){let p=A[w.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=p&&p<=57343?this.content=1024*(c-55296)+p-56320+65536|A[w.CHAR_DATA_WIDTH_INDEX]<<22:S=!0}else S=!0}else this.content=A[w.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|A[w.CHAR_DATA_WIDTH_INDEX]<<22;S&&(this.combinedData=A[w.CHAR_DATA_CHAR_INDEX],this.content=2097152|A[w.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}u.CellData=x},643:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.WHITESPACE_CELL_CODE=u.WHITESPACE_CELL_WIDTH=u.WHITESPACE_CELL_CHAR=u.NULL_CELL_CODE=u.NULL_CELL_WIDTH=u.NULL_CELL_CHAR=u.CHAR_DATA_CODE_INDEX=u.CHAR_DATA_WIDTH_INDEX=u.CHAR_DATA_CHAR_INDEX=u.CHAR_DATA_ATTR_INDEX=u.DEFAULT_EXT=u.DEFAULT_ATTR=u.DEFAULT_COLOR=void 0,u.DEFAULT_COLOR=0,u.DEFAULT_ATTR=256|u.DEFAULT_COLOR<<9,u.DEFAULT_EXT=0,u.CHAR_DATA_ATTR_INDEX=0,u.CHAR_DATA_CHAR_INDEX=1,u.CHAR_DATA_WIDTH_INDEX=2,u.CHAR_DATA_CODE_INDEX=3,u.NULL_CELL_CHAR="",u.NULL_CELL_WIDTH=1,u.NULL_CELL_CODE=0,u.WHITESPACE_CELL_CHAR=" ",u.WHITESPACE_CELL_WIDTH=1,u.WHITESPACE_CELL_CODE=32},4863:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.Marker=void 0;let y=_(8460),w=_(844);class R{constructor(P){this.line=P,this.isDisposed=!1,this._disposables=[],this._id=R._nextId++,this._onDispose=this.register(new y.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,w.disposeArray)(this._disposables),this._disposables.length=0)}register(P){return this._disposables.push(P),P}}u.Marker=R,R._nextId=1},7116:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.DEFAULT_CHARSET=u.CHARSETS=void 0,u.CHARSETS={},u.DEFAULT_CHARSET=u.CHARSETS.B,u.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},u.CHARSETS.A={"#":"\xA3"},u.CHARSETS.B=void 0,u.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},u.CHARSETS.C=u.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},u.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},u.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},u.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},u.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},u.CHARSETS.E=u.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},u.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},u.CHARSETS.H=u.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},u.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(B,u)=>{var _,y;Object.defineProperty(u,"__esModule",{value:!0}),u.C1_ESCAPED=u.C1=u.C0=void 0,function(w){w.NUL="\0",w.SOH="",w.STX="",w.ETX="",w.EOT="",w.ENQ="",w.ACK="",w.BEL="\x07",w.BS="\b",w.HT="	",w.LF=`
`,w.VT="\v",w.FF="\f",w.CR="\r",w.SO="",w.SI="",w.DLE="",w.DC1="",w.DC2="",w.DC3="",w.DC4="",w.NAK="",w.SYN="",w.ETB="",w.CAN="",w.EM="",w.SUB="",w.ESC="\x1B",w.FS="",w.GS="",w.RS="",w.US="",w.SP=" ",w.DEL="\x7F"}(_=u.C0||(u.C0={})),(y=u.C1||(u.C1={})).PAD="\x80",y.HOP="\x81",y.BPH="\x82",y.NBH="\x83",y.IND="\x84",y.NEL="\x85",y.SSA="\x86",y.ESA="\x87",y.HTS="\x88",y.HTJ="\x89",y.VTS="\x8A",y.PLD="\x8B",y.PLU="\x8C",y.RI="\x8D",y.SS2="\x8E",y.SS3="\x8F",y.DCS="\x90",y.PU1="\x91",y.PU2="\x92",y.STS="\x93",y.CCH="\x94",y.MW="\x95",y.SPA="\x96",y.EPA="\x97",y.SOS="\x98",y.SGCI="\x99",y.SCI="\x9A",y.CSI="\x9B",y.ST="\x9C",y.OSC="\x9D",y.PM="\x9E",y.APC="\x9F",(u.C1_ESCAPED||(u.C1_ESCAPED={})).ST=`${_.ESC}\\`},7399:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.evaluateKeyboardEvent=void 0;let y=_(2584),w={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};u.evaluateKeyboardEvent=function(R,x,P,A){let S={type:0,cancel:!1,key:void 0},c=(R.shiftKey?1:0)|(R.altKey?2:0)|(R.ctrlKey?4:0)|(R.metaKey?8:0);switch(R.keyCode){case 0:R.key==="UIKeyInputUpArrow"?S.key=x?y.C0.ESC+"OA":y.C0.ESC+"[A":R.key==="UIKeyInputLeftArrow"?S.key=x?y.C0.ESC+"OD":y.C0.ESC+"[D":R.key==="UIKeyInputRightArrow"?S.key=x?y.C0.ESC+"OC":y.C0.ESC+"[C":R.key==="UIKeyInputDownArrow"&&(S.key=x?y.C0.ESC+"OB":y.C0.ESC+"[B");break;case 8:if(R.altKey){S.key=y.C0.ESC+y.C0.DEL;break}S.key=y.C0.DEL;break;case 9:if(R.shiftKey){S.key=y.C0.ESC+"[Z";break}S.key=y.C0.HT,S.cancel=!0;break;case 13:S.key=R.altKey?y.C0.ESC+y.C0.CR:y.C0.CR,S.cancel=!0;break;case 27:S.key=y.C0.ESC,R.altKey&&(S.key=y.C0.ESC+y.C0.ESC),S.cancel=!0;break;case 37:if(R.metaKey)break;c?(S.key=y.C0.ESC+"[1;"+(c+1)+"D",S.key===y.C0.ESC+"[1;3D"&&(S.key=y.C0.ESC+(P?"b":"[1;5D"))):S.key=x?y.C0.ESC+"OD":y.C0.ESC+"[D";break;case 39:if(R.metaKey)break;c?(S.key=y.C0.ESC+"[1;"+(c+1)+"C",S.key===y.C0.ESC+"[1;3C"&&(S.key=y.C0.ESC+(P?"f":"[1;5C"))):S.key=x?y.C0.ESC+"OC":y.C0.ESC+"[C";break;case 38:if(R.metaKey)break;c?(S.key=y.C0.ESC+"[1;"+(c+1)+"A",P||S.key!==y.C0.ESC+"[1;3A"||(S.key=y.C0.ESC+"[1;5A")):S.key=x?y.C0.ESC+"OA":y.C0.ESC+"[A";break;case 40:if(R.metaKey)break;c?(S.key=y.C0.ESC+"[1;"+(c+1)+"B",P||S.key!==y.C0.ESC+"[1;3B"||(S.key=y.C0.ESC+"[1;5B")):S.key=x?y.C0.ESC+"OB":y.C0.ESC+"[B";break;case 45:R.shiftKey||R.ctrlKey||(S.key=y.C0.ESC+"[2~");break;case 46:S.key=c?y.C0.ESC+"[3;"+(c+1)+"~":y.C0.ESC+"[3~";break;case 36:S.key=c?y.C0.ESC+"[1;"+(c+1)+"H":x?y.C0.ESC+"OH":y.C0.ESC+"[H";break;case 35:S.key=c?y.C0.ESC+"[1;"+(c+1)+"F":x?y.C0.ESC+"OF":y.C0.ESC+"[F";break;case 33:R.shiftKey?S.type=2:R.ctrlKey?S.key=y.C0.ESC+"[5;"+(c+1)+"~":S.key=y.C0.ESC+"[5~";break;case 34:R.shiftKey?S.type=3:R.ctrlKey?S.key=y.C0.ESC+"[6;"+(c+1)+"~":S.key=y.C0.ESC+"[6~";break;case 112:S.key=c?y.C0.ESC+"[1;"+(c+1)+"P":y.C0.ESC+"OP";break;case 113:S.key=c?y.C0.ESC+"[1;"+(c+1)+"Q":y.C0.ESC+"OQ";break;case 114:S.key=c?y.C0.ESC+"[1;"+(c+1)+"R":y.C0.ESC+"OR";break;case 115:S.key=c?y.C0.ESC+"[1;"+(c+1)+"S":y.C0.ESC+"OS";break;case 116:S.key=c?y.C0.ESC+"[15;"+(c+1)+"~":y.C0.ESC+"[15~";break;case 117:S.key=c?y.C0.ESC+"[17;"+(c+1)+"~":y.C0.ESC+"[17~";break;case 118:S.key=c?y.C0.ESC+"[18;"+(c+1)+"~":y.C0.ESC+"[18~";break;case 119:S.key=c?y.C0.ESC+"[19;"+(c+1)+"~":y.C0.ESC+"[19~";break;case 120:S.key=c?y.C0.ESC+"[20;"+(c+1)+"~":y.C0.ESC+"[20~";break;case 121:S.key=c?y.C0.ESC+"[21;"+(c+1)+"~":y.C0.ESC+"[21~";break;case 122:S.key=c?y.C0.ESC+"[23;"+(c+1)+"~":y.C0.ESC+"[23~";break;case 123:S.key=c?y.C0.ESC+"[24;"+(c+1)+"~":y.C0.ESC+"[24~";break;default:if(!R.ctrlKey||R.shiftKey||R.altKey||R.metaKey)if(P&&!A||!R.altKey||R.metaKey)!P||R.altKey||R.ctrlKey||R.shiftKey||!R.metaKey?R.key&&!R.ctrlKey&&!R.altKey&&!R.metaKey&&R.keyCode>=48&&R.key.length===1?S.key=R.key:R.key&&R.ctrlKey&&(R.key==="_"&&(S.key=y.C0.US),R.key==="@"&&(S.key=y.C0.NUL)):R.keyCode===65&&(S.type=1);else{let p=w[R.keyCode],v=p==null?void 0:p[R.shiftKey?1:0];if(v)S.key=y.C0.ESC+v;else if(R.keyCode>=65&&R.keyCode<=90){let e=R.ctrlKey?R.keyCode-64:R.keyCode+32,i=String.fromCharCode(e);R.shiftKey&&(i=i.toUpperCase()),S.key=y.C0.ESC+i}else if(R.keyCode===32)S.key=y.C0.ESC+(R.ctrlKey?y.C0.NUL:" ");else if(R.key==="Dead"&&R.code.startsWith("Key")){let e=R.code.slice(3,4);R.shiftKey||(e=e.toLowerCase()),S.key=y.C0.ESC+e,S.cancel=!0}}else R.keyCode>=65&&R.keyCode<=90?S.key=String.fromCharCode(R.keyCode-64):R.keyCode===32?S.key=y.C0.NUL:R.keyCode>=51&&R.keyCode<=55?S.key=String.fromCharCode(R.keyCode-51+27):R.keyCode===56?S.key=y.C0.DEL:R.keyCode===219?S.key=y.C0.ESC:R.keyCode===220?S.key=y.C0.FS:R.keyCode===221&&(S.key=y.C0.GS)}return S}},482:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.Utf8ToUtf32=u.StringToUtf32=u.utf32ToString=u.stringFromCodePoint=void 0,u.stringFromCodePoint=function(_){return _>65535?(_-=65536,String.fromCharCode(55296+(_>>10))+String.fromCharCode(_%1024+56320)):String.fromCharCode(_)},u.utf32ToString=function(_,y=0,w=_.length){let R="";for(let x=y;x<w;++x){let P=_[x];P>65535?(P-=65536,R+=String.fromCharCode(55296+(P>>10))+String.fromCharCode(P%1024+56320)):R+=String.fromCharCode(P)}return R},u.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(_,y){let w=_.length;if(!w)return 0;let R=0,x=0;if(this._interim){let P=_.charCodeAt(x++);56320<=P&&P<=57343?y[R++]=1024*(this._interim-55296)+P-56320+65536:(y[R++]=this._interim,y[R++]=P),this._interim=0}for(let P=x;P<w;++P){let A=_.charCodeAt(P);if(55296<=A&&A<=56319){if(++P>=w)return this._interim=A,R;let S=_.charCodeAt(P);56320<=S&&S<=57343?y[R++]=1024*(A-55296)+S-56320+65536:(y[R++]=A,y[R++]=S)}else A!==65279&&(y[R++]=A)}return R}},u.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(_,y){let w=_.length;if(!w)return 0;let R,x,P,A,S=0,c=0,p=0;if(this.interim[0]){let i=!1,t=this.interim[0];t&=(224&t)==192?31:(240&t)==224?15:7;let n,r=0;for(;(n=63&this.interim[++r])&&r<4;)t<<=6,t|=n;let a=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,l=a-r;for(;p<l;){if(p>=w)return 0;if(n=_[p++],(192&n)!=128){p--,i=!0;break}this.interim[r++]=n,t<<=6,t|=63&n}i||(a===2?t<128?p--:y[S++]=t:a===3?t<2048||t>=55296&&t<=57343||t===65279||(y[S++]=t):t<65536||t>1114111||(y[S++]=t)),this.interim.fill(0)}let v=w-4,e=p;for(;e<w;){for(;!(!(e<v)||128&(R=_[e])||128&(x=_[e+1])||128&(P=_[e+2])||128&(A=_[e+3]));)y[S++]=R,y[S++]=x,y[S++]=P,y[S++]=A,e+=4;if(R=_[e++],R<128)y[S++]=R;else if((224&R)==192){if(e>=w)return this.interim[0]=R,S;if(x=_[e++],(192&x)!=128){e--;continue}if(c=(31&R)<<6|63&x,c<128){e--;continue}y[S++]=c}else if((240&R)==224){if(e>=w)return this.interim[0]=R,S;if(x=_[e++],(192&x)!=128){e--;continue}if(e>=w)return this.interim[0]=R,this.interim[1]=x,S;if(P=_[e++],(192&P)!=128){e--;continue}if(c=(15&R)<<12|(63&x)<<6|63&P,c<2048||c>=55296&&c<=57343||c===65279)continue;y[S++]=c}else if((248&R)==240){if(e>=w)return this.interim[0]=R,S;if(x=_[e++],(192&x)!=128){e--;continue}if(e>=w)return this.interim[0]=R,this.interim[1]=x,S;if(P=_[e++],(192&P)!=128){e--;continue}if(e>=w)return this.interim[0]=R,this.interim[1]=x,this.interim[2]=P,S;if(A=_[e++],(192&A)!=128){e--;continue}if(c=(7&R)<<18|(63&x)<<12|(63&P)<<6|63&A,c<65536||c>1114111)continue;y[S++]=c}}return S}}},225:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.UnicodeV6=void 0;let _=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],y=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],w;u.UnicodeV6=class{constructor(){if(this.version="6",!w){w=new Uint8Array(65536),w.fill(1),w[0]=0,w.fill(0,1,32),w.fill(0,127,160),w.fill(2,4352,4448),w[9001]=2,w[9002]=2,w.fill(2,11904,42192),w[12351]=1,w.fill(2,44032,55204),w.fill(2,63744,64256),w.fill(2,65040,65050),w.fill(2,65072,65136),w.fill(2,65280,65377),w.fill(2,65504,65511);for(let R=0;R<_.length;++R)w.fill(0,_[R][0],_[R][1]+1)}}wcwidth(R){return R<32?0:R<127?1:R<65536?w[R]:function(x,P){let A,S=0,c=P.length-1;if(x<P[0][0]||x>P[c][1])return!1;for(;c>=S;)if(A=S+c>>1,x>P[A][1])S=A+1;else{if(!(x<P[A][0]))return!0;c=A-1}return!1}(R,y)?0:R>=131072&&R<=196605||R>=196608&&R<=262141?2:1}}},5981:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.WriteBuffer=void 0;let y=_(8460),w=_(844);class R extends w.Disposable{constructor(P){super(),this._action=P,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new y.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(P,A){if(A!==void 0&&this._syncCalls>A)return void(this._syncCalls=0);if(this._pendingData+=P.length,this._writeBuffer.push(P),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let S;for(this._isSyncWriting=!0;S=this._writeBuffer.shift();){this._action(S);let c=this._callbacks.shift();c&&c()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(P,A){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=P.length,this._writeBuffer.push(P),this._callbacks.push(A),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=P.length,this._writeBuffer.push(P),this._callbacks.push(A)}_innerWrite(P=0,A=!0){let S=P||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){let c=this._writeBuffer[this._bufferOffset],p=this._action(c,A);if(p){let e=i=>Date.now()-S>=12?setTimeout(()=>this._innerWrite(0,i)):this._innerWrite(S,i);return void p.catch(i=>(queueMicrotask(()=>{throw i}),Promise.resolve(!1))).then(e)}let v=this._callbacks[this._bufferOffset];if(v&&v(),this._bufferOffset++,this._pendingData-=c.length,Date.now()-S>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}u.WriteBuffer=R},5941:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.toRgbString=u.parseColor=void 0;let _=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,y=/^[\da-f]+$/;function w(R,x){let P=R.toString(16),A=P.length<2?"0"+P:P;switch(x){case 4:return P[0];case 8:return A;case 12:return(A+A).slice(0,3);default:return A+A}}u.parseColor=function(R){if(!R)return;let x=R.toLowerCase();if(x.indexOf("rgb:")===0){x=x.slice(4);let P=_.exec(x);if(P){let A=P[1]?15:P[4]?255:P[7]?4095:65535;return[Math.round(parseInt(P[1]||P[4]||P[7]||P[10],16)/A*255),Math.round(parseInt(P[2]||P[5]||P[8]||P[11],16)/A*255),Math.round(parseInt(P[3]||P[6]||P[9]||P[12],16)/A*255)]}}else if(x.indexOf("#")===0&&(x=x.slice(1),y.exec(x)&&[3,6,9,12].includes(x.length))){let P=x.length/3,A=[0,0,0];for(let S=0;S<3;++S){let c=parseInt(x.slice(P*S,P*S+P),16);A[S]=P===1?c<<4:P===2?c:P===3?c>>4:c>>8}return A}},u.toRgbString=function(R,x=16){let[P,A,S]=R;return`rgb:${w(P,x)}/${w(A,x)}/${w(S,x)}`}},5770:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.PAYLOAD_LIMIT=void 0,u.PAYLOAD_LIMIT=1e7},6351:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.DcsHandler=u.DcsParser=void 0;let y=_(482),w=_(8742),R=_(5770),x=[];u.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=x,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=x}registerHandler(A,S){this._handlers[A]===void 0&&(this._handlers[A]=[]);let c=this._handlers[A];return c.push(S),{dispose:()=>{let p=c.indexOf(S);p!==-1&&c.splice(p,1)}}}clearHandler(A){this._handlers[A]&&delete this._handlers[A]}setHandlerFallback(A){this._handlerFb=A}reset(){if(this._active.length)for(let A=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;A>=0;--A)this._active[A].unhook(!1);this._stack.paused=!1,this._active=x,this._ident=0}hook(A,S){if(this.reset(),this._ident=A,this._active=this._handlers[A]||x,this._active.length)for(let c=this._active.length-1;c>=0;c--)this._active[c].hook(S);else this._handlerFb(this._ident,"HOOK",S)}put(A,S,c){if(this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].put(A,S,c);else this._handlerFb(this._ident,"PUT",(0,y.utf32ToString)(A,S,c))}unhook(A,S=!0){if(this._active.length){let c=!1,p=this._active.length-1,v=!1;if(this._stack.paused&&(p=this._stack.loopPosition-1,c=S,v=this._stack.fallThrough,this._stack.paused=!1),!v&&c===!1){for(;p>=0&&(c=this._active[p].unhook(A),c!==!0);p--)if(c instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!1,c;p--}for(;p>=0;p--)if(c=this._active[p].unhook(!1),c instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!0,c}else this._handlerFb(this._ident,"UNHOOK",A);this._active=x,this._ident=0}};let P=new w.Params;P.addParam(0),u.DcsHandler=class{constructor(A){this._handler=A,this._data="",this._params=P,this._hitLimit=!1}hook(A){this._params=A.length>1||A.params[0]?A.clone():P,this._data="",this._hitLimit=!1}put(A,S,c){this._hitLimit||(this._data+=(0,y.utf32ToString)(A,S,c),this._data.length>R.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(A){let S=!1;if(this._hitLimit)S=!1;else if(A&&(S=this._handler(this._data,this._params),S instanceof Promise))return S.then(c=>(this._params=P,this._data="",this._hitLimit=!1,c));return this._params=P,this._data="",this._hitLimit=!1,S}}},2015:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.EscapeSequenceParser=u.VT500_TRANSITION_TABLE=u.TransitionTable=void 0;let y=_(844),w=_(8742),R=_(6242),x=_(6351);class P{constructor(p){this.table=new Uint8Array(p)}setDefault(p,v){this.table.fill(p<<4|v)}add(p,v,e,i){this.table[v<<8|p]=e<<4|i}addMany(p,v,e,i){for(let t=0;t<p.length;t++)this.table[v<<8|p[t]]=e<<4|i}}u.TransitionTable=P;let A=160;u.VT500_TRANSITION_TABLE=function(){let c=new P(4095),p=Array.apply(null,Array(256)).map((r,a)=>a),v=(r,a)=>p.slice(r,a),e=v(32,127),i=v(0,24);i.push(25),i.push.apply(i,v(28,32));let t=v(0,14),n;for(n in c.setDefault(1,0),c.addMany(e,0,2,0),t)c.addMany([24,26,153,154],n,3,0),c.addMany(v(128,144),n,3,0),c.addMany(v(144,152),n,3,0),c.add(156,n,0,0),c.add(27,n,11,1),c.add(157,n,4,8),c.addMany([152,158,159],n,0,7),c.add(155,n,11,3),c.add(144,n,11,9);return c.addMany(i,0,3,0),c.addMany(i,1,3,1),c.add(127,1,0,1),c.addMany(i,8,0,8),c.addMany(i,3,3,3),c.add(127,3,0,3),c.addMany(i,4,3,4),c.add(127,4,0,4),c.addMany(i,6,3,6),c.addMany(i,5,3,5),c.add(127,5,0,5),c.addMany(i,2,3,2),c.add(127,2,0,2),c.add(93,1,4,8),c.addMany(e,8,5,8),c.add(127,8,5,8),c.addMany([156,27,24,26,7],8,6,0),c.addMany(v(28,32),8,0,8),c.addMany([88,94,95],1,0,7),c.addMany(e,7,0,7),c.addMany(i,7,0,7),c.add(156,7,0,0),c.add(127,7,0,7),c.add(91,1,11,3),c.addMany(v(64,127),3,7,0),c.addMany(v(48,60),3,8,4),c.addMany([60,61,62,63],3,9,4),c.addMany(v(48,60),4,8,4),c.addMany(v(64,127),4,7,0),c.addMany([60,61,62,63],4,0,6),c.addMany(v(32,64),6,0,6),c.add(127,6,0,6),c.addMany(v(64,127),6,0,0),c.addMany(v(32,48),3,9,5),c.addMany(v(32,48),5,9,5),c.addMany(v(48,64),5,0,6),c.addMany(v(64,127),5,7,0),c.addMany(v(32,48),4,9,5),c.addMany(v(32,48),1,9,2),c.addMany(v(32,48),2,9,2),c.addMany(v(48,127),2,10,0),c.addMany(v(48,80),1,10,0),c.addMany(v(81,88),1,10,0),c.addMany([89,90,92],1,10,0),c.addMany(v(96,127),1,10,0),c.add(80,1,11,9),c.addMany(i,9,0,9),c.add(127,9,0,9),c.addMany(v(28,32),9,0,9),c.addMany(v(32,48),9,9,12),c.addMany(v(48,60),9,8,10),c.addMany([60,61,62,63],9,9,10),c.addMany(i,11,0,11),c.addMany(v(32,128),11,0,11),c.addMany(v(28,32),11,0,11),c.addMany(i,10,0,10),c.add(127,10,0,10),c.addMany(v(28,32),10,0,10),c.addMany(v(48,60),10,8,10),c.addMany([60,61,62,63],10,0,11),c.addMany(v(32,48),10,9,12),c.addMany(i,12,0,12),c.add(127,12,0,12),c.addMany(v(28,32),12,0,12),c.addMany(v(32,48),12,9,12),c.addMany(v(48,64),12,0,11),c.addMany(v(64,127),12,12,13),c.addMany(v(64,127),10,12,13),c.addMany(v(64,127),9,12,13),c.addMany(i,13,13,13),c.addMany(e,13,13,13),c.add(127,13,0,13),c.addMany([27,156,24,26],13,14,0),c.add(A,0,2,0),c.add(A,8,5,8),c.add(A,6,0,6),c.add(A,11,0,11),c.add(A,13,13,13),c}();class S extends y.Disposable{constructor(p=u.VT500_TRANSITION_TABLE){super(),this._transitions=p,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new w.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(v,e,i)=>{},this._executeHandlerFb=v=>{},this._csiHandlerFb=(v,e)=>{},this._escHandlerFb=v=>{},this._errorHandlerFb=v=>v,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,y.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new R.OscParser),this._dcsParser=this.register(new x.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(p,v=[64,126]){let e=0;if(p.prefix){if(p.prefix.length>1)throw new Error("only one byte as prefix supported");if(e=p.prefix.charCodeAt(0),e&&60>e||e>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(p.intermediates){if(p.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let t=0;t<p.intermediates.length;++t){let n=p.intermediates.charCodeAt(t);if(32>n||n>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");e<<=8,e|=n}}if(p.final.length!==1)throw new Error("final must be a single byte");let i=p.final.charCodeAt(0);if(v[0]>i||i>v[1])throw new Error(`final must be in range ${v[0]} .. ${v[1]}`);return e<<=8,e|=i,e}identToString(p){let v=[];for(;p;)v.push(String.fromCharCode(255&p)),p>>=8;return v.reverse().join("")}setPrintHandler(p){this._printHandler=p}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(p,v){let e=this._identifier(p,[48,126]);this._escHandlers[e]===void 0&&(this._escHandlers[e]=[]);let i=this._escHandlers[e];return i.push(v),{dispose:()=>{let t=i.indexOf(v);t!==-1&&i.splice(t,1)}}}clearEscHandler(p){this._escHandlers[this._identifier(p,[48,126])]&&delete this._escHandlers[this._identifier(p,[48,126])]}setEscHandlerFallback(p){this._escHandlerFb=p}setExecuteHandler(p,v){this._executeHandlers[p.charCodeAt(0)]=v}clearExecuteHandler(p){this._executeHandlers[p.charCodeAt(0)]&&delete this._executeHandlers[p.charCodeAt(0)]}setExecuteHandlerFallback(p){this._executeHandlerFb=p}registerCsiHandler(p,v){let e=this._identifier(p);this._csiHandlers[e]===void 0&&(this._csiHandlers[e]=[]);let i=this._csiHandlers[e];return i.push(v),{dispose:()=>{let t=i.indexOf(v);t!==-1&&i.splice(t,1)}}}clearCsiHandler(p){this._csiHandlers[this._identifier(p)]&&delete this._csiHandlers[this._identifier(p)]}setCsiHandlerFallback(p){this._csiHandlerFb=p}registerDcsHandler(p,v){return this._dcsParser.registerHandler(this._identifier(p),v)}clearDcsHandler(p){this._dcsParser.clearHandler(this._identifier(p))}setDcsHandlerFallback(p){this._dcsParser.setHandlerFallback(p)}registerOscHandler(p,v){return this._oscParser.registerHandler(p,v)}clearOscHandler(p){this._oscParser.clearHandler(p)}setOscHandlerFallback(p){this._oscParser.setHandlerFallback(p)}setErrorHandler(p){this._errorHandler=p}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(p,v,e,i,t){this._parseStack.state=p,this._parseStack.handlers=v,this._parseStack.handlerPos=e,this._parseStack.transition=i,this._parseStack.chunkPos=t}parse(p,v,e){let i,t=0,n=0,r=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,r=this._parseStack.chunkPos+1;else{if(e===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let a=this._parseStack.handlers,l=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(e===!1&&l>-1){for(;l>=0&&(i=a[l](this._params),i!==!0);l--)if(i instanceof Promise)return this._parseStack.handlerPos=l,i}this._parseStack.handlers=[];break;case 4:if(e===!1&&l>-1){for(;l>=0&&(i=a[l](),i!==!0);l--)if(i instanceof Promise)return this._parseStack.handlerPos=l,i}this._parseStack.handlers=[];break;case 6:if(t=p[this._parseStack.chunkPos],i=this._dcsParser.unhook(t!==24&&t!==26,e),i)return i;t===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(t=p[this._parseStack.chunkPos],i=this._oscParser.end(t!==24&&t!==26,e),i)return i;t===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,r=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let a=r;a<v;++a){switch(t=p[a],n=this._transitions.table[this.currentState<<8|(t<160?t:A)],n>>4){case 2:for(let b=a+1;;++b){if(b>=v||(t=p[b])<32||t>126&&t<A){this._printHandler(p,a,b),a=b-1;break}if(++b>=v||(t=p[b])<32||t>126&&t<A){this._printHandler(p,a,b),a=b-1;break}if(++b>=v||(t=p[b])<32||t>126&&t<A){this._printHandler(p,a,b),a=b-1;break}if(++b>=v||(t=p[b])<32||t>126&&t<A){this._printHandler(p,a,b),a=b-1;break}}break;case 3:this._executeHandlers[t]?this._executeHandlers[t]():this._executeHandlerFb(t),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:a,code:t,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let l=this._csiHandlers[this._collect<<8|t],g=l?l.length-1:-1;for(;g>=0&&(i=l[g](this._params),i!==!0);g--)if(i instanceof Promise)return this._preserveStack(3,l,g,n,a),i;g<0&&this._csiHandlerFb(this._collect<<8|t,this._params),this.precedingCodepoint=0;break;case 8:do switch(t){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(t-48)}while(++a<v&&(t=p[a])>47&&t<60);a--;break;case 9:this._collect<<=8,this._collect|=t;break;case 10:let D=this._escHandlers[this._collect<<8|t],C=D?D.length-1:-1;for(;C>=0&&(i=D[C](),i!==!0);C--)if(i instanceof Promise)return this._preserveStack(4,D,C,n,a),i;C<0&&this._escHandlerFb(this._collect<<8|t),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|t,this._params);break;case 13:for(let b=a+1;;++b)if(b>=v||(t=p[b])===24||t===26||t===27||t>127&&t<A){this._dcsParser.put(p,a,b),a=b-1;break}break;case 14:if(i=this._dcsParser.unhook(t!==24&&t!==26),i)return this._preserveStack(6,[],0,n,a),i;t===27&&(n|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let b=a+1;;b++)if(b>=v||(t=p[b])<32||t>127&&t<A){this._oscParser.put(p,a,b),a=b-1;break}break;case 6:if(i=this._oscParser.end(t!==24&&t!==26),i)return this._preserveStack(5,[],0,n,a),i;t===27&&(n|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&n}}}u.EscapeSequenceParser=S},6242:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.OscHandler=u.OscParser=void 0;let y=_(5770),w=_(482),R=[];u.OscParser=class{constructor(){this._state=0,this._active=R,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(x,P){this._handlers[x]===void 0&&(this._handlers[x]=[]);let A=this._handlers[x];return A.push(P),{dispose:()=>{let S=A.indexOf(P);S!==-1&&A.splice(S,1)}}}clearHandler(x){this._handlers[x]&&delete this._handlers[x]}setHandlerFallback(x){this._handlerFb=x}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=R}reset(){if(this._state===2)for(let x=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;x>=0;--x)this._active[x].end(!1);this._stack.paused=!1,this._active=R,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||R,this._active.length)for(let x=this._active.length-1;x>=0;x--)this._active[x].start();else this._handlerFb(this._id,"START")}_put(x,P,A){if(this._active.length)for(let S=this._active.length-1;S>=0;S--)this._active[S].put(x,P,A);else this._handlerFb(this._id,"PUT",(0,w.utf32ToString)(x,P,A))}start(){this.reset(),this._state=1}put(x,P,A){if(this._state!==3){if(this._state===1)for(;P<A;){let S=x[P++];if(S===59){this._state=2,this._start();break}if(S<48||57<S)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+S-48}this._state===2&&A-P>0&&this._put(x,P,A)}}end(x,P=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let A=!1,S=this._active.length-1,c=!1;if(this._stack.paused&&(S=this._stack.loopPosition-1,A=P,c=this._stack.fallThrough,this._stack.paused=!1),!c&&A===!1){for(;S>=0&&(A=this._active[S].end(x),A!==!0);S--)if(A instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=S,this._stack.fallThrough=!1,A;S--}for(;S>=0;S--)if(A=this._active[S].end(!1),A instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=S,this._stack.fallThrough=!0,A}else this._handlerFb(this._id,"END",x);this._active=R,this._id=-1,this._state=0}}},u.OscHandler=class{constructor(x){this._handler=x,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(x,P,A){this._hitLimit||(this._data+=(0,w.utf32ToString)(x,P,A),this._data.length>y.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(x){let P=!1;if(this._hitLimit)P=!1;else if(x&&(P=this._handler(this._data),P instanceof Promise))return P.then(A=>(this._data="",this._hitLimit=!1,A));return this._data="",this._hitLimit=!1,P}}},8742:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.Params=void 0;let _=2147483647;class y{constructor(R=32,x=32){if(this.maxLength=R,this.maxSubParamsLength=x,x>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(R),this.length=0,this._subParams=new Int32Array(x),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(R),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(R){let x=new y;if(!R.length)return x;for(let P=Array.isArray(R[0])?1:0;P<R.length;++P){let A=R[P];if(Array.isArray(A))for(let S=0;S<A.length;++S)x.addSubParam(A[S]);else x.addParam(A)}return x}clone(){let R=new y(this.maxLength,this.maxSubParamsLength);return R.params.set(this.params),R.length=this.length,R._subParams.set(this._subParams),R._subParamsLength=this._subParamsLength,R._subParamsIdx.set(this._subParamsIdx),R._rejectDigits=this._rejectDigits,R._rejectSubDigits=this._rejectSubDigits,R._digitIsSub=this._digitIsSub,R}toArray(){let R=[];for(let x=0;x<this.length;++x){R.push(this.params[x]);let P=this._subParamsIdx[x]>>8,A=255&this._subParamsIdx[x];A-P>0&&R.push(Array.prototype.slice.call(this._subParams,P,A))}return R}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(R){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(R<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=R>_?_:R}}addSubParam(R){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(R<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=R>_?_:R,this._subParamsIdx[this.length-1]++}}hasSubParams(R){return(255&this._subParamsIdx[R])-(this._subParamsIdx[R]>>8)>0}getSubParams(R){let x=this._subParamsIdx[R]>>8,P=255&this._subParamsIdx[R];return P-x>0?this._subParams.subarray(x,P):null}getSubParamsAll(){let R={};for(let x=0;x<this.length;++x){let P=this._subParamsIdx[x]>>8,A=255&this._subParamsIdx[x];A-P>0&&(R[x]=this._subParams.slice(P,A))}return R}addDigit(R){let x;if(this._rejectDigits||!(x=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let P=this._digitIsSub?this._subParams:this.params,A=P[x-1];P[x-1]=~A?Math.min(10*A+R,_):R}}u.Params=y},5741:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.AddonManager=void 0,u.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let _=this._addons.length-1;_>=0;_--)this._addons[_].instance.dispose()}loadAddon(_,y){let w={instance:y,dispose:y.dispose,isDisposed:!1};this._addons.push(w),y.dispose=()=>this._wrappedAddonDispose(w),y.activate(_)}_wrappedAddonDispose(_){if(_.isDisposed)return;let y=-1;for(let w=0;w<this._addons.length;w++)if(this._addons[w]===_){y=w;break}if(y===-1)throw new Error("Could not dispose an addon that has not been loaded");_.isDisposed=!0,_.dispose.apply(_.instance),this._addons.splice(y,1)}}},8771:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.BufferApiView=void 0;let y=_(3785),w=_(511);u.BufferApiView=class{constructor(R,x){this._buffer=R,this.type=x}init(R){return this._buffer=R,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(R){let x=this._buffer.lines.get(R);if(x)return new y.BufferLineApiView(x)}getNullCell(){return new w.CellData}}},3785:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.BufferLineApiView=void 0;let y=_(511);u.BufferLineApiView=class{constructor(w){this._line=w}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(w,R){if(!(w<0||w>=this._line.length))return R?(this._line.loadCell(w,R),R):this._line.loadCell(w,new y.CellData)}translateToString(w,R,x){return this._line.translateToString(w,R,x)}}},8285:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.BufferNamespaceApi=void 0;let y=_(8771),w=_(8460);u.BufferNamespaceApi=class{constructor(R){this._core=R,this._onBufferChange=new w.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new y.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new y.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.ParserApi=void 0,u.ParserApi=class{constructor(_){this._core=_}registerCsiHandler(_,y){return this._core.registerCsiHandler(_,w=>y(w.toArray()))}addCsiHandler(_,y){return this.registerCsiHandler(_,y)}registerDcsHandler(_,y){return this._core.registerDcsHandler(_,(w,R)=>y(w,R.toArray()))}addDcsHandler(_,y){return this.registerDcsHandler(_,y)}registerEscHandler(_,y){return this._core.registerEscHandler(_,y)}addEscHandler(_,y){return this.registerEscHandler(_,y)}registerOscHandler(_,y){return this._core.registerOscHandler(_,y)}addOscHandler(_,y){return this.registerOscHandler(_,y)}}},7090:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.UnicodeApi=void 0,u.UnicodeApi=class{constructor(_){this._core=_}register(_){this._core.unicodeService.register(_)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(_){this._core.unicodeService.activeVersion=_}}},744:function(B,u,_){var y=this&&this.__decorate||function(c,p,v,e){var i,t=arguments.length,n=t<3?p:e===null?e=Object.getOwnPropertyDescriptor(p,v):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(c,p,v,e);else for(var r=c.length-1;r>=0;r--)(i=c[r])&&(n=(t<3?i(n):t>3?i(p,v,n):i(p,v))||n);return t>3&&n&&Object.defineProperty(p,v,n),n},w=this&&this.__param||function(c,p){return function(v,e){p(v,e,c)}};Object.defineProperty(u,"__esModule",{value:!0}),u.BufferService=u.MINIMUM_ROWS=u.MINIMUM_COLS=void 0;let R=_(2585),x=_(5295),P=_(8460),A=_(844);u.MINIMUM_COLS=2,u.MINIMUM_ROWS=1;let S=class extends A.Disposable{constructor(c){super(),this.isUserScrolling=!1,this._onResize=this.register(new P.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new P.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(c.rawOptions.cols||0,u.MINIMUM_COLS),this.rows=Math.max(c.rawOptions.rows||0,u.MINIMUM_ROWS),this.buffers=this.register(new x.BufferSet(c,this))}get buffer(){return this.buffers.active}resize(c,p){this.cols=c,this.rows=p,this.buffers.resize(c,p),this._onResize.fire({cols:c,rows:p})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(c,p=!1){let v=this.buffer,e;e=this._cachedBlankLine,e&&e.length===this.cols&&e.getFg(0)===c.fg&&e.getBg(0)===c.bg||(e=v.getBlankLine(c,p),this._cachedBlankLine=e),e.isWrapped=p;let i=v.ybase+v.scrollTop,t=v.ybase+v.scrollBottom;if(v.scrollTop===0){let n=v.lines.isFull;t===v.lines.length-1?n?v.lines.recycle().copyFrom(e):v.lines.push(e.clone()):v.lines.splice(t+1,0,e.clone()),n?this.isUserScrolling&&(v.ydisp=Math.max(v.ydisp-1,0)):(v.ybase++,this.isUserScrolling||v.ydisp++)}else{let n=t-i+1;v.lines.shiftElements(i+1,n-1,-1),v.lines.set(t,e.clone())}this.isUserScrolling||(v.ydisp=v.ybase),this._onScroll.fire(v.ydisp)}scrollLines(c,p,v){let e=this.buffer;if(c<0){if(e.ydisp===0)return;this.isUserScrolling=!0}else c+e.ydisp>=e.ybase&&(this.isUserScrolling=!1);let i=e.ydisp;e.ydisp=Math.max(Math.min(e.ydisp+c,e.ybase),0),i!==e.ydisp&&(p||this._onScroll.fire(e.ydisp))}scrollPages(c){this.scrollLines(c*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(c){let p=c-this.buffer.ydisp;p!==0&&this.scrollLines(p)}};S=y([w(0,R.IOptionsService)],S),u.BufferService=S},7994:(B,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.CharsetService=void 0,u.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(_){this.glevel=_,this.charset=this._charsets[_]}setgCharset(_,y){this._charsets[_]=y,this.glevel===_&&(this.charset=y)}}},1753:function(B,u,_){var y=this&&this.__decorate||function(e,i,t,n){var r,a=arguments.length,l=a<3?i:n===null?n=Object.getOwnPropertyDescriptor(i,t):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(e,i,t,n);else for(var g=e.length-1;g>=0;g--)(r=e[g])&&(l=(a<3?r(l):a>3?r(i,t,l):r(i,t))||l);return a>3&&l&&Object.defineProperty(i,t,l),l},w=this&&this.__param||function(e,i){return function(t,n){i(t,n,e)}};Object.defineProperty(u,"__esModule",{value:!0}),u.CoreMouseService=void 0;let R=_(2585),x=_(8460),P=_(844),A={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:e=>e.button!==4&&e.action===1&&(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)},VT200:{events:19,restrict:e=>e.action!==32},DRAG:{events:23,restrict:e=>e.action!==32||e.button!==3},ANY:{events:31,restrict:e=>!0}};function S(e,i){let t=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return e.button===4?(t|=64,t|=e.action):(t|=3&e.button,4&e.button&&(t|=64),8&e.button&&(t|=128),e.action===32?t|=32:e.action!==0||i||(t|=3)),t}let c=String.fromCharCode,p={DEFAULT:e=>{let i=[S(e,!1)+32,e.col+32,e.row+32];return i[0]>255||i[1]>255||i[2]>255?"":`\x1B[M${c(i[0])}${c(i[1])}${c(i[2])}`},SGR:e=>{let i=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${S(e,!0)};${e.col};${e.row}${i}`},SGR_PIXELS:e=>{let i=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${S(e,!0)};${e.x};${e.y}${i}`}},v=class extends P.Disposable{constructor(e,i){super(),this._bufferService=e,this._coreService=i,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new x.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(let t of Object.keys(A))this.addProtocol(t,A[t]);for(let t of Object.keys(p))this.addEncoding(t,p[t]);this.reset()}addProtocol(e,i){this._protocols[e]=i}addEncoding(e,i){this._encodings[e]=i}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(e){if(!this._protocols[e])throw new Error(`unknown protocol "${e}"`);this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(e){if(!this._encodings[e])throw new Error(`unknown encoding "${e}"`);this._activeEncoding=e}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows||e.button===4&&e.action===32||e.button===3&&e.action!==32||e.button!==4&&(e.action===2||e.action===3)||(e.col++,e.row++,e.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,e,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(e))return!1;let i=this._encodings[this._activeEncoding](e);return i&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(i):this._coreService.triggerDataEvent(i,!0)),this._lastEvent=e,!0}explainEvents(e){return{down:!!(1&e),up:!!(2&e),drag:!!(4&e),move:!!(8&e),wheel:!!(16&e)}}_equalEvents(e,i,t){if(t){if(e.x!==i.x||e.y!==i.y)return!1}else if(e.col!==i.col||e.row!==i.row)return!1;return e.button===i.button&&e.action===i.action&&e.ctrl===i.ctrl&&e.alt===i.alt&&e.shift===i.shift}};v=y([w(0,R.IBufferService),w(1,R.ICoreService)],v),u.CoreMouseService=v},6975:function(B,u,_){var y=this&&this.__decorate||function(v,e,i,t){var n,r=arguments.length,a=r<3?e:t===null?t=Object.getOwnPropertyDescriptor(e,i):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(v,e,i,t);else for(var l=v.length-1;l>=0;l--)(n=v[l])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},w=this&&this.__param||function(v,e){return function(i,t){e(i,t,v)}};Object.defineProperty(u,"__esModule",{value:!0}),u.CoreService=void 0;let R=_(2585),x=_(8460),P=_(1439),A=_(844),S=Object.freeze({insertMode:!1}),c=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),p=class extends A.Disposable{constructor(v,e,i){super(),this._bufferService=v,this._logService=e,this._optionsService=i,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new x.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new x.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new x.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new x.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,P.clone)(S),this.decPrivateModes=(0,P.clone)(c)}reset(){this.modes=(0,P.clone)(S),this.decPrivateModes=(0,P.clone)(c)}triggerDataEvent(v,e=!1){if(this._optionsService.rawOptions.disableStdin)return;let i=this._bufferService.buffer;e&&this._optionsService.rawOptions.scrollOnUserInput&&i.ybase!==i.ydisp&&this._onRequestScrollToBottom.fire(),e&&this._onUserInput.fire(),this._logService.debug(`sending data "${v}"`,()=>v.split("").map(t=>t.charCodeAt(0))),this._onData.fire(v)}triggerBinaryEvent(v){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${v}"`,()=>v.split("").map(e=>e.charCodeAt(0))),this._onBinary.fire(v))}};p=y([w(0,R.IBufferService),w(1,R.ILogService),w(2,R.IOptionsService)],p),u.CoreService=p},9074:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.DecorationService=void 0;let y=_(8055),w=_(8460),R=_(844),x=_(6106),P=0,A=0;class S extends R.Disposable{constructor(){super(),this._decorations=new x.SortedList(v=>v==null?void 0:v.marker.line),this._onDecorationRegistered=this.register(new w.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new w.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,R.toDisposable)(()=>{for(let v of this._decorations.values())this._onDecorationRemoved.fire(v);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(v){if(v.marker.isDisposed)return;let e=new c(v);if(e){let i=e.marker.onDispose(()=>e.dispose());e.onDispose(()=>{e&&(this._decorations.delete(e)&&this._onDecorationRemoved.fire(e),i.dispose())}),this._decorations.insert(e),this._onDecorationRegistered.fire(e)}return e}reset(){for(let v of this._decorations.values())v.dispose();this._decorations.clear()}*getDecorationsAtCell(v,e,i){var t,n,r;let a=0,l=0;for(let g of this._decorations.getKeyIterator(e))a=(t=g.options.x)!==null&&t!==void 0?t:0,l=a+((n=g.options.width)!==null&&n!==void 0?n:1),v>=a&&v<l&&(!i||((r=g.options.layer)!==null&&r!==void 0?r:"bottom")===i)&&(yield g)}forEachDecorationAtCell(v,e,i,t){this._decorations.forEachByKey(e,n=>{var r,a,l;P=(r=n.options.x)!==null&&r!==void 0?r:0,A=P+((a=n.options.width)!==null&&a!==void 0?a:1),v>=P&&v<A&&(!i||((l=n.options.layer)!==null&&l!==void 0?l:"bottom")===i)&&t(n)})}dispose(){for(let v of this._decorations.values())this._onDecorationRemoved.fire(v);this.reset()}}u.DecorationService=S;class c extends R.Disposable{constructor(v){super(),this.options=v,this.isDisposed=!1,this.onRenderEmitter=this.register(new w.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new w.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=v.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=y.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=y.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.InstantiationService=u.ServiceCollection=void 0;let y=_(2585),w=_(8343);class R{constructor(...P){this._entries=new Map;for(let[A,S]of P)this.set(A,S)}set(P,A){let S=this._entries.get(P);return this._entries.set(P,A),S}forEach(P){for(let[A,S]of this._entries.entries())P(A,S)}has(P){return this._entries.has(P)}get(P){return this._entries.get(P)}}u.ServiceCollection=R,u.InstantiationService=class{constructor(){this._services=new R,this._services.set(y.IInstantiationService,this)}setService(x,P){this._services.set(x,P)}getService(x){return this._services.get(x)}createInstance(x,...P){let A=(0,w.getServiceDependencies)(x).sort((p,v)=>p.index-v.index),S=[];for(let p of A){let v=this._services.get(p.id);if(!v)throw new Error(`[createInstance] ${x.name} depends on UNKNOWN service ${p.id}.`);S.push(v)}let c=A.length>0?A[0].index:P.length;if(P.length!==c)throw new Error(`[createInstance] First service dependency of ${x.name} at position ${c+1} conflicts with ${P.length} static arguments`);return new x(...P,...S)}}},7866:function(B,u,_){var y=this&&this.__decorate||function(S,c,p,v){var e,i=arguments.length,t=i<3?c:v===null?v=Object.getOwnPropertyDescriptor(c,p):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")t=Reflect.decorate(S,c,p,v);else for(var n=S.length-1;n>=0;n--)(e=S[n])&&(t=(i<3?e(t):i>3?e(c,p,t):e(c,p))||t);return i>3&&t&&Object.defineProperty(c,p,t),t},w=this&&this.__param||function(S,c){return function(p,v){c(p,v,S)}};Object.defineProperty(u,"__esModule",{value:!0}),u.LogService=void 0;let R=_(844),x=_(2585),P={debug:x.LogLevelEnum.DEBUG,info:x.LogLevelEnum.INFO,warn:x.LogLevelEnum.WARN,error:x.LogLevelEnum.ERROR,off:x.LogLevelEnum.OFF},A=class extends R.Disposable{constructor(S){super(),this._optionsService=S,this.logLevel=x.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=P[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(S){for(let c=0;c<S.length;c++)typeof S[c]=="function"&&(S[c]=S[c]())}_log(S,c,p){this._evalLazyOptionalParams(p),S.call(console,"xterm.js: "+c,...p)}debug(S,...c){this.logLevel<=x.LogLevelEnum.DEBUG&&this._log(console.log,S,c)}info(S,...c){this.logLevel<=x.LogLevelEnum.INFO&&this._log(console.info,S,c)}warn(S,...c){this.logLevel<=x.LogLevelEnum.WARN&&this._log(console.warn,S,c)}error(S,...c){this.logLevel<=x.LogLevelEnum.ERROR&&this._log(console.error,S,c)}};A=y([w(0,x.IOptionsService)],A),u.LogService=A},7302:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.OptionsService=u.DEFAULT_OPTIONS=void 0;let y=_(8460),w=_(6114),R=_(844);u.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:w.isMac,windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};let x=["normal","bold","100","200","300","400","500","600","700","800","900"];class P extends R.Disposable{constructor(S){super(),this._onOptionChange=this.register(new y.EventEmitter),this.onOptionChange=this._onOptionChange.event;let c=Object.assign({},u.DEFAULT_OPTIONS);for(let p in S)if(p in c)try{let v=S[p];c[p]=this._sanitizeAndValidateOption(p,v)}catch(v){console.error(v)}this.rawOptions=c,this.options=Object.assign({},c),this._setupOptions()}onSpecificOptionChange(S,c){return this.onOptionChange(p=>{p===S&&c(this.rawOptions[S])})}onMultipleOptionChange(S,c){return this.onOptionChange(p=>{S.indexOf(p)!==-1&&c()})}_setupOptions(){let S=p=>{if(!(p in u.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);return this.rawOptions[p]},c=(p,v)=>{if(!(p in u.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);v=this._sanitizeAndValidateOption(p,v),this.rawOptions[p]!==v&&(this.rawOptions[p]=v,this._onOptionChange.fire(p))};for(let p in this.rawOptions){let v={get:S.bind(this,p),set:c.bind(this,p)};Object.defineProperty(this.options,p,v)}}_sanitizeAndValidateOption(S,c){switch(S){case"cursorStyle":if(c||(c=u.DEFAULT_OPTIONS[S]),!function(p){return p==="block"||p==="underline"||p==="bar"}(c))throw new Error(`"${c}" is not a valid value for ${S}`);break;case"wordSeparator":c||(c=u.DEFAULT_OPTIONS[S]);break;case"fontWeight":case"fontWeightBold":if(typeof c=="number"&&1<=c&&c<=1e3)break;c=x.includes(c)?c:u.DEFAULT_OPTIONS[S];break;case"cursorWidth":c=Math.floor(c);case"lineHeight":case"tabStopWidth":if(c<1)throw new Error(`${S} cannot be less than 1, value: ${c}`);break;case"minimumContrastRatio":c=Math.max(1,Math.min(21,Math.round(10*c)/10));break;case"scrollback":if((c=Math.min(c,4294967295))<0)throw new Error(`${S} cannot be less than 0, value: ${c}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(c<=0)throw new Error(`${S} cannot be less than or equal to 0, value: ${c}`);case"rows":case"cols":if(!c&&c!==0)throw new Error(`${S} must be numeric, value: ${c}`)}return c}}u.OptionsService=P},2660:function(B,u,_){var y=this&&this.__decorate||function(P,A,S,c){var p,v=arguments.length,e=v<3?A:c===null?c=Object.getOwnPropertyDescriptor(A,S):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")e=Reflect.decorate(P,A,S,c);else for(var i=P.length-1;i>=0;i--)(p=P[i])&&(e=(v<3?p(e):v>3?p(A,S,e):p(A,S))||e);return v>3&&e&&Object.defineProperty(A,S,e),e},w=this&&this.__param||function(P,A){return function(S,c){A(S,c,P)}};Object.defineProperty(u,"__esModule",{value:!0}),u.OscLinkService=void 0;let R=_(2585),x=class{constructor(P){this._bufferService=P,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(P){let A=this._bufferService.buffer;if(P.id===void 0){let i=A.addMarker(A.ybase+A.y),t={data:P,id:this._nextId++,lines:[i]};return i.onDispose(()=>this._removeMarkerFromLink(t,i)),this._dataByLinkId.set(t.id,t),t.id}let S=P,c=this._getEntryIdKey(S),p=this._entriesWithId.get(c);if(p)return this.addLineToLink(p.id,A.ybase+A.y),p.id;let v=A.addMarker(A.ybase+A.y),e={id:this._nextId++,key:this._getEntryIdKey(S),data:S,lines:[v]};return v.onDispose(()=>this._removeMarkerFromLink(e,v)),this._entriesWithId.set(e.key,e),this._dataByLinkId.set(e.id,e),e.id}addLineToLink(P,A){let S=this._dataByLinkId.get(P);if(S&&S.lines.every(c=>c.line!==A)){let c=this._bufferService.buffer.addMarker(A);S.lines.push(c),c.onDispose(()=>this._removeMarkerFromLink(S,c))}}getLinkData(P){var A;return(A=this._dataByLinkId.get(P))===null||A===void 0?void 0:A.data}_getEntryIdKey(P){return`${P.id};;${P.uri}`}_removeMarkerFromLink(P,A){let S=P.lines.indexOf(A);S!==-1&&(P.lines.splice(S,1),P.lines.length===0&&(P.data.id!==void 0&&this._entriesWithId.delete(P.key),this._dataByLinkId.delete(P.id)))}};x=y([w(0,R.IBufferService)],x),u.OscLinkService=x},8343:(B,u)=>{function _(y,w,R){w.di$target===w?w.di$dependencies.push({id:y,index:R}):(w.di$dependencies=[{id:y,index:R}],w.di$target=w)}Object.defineProperty(u,"__esModule",{value:!0}),u.createDecorator=u.getServiceDependencies=u.serviceRegistry=void 0,u.serviceRegistry=new Map,u.getServiceDependencies=function(y){return y.di$dependencies||[]},u.createDecorator=function(y){if(u.serviceRegistry.has(y))return u.serviceRegistry.get(y);let w=function(R,x,P){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");_(w,R,P)};return w.toString=()=>y,u.serviceRegistry.set(y,w),w}},2585:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.IDecorationService=u.IUnicodeService=u.IOscLinkService=u.IOptionsService=u.ILogService=u.LogLevelEnum=u.IInstantiationService=u.ICharsetService=u.ICoreService=u.ICoreMouseService=u.IBufferService=void 0;let y=_(8343);var w;u.IBufferService=(0,y.createDecorator)("BufferService"),u.ICoreMouseService=(0,y.createDecorator)("CoreMouseService"),u.ICoreService=(0,y.createDecorator)("CoreService"),u.ICharsetService=(0,y.createDecorator)("CharsetService"),u.IInstantiationService=(0,y.createDecorator)("InstantiationService"),(w=u.LogLevelEnum||(u.LogLevelEnum={}))[w.DEBUG=0]="DEBUG",w[w.INFO=1]="INFO",w[w.WARN=2]="WARN",w[w.ERROR=3]="ERROR",w[w.OFF=4]="OFF",u.ILogService=(0,y.createDecorator)("LogService"),u.IOptionsService=(0,y.createDecorator)("OptionsService"),u.IOscLinkService=(0,y.createDecorator)("OscLinkService"),u.IUnicodeService=(0,y.createDecorator)("UnicodeService"),u.IDecorationService=(0,y.createDecorator)("DecorationService")},1480:(B,u,_)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.UnicodeService=void 0;let y=_(8460),w=_(225);u.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new y.EventEmitter,this.onChange=this._onChange.event;let R=new w.UnicodeV6;this.register(R),this._active=R.version,this._activeProvider=R}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(R){if(!this._providers[R])throw new Error(`unknown Unicode version "${R}"`);this._active=R,this._activeProvider=this._providers[R],this._onChange.fire(R)}register(R){this._providers[R.version]=R}wcwidth(R){return this._activeProvider.wcwidth(R)}getStringCellWidth(R){let x=0,P=R.length;for(let A=0;A<P;++A){let S=R.charCodeAt(A);if(55296<=S&&S<=56319){if(++A>=P)return x+this.wcwidth(S);let c=R.charCodeAt(A);56320<=c&&c<=57343?S=1024*(S-55296)+c-56320+65536:x+=this.wcwidth(c)}x+=this.wcwidth(S)}return x}}}},d={};function k(B){var u=d[B];if(u!==void 0)return u.exports;var _=d[B]={exports:{}};return o[B].call(_.exports,_,_.exports,k),_.exports}var M={};return(()=>{var B=M;Object.defineProperty(B,"__esModule",{value:!0}),B.Terminal=void 0;let u=k(3236),_=k(9042),y=k(7975),w=k(7090),R=k(5741),x=k(8285),P=["cols","rows"];B.Terminal=class{constructor(A){this._core=new u.Terminal(A),this._addonManager=new R.AddonManager,this._publicOptions=Object.assign({},this._core.options);let S=p=>this._core.options[p],c=(p,v)=>{this._checkReadonlyOptions(p),this._core.options[p]=v};for(let p in this._core.options){let v={get:S.bind(this,p),set:c.bind(this,p)};Object.defineProperty(this._publicOptions,p,v)}}_checkReadonlyOptions(A){if(P.includes(A))throw new Error(`Option "${A}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new y.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new w.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new x.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let A=this._core.coreService.decPrivateModes,S="none";switch(this._core.coreMouseService.activeProtocol){case"X10":S="x10";break;case"VT200":S="vt200";break;case"DRAG":S="drag";break;case"ANY":S="any"}return{applicationCursorKeysMode:A.applicationCursorKeys,applicationKeypadMode:A.applicationKeypad,bracketedPasteMode:A.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:S,originMode:A.origin,reverseWraparoundMode:A.reverseWraparound,sendFocusMode:A.sendFocus,wraparoundMode:A.wraparound}}get options(){return this._publicOptions}set options(A){for(let S in A)this._publicOptions[S]=A[S]}blur(){this._core.blur()}focus(){this._core.focus()}resize(A,S){this._verifyIntegers(A,S),this._core.resize(A,S)}open(A){this._core.open(A)}attachCustomKeyEventHandler(A){this._core.attachCustomKeyEventHandler(A)}registerLinkProvider(A){return this._core.registerLinkProvider(A)}registerCharacterJoiner(A){return this._checkProposedApi(),this._core.registerCharacterJoiner(A)}deregisterCharacterJoiner(A){this._checkProposedApi(),this._core.deregisterCharacterJoiner(A)}registerMarker(A=0){return this._verifyIntegers(A),this._core.addMarker(A)}registerDecoration(A){var S,c,p;return this._checkProposedApi(),this._verifyPositiveIntegers((S=A.x)!==null&&S!==void 0?S:0,(c=A.width)!==null&&c!==void 0?c:0,(p=A.height)!==null&&p!==void 0?p:0),this._core.registerDecoration(A)}hasSelection(){return this._core.hasSelection()}select(A,S,c){this._verifyIntegers(A,S,c),this._core.select(A,S,c)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(A,S){this._verifyIntegers(A,S),this._core.selectLines(A,S)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(A){this._verifyIntegers(A),this._core.scrollLines(A)}scrollPages(A){this._verifyIntegers(A),this._core.scrollPages(A)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(A){this._verifyIntegers(A),this._core.scrollToLine(A)}clear(){this._core.clear()}write(A,S){this._core.write(A,S)}writeln(A,S){this._core.write(A),this._core.write(`\r
`,S)}paste(A){this._core.paste(A)}refresh(A,S){this._verifyIntegers(A,S),this._core.refresh(A,S)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(A){return this._addonManager.loadAddon(this,A)}static get strings(){return _}_verifyIntegers(...A){for(let S of A)if(S===1/0||isNaN(S)||S%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...A){for(let S of A)if(S&&(S===1/0||isNaN(S)||S%1!=0||S<0))throw new Error("This API only accepts positive integers")}}})(),M})()})});var Oa=rt(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.parseInput=rr.InputType=void 0;var ze;(function(o){o[o.Text=0]="Text",o[o.AltEnter=1]="AltEnter",o[o.ArrowUp=2]="ArrowUp",o[o.ArrowDown=3]="ArrowDown",o[o.ArrowLeft=4]="ArrowLeft",o[o.ArrowRight=5]="ArrowRight",o[o.Delete=6]="Delete",o[o.Backspace=7]="Backspace",o[o.CtrlA=8]="CtrlA",o[o.CtrlC=9]="CtrlC",o[o.CtrlD=10]="CtrlD",o[o.CtrlE=11]="CtrlE",o[o.CtrlK=12]="CtrlK",o[o.CtrlL=13]="CtrlL",o[o.CtrlQ=14]="CtrlQ",o[o.CtrlS=15]="CtrlS",o[o.CtrlU=16]="CtrlU",o[o.End=17]="End",o[o.Enter=18]="Enter",o[o.Home=19]="Home",o[o.ShiftEnter=20]="ShiftEnter",o[o.UnsupportedControlChar=21]="UnsupportedControlChar",o[o.UnsupportedEscape=22]="UnsupportedEscape"})(ze=rr.InputType||(rr.InputType={}));function Il(o){return Array.from(Nl(o))}rr.parseInput=Il;function*Nl(o){let d=[],k=o[Symbol.iterator]();for(let M=k.next();!M.done;M=k.next()){let B=M.value;if(B.length>1){d.push(B);continue}let u=B.charCodeAt(0);if(d.length>0&&(u<32||u===127)&&(yield{inputType:ze.Text,data:d},d=[]),u===27){let _=k.next();if(_.done){d.push("\x1B");continue}let y=ze.UnsupportedEscape;if(_.value!=="["){switch(_.value){case"\r":y=ze.AltEnter;break}yield{inputType:y,data:["\x1B",_.value]};continue}let w=k.next();if(w.done)continue;if(w.value>="0"&&w.value<="9"){let R=w.value,x=k.next();if(x.done)return;if(x.value>="0"&&x.value<="9")R+=x.value;else if(x.value!=="~")continue;switch(R){case"3":y=ze.Delete;break}yield{inputType:y,data:["\x1B","[",R,"~"]};continue}switch(w.value){case"A":y=ze.ArrowUp;break;case"B":y=ze.ArrowDown;break;case"C":y=ze.ArrowRight;break;case"D":y=ze.ArrowLeft;break;case"F":y=ze.End;break;case"H":y=ze.Home;break;case"\r":y=ze.AltEnter;break}yield{inputType:y,data:["\x1B","[",w.value]};continue}if(u<32||u===127){let _=ze.UnsupportedControlChar;switch(u){case 1:_=ze.CtrlA;break;case 3:_=ze.CtrlC;break;case 4:_=ze.CtrlD;break;case 5:_=ze.CtrlE;break;case 11:_=ze.CtrlK;break;case 17:_=ze.CtrlQ;break;case 19:_=ze.CtrlS;break;case 21:_=ze.CtrlU;break;case 13:_=ze.Enter;break;case 127:_=ze.Backspace;break;case 12:_=ze.CtrlL;break}yield{inputType:_,data:[B]};continue}d.push(B)}d.length>0&&(yield{inputType:ze.Text,data:d})}});var Ba=rt(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.LineBuffer=void 0;var tn=class{constructor(){this.buf="",this.pos=0}buffer(){return this.buf}pos_buffer(){return this.buf.slice(0,this.pos)}length(){return this.buf.length}char_length(){return[...this.buf].length}update(d,k){this.buf=d,this.pos=k}insert(d){let k=d.length,M=this.pos===this.buf.length;return M?this.buf=this.buf+d:this.buf=this.buf.slice(0,this.pos)+d+this.buf.slice(this.pos),this.pos+=k,M}moveBack(d){let k=this.prevPos(d);return k!==void 0?(this.pos=k,!0):!1}moveForward(d){let k=this.nextPos(d);return k!==void 0?(this.pos=k,!0):!1}moveHome(){let d=this.startOfLine();return this.pos>d?(this.pos=d,!0):!1}moveEnd(){let d=this.endOfLine();return this.pos===d?!1:(this.pos=d,!0)}startOfLine(){let d=this.buf.slice(0,this.pos).lastIndexOf(`
`);return d!==-1?d+1:0}endOfLine(){let d=this.buf.slice(this.pos).indexOf(`
`);return d!==-1?this.pos+d:this.buf.length}moveLineUp(d){let k=this.buf.slice(0,this.pos).lastIndexOf(`
`);if(k===-1)return!1;let M=[...this.buf.slice(k+1,this.pos)].length,B=this.buf.slice(0,k).lastIndexOf(`
`);B===-1?B=0:B=B+1;let u=k;for(let w=1;w<d&&B!==0;w++)u=B-1,B=this.buf.slice(0,u).lastIndexOf(`
`),B===-1?B=0:B=B+1;let _=[...this.buf.slice(B,u)].slice(0,M),y=k;return _.length>0&&(y=_.map(w=>w.length).reduce((w,R)=>w+R,0),y=B+y),this.pos=y,!0}moveLineDown(d){let k=this.buf.slice(this.pos).indexOf(`
`);if(k===-1)return!1;let M=this.buf.slice(0,this.pos).lastIndexOf(`
`);M===-1?M=0:M+=1;let B=[...this.buf.slice(M,this.pos)].length,u=this.pos+k+1,_=this.buf.slice(u).indexOf(`
`);_===-1?_=this.buf.length:_=u+_;for(let w=1;w<d&&_!==this.buf.length;w++)u=_+1,_=this.buf.slice(u).indexOf(`
`),_===-1?_=this.buf.length:_=u+_;let y=[...this.buf.slice(u,_)];return B<y.length?this.pos=y.slice(0,B).map(w=>w.length).reduce((w,R)=>w+R,0)+u:this.pos=_,!0}set_pos(d){this.pos=d}prevPos(d){if(this.pos===0)return;let k=this.buf.slice(0,this.pos);return this.pos-[...k].slice(-d).map(M=>M.length).reduce((M,B)=>M+B,0)}nextPos(d){if(this.pos===this.buf.length)return;let k=this.buf.slice(this.pos);return this.pos+[...k].slice(0,d).map(M=>M.length).reduce((M,B)=>M+B,0)}backspace(d){let k=this.prevPos(d);return k===void 0?!1:(this.buf=this.buf.slice(0,k)+this.buf.slice(this.pos),this.pos=k,!0)}delete(d){let k=this.nextPos(d);return k!==void 0?(this.buf=this.buf.slice(0,this.pos)+this.buf.slice(k),!0):!1}deleteEndOfLine(){if(this.buf.length==0||this.pos==this.buf.length)return!1;let d=this.pos,k=this.endOfLine();return d==k?this.delete(1):this.buf=this.buf.slice(0,d)+this.buf.slice(k),!0}};ns.LineBuffer=tn});var Ia=rt((cd,Ma)=>{"use strict";Ma.exports=({onlyFirst:o=!1}={})=>{let d=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(d,o?void 0:"g")}});var Ha=rt((hd,Na)=>{"use strict";var Hl=Ia();Na.exports=o=>typeof o=="string"?o.replace(Hl(),""):o});var ja=rt((ud,rn)=>{"use strict";var Wa=o=>Number.isNaN(o)?!1:o>=4352&&(o<=4447||o===9001||o===9002||11904<=o&&o<=12871&&o!==12351||12880<=o&&o<=19903||19968<=o&&o<=42182||43360<=o&&o<=43388||44032<=o&&o<=55203||63744<=o&&o<=64255||65040<=o&&o<=65049||65072<=o&&o<=65131||65281<=o&&o<=65376||65504<=o&&o<=65510||110592<=o&&o<=110593||127488<=o&&o<=127569||131072<=o&&o<=262141);rn.exports=Wa;rn.exports.default=Wa});var qa=rt((dd,Ua)=>{"use strict";Ua.exports=function(){return/\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F|\uD83D\uDC68(?:\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68\uD83C\uDFFB|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|[\u2695\u2696\u2708]\uFE0F|\uD83D[\uDC66\uDC67]|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708])\uFE0F|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C[\uDFFB-\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)\uD83C\uDFFB|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1)|(?:\uD83E\uDDD1\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFE])|(?:\uD83E\uDDD1\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB\uDFFC])|\uD83D\uDC69(?:\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83E\uDDD1\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFD])|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|\uD83C\uDFF4\u200D\u2620)\uFE0F|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDF6\uD83C\uDDE6|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDBB\uDDD2-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5\uDEEB\uDEEC\uDEF4-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])\uFE0F|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])/g}});var nn=rt((fd,sn)=>{"use strict";var Wl=Ha(),jl=ja(),Ul=qa(),za=o=>{if(typeof o!="string"||o.length===0||(o=Wl(o),o.length===0))return 0;o=o.replace(Ul(),"  ");let d=0;for(let k=0;k<o.length;k++){let M=o.codePointAt(k);M<=31||M>=127&&M<=159||M>=768&&M<=879||(M>65535&&k++,d+=jl(M)?2:1)}return d};sn.exports=za;sn.exports.default=za});var Ka=rt(Rt=>{"use strict";var ql=Rt&&Rt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.State=Rt.Layout=Rt.Position=void 0;var zl=Ba(),Kl=ql(nn()),jt=class{constructor(d,k){d!==void 0?this.row=d:this.row=0,k!==void 0?this.col=k:this.col=0}};Rt.Position=jt;var as=class{constructor(d){this.promptSize=d,this.cursor=new jt,this.end=new jt}};Rt.Layout=as;var an=class{constructor(d,k,M,B){this.line=new zl.LineBuffer,this.highlighting=!1,this.prompt=d,this.tty=k,this.highlighter=M,this.history=B,this.promptSize=k.calculatePosition(d,new jt),this.layout=new as(this.promptSize)}buffer(){return this.line.buffer()}shouldHighlight(){return this.highlighter.highlightChar(this.line.buf,this.line.pos)?(this.highlighting=!0,!0):this.highlighting?(this.highlighting=!1,!0):!1}clearScreen(){this.tty.clearScreen(),this.layout.cursor=new jt,this.layout.end=new jt,this.refresh()}editInsert(d){let k=this.line.insert(d),M=d.includes(`
`);if(k&&!M){let B=(0,Kl.default)(d);B>0&&this.layout.cursor.col+B<this.tty.col&&!this.shouldHighlight()?(this.layout.cursor.col+=B,this.layout.end.col+=B,this.tty.write(d)):this.refresh()}else this.refresh()}update(d){this.line.update(d,d.length),this.refresh()}editBackspace(d){this.line.backspace(d)&&this.refresh()}editDelete(d){this.line.delete(d)&&this.refresh()}editDeleteEndOfLine(){this.line.deleteEndOfLine()&&this.refresh()}refresh(){let d=this.tty.computeLayout(this.promptSize,this.line);this.tty.refreshLine(this.prompt,this.line,this.layout,d,this.highlighter),this.layout=d}moveCursorBack(d){this.line.moveBack(d)&&this.moveCursor()}moveCursorForward(d){this.line.moveForward(d)&&this.moveCursor()}moveCursorUp(d){this.line.moveLineUp(d)?this.moveCursor():this.previousHistory()}moveCursorDown(d){this.line.moveLineDown(d)?this.moveCursor():this.nextHistory()}moveCursorHome(){this.line.moveHome()&&this.moveCursor()}moveCursorEnd(){this.line.moveEnd()&&this.moveCursor()}moveCursorToEnd(){this.layout.cursor!==this.layout.end&&(this.tty.moveCursor(this.layout.cursor,this.layout.end),this.layout.cursor=Object.assign({},this.layout.end))}previousHistory(){if(this.history.cursor===-1&&this.line.length()>0)return;let d=this.history.prev();d!==void 0&&this.update(d)}nextHistory(){if(this.history.cursor===-1)return;let d=this.history.next();d!==void 0?this.update(d):this.update("")}moveCursor(){let d=this.tty.calculatePosition(this.line.pos_buffer(),this.promptSize);d!==this.layout.cursor&&(this.shouldHighlight()?this.refresh():(this.tty.moveCursor(this.layout.cursor,d),this.layout.promptSize=Object.assign({},this.promptSize),this.layout.cursor=Object.assign({},d)))}};Rt.State=an});var Va=rt(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.History=void 0;var on=class{constructor(d){this.entries=[],this.cursor=-1,this.maxEntries=d}saveToLocalStorage(){let d=window==null?void 0:window.localStorage;d!==void 0&&d.setItem("history",JSON.stringify(this.entries))}restoreFromLocalStorage(){let d=window==null?void 0:window.localStorage;if(d!==void 0){let k=d.getItem("history");if(k==null)return;try{let M=JSON.parse(k);!Array.isArray(M)||M.find(B=>typeof B!="string")!==void 0?(this.entries=[],d.setItem("history","[]")):this.entries=M}catch{this.entries=[],d.setItem("history","[]")}}}append(d){this.resetCursor(),this.entries.includes(d)?(this.entries.splice(this.entries.indexOf(d),1),this.entries.unshift(d)):this.entries.unshift(d),this.entries.length>this.maxEntries&&this.entries.pop(),this.saveToLocalStorage()}resetCursor(){this.cursor=-1}next(){if(this.cursor!==-1)return this.cursor-=1,this.entries[this.cursor]}prev(){if(!(this.cursor+1>=this.entries.length))return this.cursor+=1,this.entries[this.cursor]}};os.History=on});var Ja=rt(br=>{"use strict";var Vl=br&&br.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(br,"__esModule",{value:!0});br.Tty=void 0;var Jl=Vl(nn()),ln=class{constructor(d,k,M,B){this.tabWidth=M,this.col=d,this.row=k,this.out=B}write(d){return this.out.write(d)}print(d){return this.out.print(d)}println(d){return this.out.println(d)}clearScreen(){this.out.write("\x1B[H\x1B[2J")}calculatePosition(d,k){let M=Object.assign({},k),B=0;return[...d].forEach(u=>{if(u===`
`){M.row+=1,M.col=0;return}let _=0;if(u==="	")_=this.tabWidth-M.col%this.tabWidth;else{let y;[y,B]=Xl(u,B),_=y}M.col+=_,M.col>this.col&&(M.row+=1,M.col=_)}),M.col===this.col&&(M.col=0,M.row+=1),M}computeLayout(d,k){let M=Object.assign({},d),B=k.pos,u=this.calculatePosition(k.buf.slice(0,k.pos),d),_=B===k.buf.length?Object.assign({},u):this.calculatePosition(k.buf.slice(B),u);return{promptSize:M,cursor:u,end:_}}refreshLine(d,k,M,B,u){let _=B.cursor,y=B.end;this.clearOldRows(M),this.write(u.highlightPrompt(d)),this.write(u.highlight(k.buf,k.pos)),y.col===0&&y.row>0&&k.buf[k.buf.length-1]!==`
`&&this.write(`
`);let w=y.row-_.row;w>0&&this.write(`\x1B[${w}A`),_.col>0?this.write(`\r\x1B[${_.col}C`):this.write("\r")}clearOldRows(d){let k=d.cursor.row,M=d.end.row,B=Math.max(M-k,0);B>0&&this.write(`\x1B[${B}B`);for(let u=0;u<M;u++)this.write("\r\x1B[0K\x1B[A");this.write("\r\x1B[0K")}moveCursor(d,k){if(k.row>d.row){let M=k.row-d.row;M===1?this.write("\x1B[B"):this.write(`\x1B[${M}B`)}else if(k.row<d.row){let M=d.row-k.row;M===1?this.write("\x1B[A"):this.write(`\x1B[${M}A`)}if(k.col>d.col){let M=k.col-d.col;M===1?this.write("\x1B[C"):this.write(`\x1B[${M}C`)}else if(k.col<d.col){let M=d.col-k.col;M===1?this.write("\x1B[D"):this.write(`\x1B[${M}D`)}}};br.Tty=ln;function Xl(o,d){return d===1?o==="["?[0,2]:[0,0]:d===2?o===";"||o[0]>="0"&&o[0]<="9"?[0,d]:[0,0]:o==="\x1B"?[0,1]:o===`
`?[0,d]:[(0,Jl.default)(o),d]}});var Xa=rt(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.IdentityHighlighter=void 0;var cn=class{highlight(d,k){return d}highlightPrompt(d){return d}highlightChar(d,k){return!1}};ls.IdentityHighlighter=cn});var Ya=rt(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.Readline=void 0;var Ie=Oa(),hn=Ka(),Gl=Va(),Ga=Ja(),Yl=Xa(),un=class{constructor(){this.highlighter=new Yl.IdentityHighlighter,this.history=new Gl.History(50),this.disposables=[],this.watermark=0,this.highWatermark=1e4,this.lowWatermark=1e3,this.highWater=!1,this.state=new hn.State(">",this.tty(),this.highlighter,this.history),this.checkHandler=()=>!0,this.ctrlCHandler=()=>{},this.pauseHandler=d=>{},this.history.restoreFromLocalStorage()}activate(d){this.term=d,this.term.onData(this.readData.bind(this)),this.term.attachCustomKeyEventHandler(this.handleKeyEvent.bind(this))}dispose(){this.disposables.forEach(d=>d.dispose())}appendHistory(d){this.history.append(d)}setHighlighter(d){this.highlighter=d}setCheckHandler(d){this.checkHandler=d}setCtrlCHandler(d){this.ctrlCHandler=d}setPauseHandler(d){this.pauseHandler=d}writeReady(){return!this.highWater}write(d){d===`
`?d=`\r
`:(d=d.replace(/^\n/,`\r
`),d=d.replace(/([^\r])\n/g,`$1\r
`));let k=d.length;this.watermark+=k,this.watermark>this.highWatermark&&(this.highWater=!0),this.term&&this.term.write(d,()=>{this.watermark=Math.max(this.watermark-k,0),this.highWater&&this.watermark<this.lowWatermark&&(this.highWater=!1)})}print(d){return this.write(d)}println(d){return this.write(d+`\r
`)}output(){return this}tty(){var d,k;return((k=(d=this.term)===null||d===void 0?void 0:d.options)===null||k===void 0?void 0:k.tabStopWidth)!==void 0?new Ga.Tty(this.term.cols,this.term.rows,this.term.options.tabStopWidth,this.output()):new Ga.Tty(0,0,8,this.output())}read(d){return new Promise((k,M)=>{if(this.term===void 0){M("addon is not active");return}this.state=new hn.State(d,this.tty(),this.highlighter,this.history),this.state.refresh(),this.activeRead={prompt:d,resolve:k,reject:M}})}handleKeyEvent(d){return d.key==="Enter"&&d.shiftKey?(d.type==="keydown"&&this.readKey({inputType:Ie.InputType.ShiftEnter,data:["\r"]}),!1):!0}readData(d){let k=(0,Ie.parseInput)(d);if(k.length>1||k[0].inputType===Ie.InputType.Text&&k[0].data.length>1){this.readPaste(k);return}this.readKey(k[0])}readPaste(d){let k=d.map(M=>M.inputType===Ie.InputType.Enter?{inputType:Ie.InputType.Text,data:[`
`]}:M);for(let M of k)M.inputType===Ie.InputType.Text?this.state.editInsert(M.data.join("")):this.readKey(M)}readKey(d){var k,M,B;if(this.activeRead===void 0){switch(d.inputType){case Ie.InputType.CtrlC:this.ctrlCHandler();break;case Ie.InputType.CtrlL:this.write("\x1B[H\x1B[2J");break}return}switch(d.inputType){case Ie.InputType.Text:this.state.editInsert(d.data.join(""));break;case Ie.InputType.AltEnter:case Ie.InputType.ShiftEnter:this.state.editInsert(`
`);break;case Ie.InputType.Enter:this.checkHandler(this.state.buffer())?(this.state.moveCursorToEnd(),(k=this.term)===null||k===void 0||k.write(`\r
`),this.history.append(this.state.buffer()),(M=this.activeRead)===null||M===void 0||M.resolve(this.state.buffer()),this.activeRead=void 0):this.state.editInsert(`
`);break;case Ie.InputType.CtrlC:this.state.moveCursorToEnd(),(B=this.term)===null||B===void 0||B.write(`^C\r
`),this.state=new hn.State(this.activeRead.prompt,this.tty(),this.highlighter,this.history),this.state.refresh();break;case Ie.InputType.CtrlS:this.pauseHandler(!1);break;case Ie.InputType.CtrlU:this.state.update("");break;case Ie.InputType.CtrlK:this.state.editDeleteEndOfLine();break;case Ie.InputType.CtrlQ:this.pauseHandler(!0);break;case Ie.InputType.CtrlL:this.state.clearScreen();break;case Ie.InputType.Home:case Ie.InputType.CtrlA:this.state.moveCursorHome();break;case Ie.InputType.End:case Ie.InputType.CtrlE:this.state.moveCursorEnd();break;case Ie.InputType.Backspace:this.state.editBackspace(1);break;case Ie.InputType.Delete:case Ie.InputType.CtrlD:this.state.editDelete(1);break;case Ie.InputType.ArrowLeft:this.state.moveCursorBack(1);break;case Ie.InputType.ArrowRight:this.state.moveCursorForward(1);break;case Ie.InputType.ArrowUp:this.state.moveCursorUp(1);break;case Ie.InputType.ArrowDown:this.state.moveCursorDown(1);break;case Ie.InputType.UnsupportedControlChar:case Ie.InputType.UnsupportedEscape:break}}};cs.Readline=un});var Za=rt((hs,dn)=>{(function(o,d){typeof hs=="object"&&typeof dn=="object"?dn.exports=d():typeof define=="function"&&define.amd?define([],d):typeof hs=="object"?hs.FitAddon=d():o.FitAddon=d()})(self,function(){return(()=>{"use strict";var o={};return(()=>{var d=o;Object.defineProperty(d,"__esModule",{value:!0}),d.FitAddon=void 0,d.FitAddon=class{constructor(){}activate(k){this._terminal=k}dispose(){}fit(){let k=this.proposeDimensions();if(!k||!this._terminal||isNaN(k.cols)||isNaN(k.rows))return;let M=this._terminal._core;this._terminal.rows===k.rows&&this._terminal.cols===k.cols||(M._renderService.clear(),this._terminal.resize(k.cols,k.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let k=this._terminal._core,M=k._renderService.dimensions;if(M.css.cell.width===0||M.css.cell.height===0)return;let B=this._terminal.options.scrollback===0?0:k.viewport.scrollBarWidth,u=window.getComputedStyle(this._terminal.element.parentElement),_=parseInt(u.getPropertyValue("height")),y=Math.max(0,parseInt(u.getPropertyValue("width"))),w=window.getComputedStyle(this._terminal.element),R=_-(parseInt(w.getPropertyValue("padding-top"))+parseInt(w.getPropertyValue("padding-bottom"))),x=y-(parseInt(w.getPropertyValue("padding-right"))+parseInt(w.getPropertyValue("padding-left")))-B;return{cols:Math.max(2,Math.floor(x/M.css.cell.width)),rows:Math.max(1,Math.floor(R/M.css.cell.height))}}}})(),o})()})});var Ri=Tt(Bs());var hl=Tt(ra());var Ir,Mr;function ia(o){return Mr=Object.assign({core:{multiple:!1,check_callback:!1},onChange:()=>{}},o),(0,Ri.default)(Mr.selector).jstree(Mr),Ir=(0,Ri.default)(Mr.selector).jstree(),{getSelectedNodes:dl,getSelectedNode:fl,refresh:pl,createJSTreeNodefromFSNode:sa,getJSTreeElement:ul,getNodeFileName:_l}}function ul(){return(0,Ri.default)(Mr.selector)}function dl(){return Ir.get_selected(!0)}function fl(){let o=Ir.get_selected(!0);if(o.length>0)return o[0]}function _l(o){if(o.parents){let d=o.parents.map(k=>Ir.get_node(k).text).reverse().slice(1);return d.push(o.text),d[0]="",d.join("/")}return"/"}function pl(){return Ir.refresh()}function sa(o){let d={text:o.name,isFolder:o.isFolder};return o.isFolder?(d.children=Object.entries(o.contents).map(([,k])=>sa(k)),o.name==="/"&&(d.state={opened:!0}),d):(d.icon="jstree-file",d)}var $e=typeof process<"u"&&process.release&&process.release.name==="node"&&typeof process.browser>"u",Ms;if(globalThis.document)Ms=o=>new Promise((d,k)=>{let M=document.createElement("script");M.src=o,M.onload=()=>d(),M.onerror=k,document.head.appendChild(M)});else if(globalThis.importScripts)Ms=async o=>{try{globalThis.importScripts(o)}catch(d){if(d instanceof TypeError)await Promise.resolve().then(()=>Tt(Mt(o)));else throw d}};else if($e)Ms=async o=>{let d=(await Promise.resolve().then(()=>Tt(Mt("path")))).default;await Promise.resolve().then(()=>Tt(Mt(d.resolve(o))))};else throw new Error("Cannot determine runtime environment");function cr(){let o={resolve:k=>{},reject:k=>{},promise:null},d=new Promise((k,M)=>{o.resolve=k,o.reject=M});return o.promise=d,o}function na(o){return new Promise(d=>setTimeout(d,o))}function wt(o,d,k,...M){return o===null||typeof o!="object"?o:d(o)?k(o,...M):Array.isArray(o)||ArrayBuffer.isView(o)?o.map(B=>wt(B,d,k,...M)):Object.fromEntries(Object.entries(o).map(([B,u],_)=>[B,wt(u,d,k,...M)]))}function Ei(o,d){let k=new XMLHttpRequest;k.open("get",o,!0),k.onload=()=>{let M=new Worker(URL.createObjectURL(new Blob([k.responseText])));d(M)},k.send()}function hr(o){if($e)return!1;let d=new URL(location.href),k=new URL(o,location.origin);return!(d.host===k.host&&d.port===k.port&&d.protocol===k.protocol)}var gl=new WeakMap;function aa(o,d){return gl.set(o,d),o}var xi=63;function ki(){let o=Array.from({length:4},vl).join("-");if(o.length!==xi)throw new Error("comlink internal error: UUID has the wrong length");return o}function vl(){let o=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16),d=15-o.length;return d>0&&(o=Array.from({length:d},()=>0).join("")+o),o}function Ti(o,d){return oa({type:"request",data:{uuid:ki(),msg:o}},d)}function Is(o,d,k){return oa({type:"response",data:{uuid:o,resp:d}},k)}function oa(o,d){return d&&aa(o,d),o}function la(o,d){return{type:"sync-request",data:{msg:o,reqData:d}}}var ml=new TextEncoder,yl=new TextDecoder("utf-8");function Ai(o){return ml.encode(JSON.stringify(o))}function Li(o){return JSON.parse(yl.decode(o))}var Dl=new TextEncoder;async function ha(o,d,k){try{let{taskId:M,sizeBuffer:B,dataBuffer:u,signalBuffer:_}=d,y=Ai(k),w=y.length<=u.length;if(Atomics.store(B,0,y.length),Atomics.store(B,1,+w),!w){let[R,x]=Cl(o);u.set(Dl.encode(R)),await ca(_,M),u=(await x).dataBuffer}u.set(y),Atomics.store(B,1,1),await ca(_,M)}catch(M){console.warn(M)}}function Cl(o){let d=ki();return[d,new Promise(k=>{$e?o.once("message",M=>{!M.id||M.id!==d||k(M)}):o.addEventListener("message",function M(B){!B.data||!B.data.id||B.data.id!==d||(o.removeEventListener("message",M),k(B.data))}),o.start&&o.start()})]}async function ca(o,d){let k=(d>>1)%32,M=1;for(;Atomics.compareExchange(o,k+1,0,d)!==0;)await na(M),M<32&&(M*=2);Atomics.or(o,0,1<<k),Atomics.notify(o,0)}var At,Lt,Hr,Ns,Nr=class{constructor(){we(this,Hr);we(this,At,void 0);we(this,Lt,void 0);Be(this,Lt,[]),Be(this,At,[])}put(d){re(this,Lt).length||st(this,Hr,Ns).call(this),re(this,Lt).shift()(d)}async get(){return re(this,At).length||st(this,Hr,Ns).call(this),re(this,At).shift()}isEmpty(){return!re(this,At).length}isBlocked(){return!!re(this,Lt).length}get length(){return re(this,At).length-re(this,Lt).length}};At=new WeakMap,Lt=new WeakMap,Hr=new WeakSet,Ns=function(){re(this,At).push(new Promise(d=>{re(this,Lt).push(d)}))};function ua(o){let d=new Error(o.obj.message);return d.name=o.obj.name,d.stack=o.obj.stack,d}function Sl(o){return o&&typeof o=="object"&&"payloadType"in o&&"obj"in o}function Oi(o){return Sl(o)&&o.payloadType==="ptr"}var ur,dr=class{constructor(){this.inputQueue=new Nr;this.outputQueue=new Nr;we(this,ur,new Map)}async read(){return await this.outputQueue.get()}async flush(){let d=[];for(;!this.outputQueue.isEmpty();)d.push(await this.read());return d}write(d){this.inputQueue.put(d)}async request(d,k){let M=Ti(d,k),{resolve:B,reject:u,promise:_}=cr();return re(this,ur).set(M.data.uuid,{resolve:B,reject:u}),this.write(M),_}resolveResponse(d){let k=d.data.uuid,M=re(this,ur).get(k);if(M){let B=d.data.resp;re(this,ur).delete(k),B.payloadType==="err"?M.reject(ua(B)):M.resolve(B)}else console.warn("Can't find request.")}};ur=new WeakMap;var bl=new TextDecoder("utf-8"),fr,_r,Wr,jr,pr,Mi=class{constructor(d,k,M=[]){we(this,fr,!1);we(this,_r,void 0);we(this,Wr,void 0);we(this,jr,void 0);we(this,pr,void 0);this.syncifier=new Hs;this.endpoint=d,this.msg=k,this.transfers=M,Be(this,_r,!1)}scheduleSync(){if(!re(this,fr))return Be(this,fr,!0),this.syncifier.scheduleTask(this),Be(this,pr,this.doSync()),re(this,pr).next(),this}poll(){if(!re(this,fr))throw new Error("Task not synchronously scheduled");let{done:d,value:k}=re(this,pr).next();return d?(Be(this,_r,!0),Be(this,Wr,k),!0):!1}*doSync(){let{endpoint:d,msg:k,transfers:M}=this,B=new Int32Array(new SharedArrayBuffer(8)),u=this.signalBuffer,_=this.taskId,y=da(xi),w=la(k,{sizeBuffer:B,dataBuffer:y,signalBuffer:u,taskId:_});if(d.postMessage(w,M),yield,Atomics.load(B,1)===0){let x=bl.decode(y.slice(0,xi));Rl(y);let P=Atomics.load(B,0);y=da(P),d.postMessage({id:x,dataBuffer:y}),yield}let R=Atomics.load(B,0);return Li(y.slice(0,R))}get result(){if(re(this,jr))throw re(this,jr);if(re(this,_r))return re(this,Wr);throw new Error("Not ready.")}syncify(){return this.scheduleSync(),this.syncifier.syncifyTask(this),this.result}};fr=new WeakMap,_r=new WeakMap,Wr=new WeakMap,jr=new WeakMap,pr=new WeakMap;var Hs=class{constructor(){this.nextTaskId=new Int32Array([1]),this.signalBuffer=new Int32Array(new SharedArrayBuffer(32*4+4)),this.tasks=new Map}scheduleTask(d){d.taskId=this.nextTaskId[0],this.nextTaskId[0]+=2,d.signalBuffer=this.signalBuffer,this.tasks.set(d.taskId,d)}waitOnSignalBuffer(){for(;;)switch(Atomics.wait(this.signalBuffer,0,0,50)){case"ok":case"not-equal":return;case"timed-out":Ws[0]!==0&&fa();break;default:throw new Error("Unreachable")}}*tasksIdsToWakeup(){let d=Atomics.load(this.signalBuffer,0);for(let k=0;k<32;k++){let M=1<<k;d&M&&(Atomics.and(this.signalBuffer,0,~M),yield Atomics.exchange(this.signalBuffer,k+1,0))}}pollTasks(d){let k=!1;for(let M of this.tasksIdsToWakeup()){let B=this.tasks.get(M);if(!B)throw new Error(`Assertion error: unknown taskId ${M}.`);B.poll()&&(this.tasks.delete(M),B===d&&(k=!0))}return k}syncifyTask(d){for(;;)if(this.waitOnSignalBuffer(),this.pollTasks(d))return}},Bi=[];function da(o){let d=Math.ceil(Math.log2(o));Bi[d]||(Bi[d]=[]);let k=Bi[d].pop();return k?(k.fill(0),k):new Uint8Array(new SharedArrayBuffer(2**d))}function Rl(o){let d=Math.ceil(Math.log2(o.byteLength));Bi[d].push(o)}var Ws=new Int32Array(new ArrayBuffer(4)),fa=()=>{throw Ws[0]=0,new Error("Interrupted!")};function _a(o){fa=o}function pa(o){Ws=new Int32Array(o)}var le={};function ga(o){Object.keys(o).forEach(d=>le._free(o[d]))}$e&&(globalThis.Worker=Mt("worker_threads").Worker);var gr,Ii,va,qr,Ur=class extends dr{constructor(k){super();we(this,Ii);we(this,gr,void 0);this.close=()=>{};we(this,qr,async(k,M)=>{if(!(!M||!M.type))switch(M.type){case"resolve":Be(this,gr,new Int32Array(M.data)),this.resolve();return;case"response":this.resolveResponse(M);return;default:this.outputQueue.put(M);return;case"sync-request":{let B=M,u=B.data.msg,_=B.data.reqData;switch(u.type){case"read":{let y=await this.inputQueue.get();await ha(k,_,y);break}default:throw new TypeError(`Unsupported request type '${u.type}'.`)}return}case"request":throw new TypeError("Can't send messages of type 'request' from a worker. Please Use 'sync-request' instead.")}});let M=B=>{st(this,Ii,va).call(this,B),this.close=()=>B.terminate();let u={type:"init",data:{config:k,channelType:Pt.SharedArrayBuffer}};B.postMessage(u)};if(hr(k.WEBR_URL))Ei(`${k.WEBR_URL}webr-worker.js`,B=>M(B));else{let B=new Worker(`${k.WEBR_URL}webr-worker.js`);M(B)}({resolve:this.resolve,promise:this.initialised}=cr())}interrupt(){if(!re(this,gr))throw new Error("Failed attempt to interrupt before initialising interruptBuffer");re(this,gr)[0]=1}};gr=new WeakMap,Ii=new WeakSet,va=function(k){$e?k.on("message",M=>{re(this,qr).call(this,k,M)}):k.onmessage=M=>re(this,qr).call(this,k,M.data)},qr=new WeakMap;var vr,zr,Yt,Kr,js=class{constructor(){we(this,vr,void 0);we(this,zr,()=>0);we(this,Yt,new Int32Array(new SharedArrayBuffer(4)));we(this,Kr,()=>{});Be(this,vr,$e?Mt("worker_threads").parentPort:globalThis),pa(re(this,Yt).buffer),_a(()=>this.handleInterrupt())}resolve(){this.write({type:"resolve",data:re(this,Yt).buffer})}write(d,k){re(this,vr).postMessage(d,k)}read(){let d={type:"read"};return new Mi(re(this,vr),d).syncify()}inputOrDispatch(){for(;;){let d=this.read();if(d.type==="stdin")return le.allocateUTF8(d.data);re(this,zr).call(this,d)}}run(d){le.callMain(d)}setInterrupt(d){Be(this,Kr,d)}handleInterrupt(){re(this,Yt)[0]!==0&&(re(this,Yt)[0]=0,re(this,Kr).call(this))}setDispatchHandler(d){Be(this,zr,d)}};vr=new WeakMap,zr=new WeakMap,Yt=new WeakMap,Kr=new WeakMap;$e&&(globalThis.Worker=Mt("worker_threads").Worker);var mr,Zt,yr,Ni,ma,Hi,ya,Wi,Da,Jr,Vr=class extends dr{constructor(k){super();we(this,Ni);we(this,Hi);we(this,Wi);this.close=()=>{};we(this,mr,new Map);we(this,Zt,void 0);we(this,yr,!1);we(this,Jr,async(k,M)=>{if(!(!M||!M.type))switch(M.type){case"resolve":this.resolve();return;case"response":this.resolveResponse(M);return;default:this.outputQueue.put(M);return;case"sync-request":{let B=M.data;re(this,mr).set(B.data.uuid,B.data.msg);return}case"request":throw new TypeError("Can't send messages of type 'request' from a worker.Use service worker fetch request instead.")}});let M=B=>{st(this,Wi,Da).call(this,B),this.close=()=>B.terminate(),st(this,Ni,ma).call(this,`${k.SW_URL}webr-serviceworker.js`).then(u=>{let _={type:"init",data:{config:k,channelType:Pt.ServiceWorker,clientId:u,location:window.location.href}};B.postMessage(_)})};if(hr(k.SW_URL))Ei(`${k.SW_URL}webr-worker.js`,B=>M(B));else{let B=new Worker(`${k.SW_URL}webr-worker.js`);M(B)}({resolve:this.resolve,promise:this.initialised}=cr())}activeRegistration(){var k;if(!((k=re(this,Zt))!=null&&k.active))throw new Error("Attempted to obtain a non-existent active registration.");return re(this,Zt).active}interrupt(){Be(this,yr,!0)}};mr=new WeakMap,Zt=new WeakMap,yr=new WeakMap,Ni=new WeakSet,ma=async function(k){Be(this,Zt,await navigator.serviceWorker.register(k)),await navigator.serviceWorker.ready,window.addEventListener("beforeunload",()=>{var B;(B=re(this,Zt))==null||B.unregister()});let M=await new Promise(B=>{navigator.serviceWorker.addEventListener("message",function u(_){_.data.type==="registration-successful"&&(navigator.serviceWorker.removeEventListener("message",u),B(_.data.clientId))}),this.activeRegistration().postMessage({type:"register-client-main"})});return navigator.serviceWorker.addEventListener("message",B=>{st(this,Hi,ya).call(this,B)}),M},Hi=new WeakSet,ya=async function(k){if(k.data.type==="request"){let M=k.data.data,B=re(this,mr).get(M);if(!B)throw new Error("Request not found during service worker XHR request");switch(re(this,mr).delete(M),B.type){case"read":{let u=await this.inputQueue.get();this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:M,response:Is(M,u)});break}case"interrupt":{let u=re(this,yr);this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:M,response:Is(M,u)}),Be(this,yr,!1);break}default:throw new TypeError(`Unsupported request type '${B.type}'.`)}return}},Wi=new WeakSet,Da=function(k){$e?k.on("message",M=>{re(this,Jr).call(this,k,M)}):k.onmessage=M=>re(this,Jr).call(this,k,M.data)},Jr=new WeakMap;var Xr,Gr,Yr,Zr,Qr,Us=class{constructor(d){we(this,Xr,void 0);we(this,Gr,void 0);we(this,Yr,void 0);we(this,Zr,()=>0);we(this,Qr,()=>{});this.onMessageFromMainThread=()=>{};if(!d.clientId||!d.location)throw Error("Can't start service worker channel");Be(this,Gr,d.clientId),Be(this,Yr,d.location),Be(this,Xr,$e?Mt("worker_threads").parentPort:globalThis)}resolve(){this.write({type:"resolve"})}write(d,k){re(this,Xr).postMessage(d,k)}syncRequest(d){let k=Ti(d);this.write({type:"sync-request",data:k});let M=0;for(;;)try{let B=new URL("__wasm__/webr-fetch-request/",re(this,Yr)),u=new XMLHttpRequest;u.timeout=6e4,u.responseType="arraybuffer",u.open("POST",B,!1);let _={clientId:re(this,Gr),uuid:k.data.uuid};return u.send(Ai(_)),Li(new Uint8Array(u.response))}catch(B){if(B instanceof DOMException&&M++<1e3)console.log("Service worker request failed - resending request");else throw B}}read(){return this.syncRequest({type:"read"}).data.resp}inputOrDispatch(){for(;;){let d=this.read();if(d.type==="stdin")return le.allocateUTF8(d.data);re(this,Zr).call(this,d)}}run(d){le.callMain(d)}setInterrupt(d){Be(this,Qr,d)}handleInterrupt(){this.syncRequest({type:"interrupt"}).data.resp&&re(this,Qr).call(this)}setDispatchHandler(d){Be(this,Zr,d)}};Xr=new WeakMap,Gr=new WeakMap,Yr=new WeakMap,Zr=new WeakMap,Qr=new WeakMap;var Pt={Automatic:0,SharedArrayBuffer:1,ServiceWorker:2};function Ca(o){switch(o.channelType){case Pt.SharedArrayBuffer:return new Ur(o);case Pt.ServiceWorker:return new Vr(o);case Pt.Automatic:default:if($e||crossOriginIsolated)return new Ur(o);if("serviceWorker"in navigator&&!hr(o.SW_URL))return new Vr(o);throw new Error("Can't initialise main thread communication channel")}}var Sa="https://webr.r-wasm.org/v0.1.0/",wa="https://repo.r-wasm.org";function Ft(o){return o&&(typeof o=="object"||typeof o=="function")&&"payloadType"in o&&Oi(o._payload)}function ba(o){var d;return Boolean(Ft(o)&&((d=o._payload.obj.methods)==null?void 0:d.includes("exec")))}var Ue={null:0,symbol:1,pairlist:2,closure:3,environment:4,promise:5,call:6,special:7,builtin:8,string:9,logical:10,integer:13,double:14,complex:15,character:16,dots:17,any:18,list:19,expression:20,bytecode:21,pointer:22,weakref:23,raw:24,s4:25,new:30,free:31,function:99};function qs(o){return o&&typeof o=="object"&&Object.keys(Ue).includes(o.type)}function zs(o){return o&&typeof o=="object"&&"re"in o&&"im"in o}function ji(o){return le._Rf_protect(bt(o)),o}function it(o,d){return le._Rf_protect(bt(o)),++d.n,o}function Ra(o){let d=le._malloc(4);return le._R_ProtectWithIndex(bt(o),d),{loc:le.getValue(d,"i32"),ptr:d}}function Ea(o){le._Rf_unprotect(1),le._free(o.ptr)}function xa(o,d){return le._R_Reprotect(bt(o),d.loc),o}function ht(o){le._Rf_unprotect(o)}function Ks(o,d,k){le._Rf_defineVar(bt(d),bt(k),bt(o))}function ka(o,d){let k={},M={n:0};try{let B=new ei(d);it(B,M),k.code=le.allocateUTF8(o);let u=le._R_ParseEvalString(k.code,B.ptr);return Me.wrap(u)}finally{ga(k),ht(M.n)}}function $r(o,d){return le.LDSO.loadedLibsByName["/usr/lib/R/library/webr/libs/webr.so"].module.ffi_safe_eval(bt(o),bt(d))}function bt(o){return Tl(o)?o.ptr:o}function tr(o,d){if(le._TYPEOF(o.ptr)!==Ue[d])throw new Error(`Unexpected object type "${o.type()}" when expecting type "${d}"`)}function xl(o){if(qs(o))return new(Ta(Ue[o.type]))(o);if(o&&typeof o=="object"&&"type"in o&&o.type==="null")return new Ki;if(o===null)return new $t({type:"logical",names:null,values:[null]});if(typeof o=="boolean")return new $t(o);if(typeof o=="number")return new ti(o);if(typeof o=="string")return new It(o);if(zs(o))return new ri(o);if(Array.isArray(o))return kl(o);throw new Error("Robj construction for this JS object is not yet supported")}function kl(o){let d={n:0};try{let k=new er([new Nt("c"),...o]);return it(k,d),k.eval()}finally{ht(d.n)}}var et=class{constructor(d){this.ptr=d}type(){let d=le._TYPEOF(this.ptr);return Object.keys(Ue).find(M=>Ue[M]===d)}},Cr,Ui,Qt=class extends et{constructor(k){if(!(k instanceof et))return xl(k);super(k.ptr);we(this,Cr)}static wrap(k){let M=le._TYPEOF(k);return new(Ta(M))(new et(k))}get[Symbol.toStringTag](){return`RObject:${this.type()}`}static getPersistentObject(k){return nt[k]}getPropertyValue(k){return this[k]}inspect(){ka(".Internal(inspect(x))",{x:this})}isNull(){return le._TYPEOF(this.ptr)===Ue.null}isUnbound(){return this.ptr===nt.unboundValue.ptr}attrs(){return Sr.wrap(le._ATTRIB(this.ptr))}setNames(k){let M;if(k===null)M=nt.null;else if(Array.isArray(k)&&k.every(B=>typeof B=="string"||B===null))M=new It(k);else throw new Error("Argument to setNames must be null or an Array of strings or null");return le._Rf_setAttrib(this.ptr,nt.namesSymbol.ptr,M.ptr),this}names(){let k=It.wrap(le._Rf_getAttrib(this.ptr,nt.namesSymbol.ptr));return k.isNull()?null:k.toArray()}includes(k){let M=this.names();return M&&M.includes(k)}toJs(k={depth:0},M=1){throw new Error("This R object cannot be converted to JS")}subset(k){return st(this,Cr,Ui).call(this,k,nt.bracketSymbol.ptr)}get(k){return st(this,Cr,Ui).call(this,k,nt.bracket2Symbol.ptr)}getDollar(k){return st(this,Cr,Ui).call(this,k,nt.dollarSymbol.ptr)}pluck(...k){let M=Ra(nt.null);try{let B=(_,y)=>{let w=_.get(y);return xa(w,M)},u=k.reduce(B,this);return u.isNull()?void 0:u}finally{Ea(M)}}set(k,M){let B={n:0};try{let u=new Qt(k);it(u,B);let _=new Qt(M);it(_,B);let y=new Nt("[[<-"),w=le._Rf_lang4(y.ptr,this.ptr,u.ptr,_.ptr);return it(w,B),Qt.wrap($r(w,nt.baseEnv))}finally{ht(B.n)}}static getMethods(k){let M=new Set,B=k;do Object.getOwnPropertyNames(B).map(u=>M.add(u));while(B=Object.getPrototypeOf(B));return[...M.keys()].filter(u=>typeof k[u]=="function")}},Me=Qt;Cr=new WeakSet,Ui=function(k,M){let B={n:0};try{let u=new Qt(k);it(u,B);let _=le._Rf_lang3(M,this.ptr,u.ptr);return it(_,B),Qt.wrap($r(_,nt.baseEnv))}finally{ht(B.n)}};var Ki=class extends Me{constructor(){return super(new et(le.getValue(le._R_NilValue,"*"))),this}toJs(){return{type:"null"}}},Nt=class extends Me{constructor(d){if(d instanceof et){tr(d,"symbol"),super(d);return}let k=le.allocateUTF8(d);try{super(new et(le._Rf_install(k)))}finally{le._free(k)}}toJs(){let d=this.toObject();return{type:"symbol",printname:d.printname,symvalue:d.symvalue,internal:d.internal}}toObject(){return{printname:this.printname().isUnbound()?null:this.printname().toString(),symvalue:this.symvalue().isUnbound()?null:this.symvalue().ptr,internal:this.internal().isNull()?null:this.internal().ptr}}toString(){return this.printname().toString()}printname(){return ii.wrap(le._PRINTNAME(this.ptr))}symvalue(){return Me.wrap(le._SYMVALUE(this.ptr))}internal(){return Me.wrap(le._INTERNAL(this.ptr))}},Sr=class extends Me{constructor(d){if(d instanceof et)return tr(d,"pairlist"),super(d),this;let k={n:0};try{let{names:M,values:B}=si(d),u=Sr.wrap(le._Rf_allocList(B.length));it(u,k);for(let[_,y]=[0,u];!y.isNull();[_,y]=[_+1,y.cdr()])y.setcar(new Me(B[_]));u.setNames(M),super(u)}finally{ht(k.n)}}get length(){return this.toArray().length}toArray(d={depth:1}){return this.toJs(d).values}toObject({allowDuplicateKey:d=!0,allowEmptyKey:k=!1,depth:M=1}={}){let B=this.entries({depth:M}),u=B.map(([_,y])=>_);if(!d&&new Set(u).size!==u.length)throw new Error("Duplicate key when converting pairlist without allowDuplicateKey enabled");if(!k&&u.some(_=>!_))throw new Error("Empty or null key when converting pairlist without allowEmptyKey enabled");return Object.fromEntries(B.filter((_,y)=>B.findIndex(w=>w[0]===_[0])===y))}entries(d={depth:1}){let k=this.toJs(d);return k.values.map((M,B)=>[k.names?k.names[B]:null,M])}toJs(d={depth:0},k=1){let M=[],B=!1,u=[];for(let y=this;!y.isNull();y=y.cdr()){let w=y.tag();w.isNull()?M.push(""):(B=!0,M.push(w.toString())),d.depth&&k>=d.depth?u.push(y.car()):u.push(y.car().toJs(d,k+1))}return{type:"pairlist",names:B?M:null,values:u}}includes(d){return d in this.toObject()}setcar(d){le._SETCAR(this.ptr,d.ptr)}car(){return Me.wrap(le._CAR(this.ptr))}cdr(){return Me.wrap(le._CDR(this.ptr))}tag(){return Me.wrap(le._TAG(this.ptr))}},er=class extends Me{constructor(d){if(d instanceof et)return tr(d,"call"),super(d),this;let k={n:0};try{let{values:M}=si(d),B=M.map(_=>it(new Me(_),k)),u=er.wrap(le._Rf_allocVector(Ue.call,M.length));it(u,k);for(let[_,y]=[0,u];!y.isNull();[_,y]=[_+1,y.cdr()])y.setcar(B[_]);super(u)}finally{ht(k.n)}}setcar(d){le._SETCAR(this.ptr,d.ptr)}car(){return Me.wrap(le._CAR(this.ptr))}cdr(){return Me.wrap(le._CDR(this.ptr))}eval(){return Me.wrap($r(this.ptr,nt.baseEnv))}},Vs=class extends Me{constructor(d){if(d instanceof et)return tr(d,"list"),super(d),this;let k={n:0};try{let{names:M,values:B}=si(d),u=le._Rf_allocVector(Ue.list,B.length);it(u,k),B.forEach((_,y)=>{le._SET_VECTOR_ELT(u,y,new Me(_).ptr)}),Me.wrap(u).setNames(M),super(new et(u))}finally{ht(k.n)}}get length(){return le._LENGTH(this.ptr)}toArray(d={depth:1}){return this.toJs(d).values}toObject({allowDuplicateKey:d=!0,allowEmptyKey:k=!1,depth:M=1}={}){let B=this.entries({depth:M}),u=B.map(([_,y])=>_);if(!d&&new Set(u).size!==u.length)throw new Error("Duplicate key when converting list without allowDuplicateKey enabled");if(!k&&u.some(_=>!_))throw new Error("Empty or null key when converting list without allowEmptyKey enabled");return Object.fromEntries(B.filter((_,y)=>B.findIndex(w=>w[0]===_[0])===y))}entries(d={depth:1}){let k=this.toJs(d);return k.values.map((M,B)=>[k.names?k.names[B]:null,M])}toJs(d={depth:0},k=1){return{type:"list",names:this.names(),values:[...Array(this.length).keys()].map(M=>d.depth&&k>=d.depth?this.get(M+1):this.get(M+1).toJs(d,k+1))}}},Dr=class extends Me{exec(...d){let k={n:0};try{let M=new er([this,...d]);return it(M,k),M.eval()}finally{ht(k.n)}}},ii=class extends Me{constructor(d){if(d instanceof et){tr(d,"string"),super(d);return}let k=le.allocateUTF8(d);try{super(new et(le._Rf_mkChar(k)))}finally{le._free(k)}}toString(){return le.UTF8ToString(le._R_CHAR(this.ptr))}toJs(){return{type:"string",value:this.toString()}}},ei=class extends Me{constructor(d={}){if(d instanceof et)return tr(d,"environment"),super(d),this;let k=0;try{let{names:M,values:B}=si(d),u=ji(le._R_NewEnv(nt.globalEnv.ptr,0,0));++k,B.forEach((_,y)=>{let w=M?M[y]:null;if(!w)throw new Error("Can't create object in new environment with empty symbol name");let R=new Nt(w),x=ji(new Me(_));try{Ks(u,R,x)}finally{ht(1)}}),super(new et(u))}finally{ht(k)}}ls(d=!1,k=!0){return It.wrap(le._R_lsInternal3(this.ptr,Number(d),Number(k))).toArray()}bind(d,k){let M=new Nt(d),B=ji(new Me(k));try{Ks(this,M,B)}finally{ht(1)}}names(){return this.ls(!0,!0)}frame(){return Me.wrap(le._FRAME(this.ptr))}subset(d){if(typeof d=="number")throw new Error("Object of type environment is not subsettable");return this.getDollar(d)}toObject({depth:d=0}={}){let k=this.names();return Object.fromEntries([...Array(k.length).keys()].map(M=>[k[M],this.getDollar(k[M]).toJs({depth:d})]))}toJs(d={depth:0},k=1){let M=this.names(),B=[...Array(M.length).keys()].map(u=>d.depth&&k>=d.depth?this.getDollar(M[u]):this.getDollar(M[u]).toJs(d,k+1));return{type:"environment",names:M,values:B}}},Ht=class extends Me{constructor(d,k,M){if(d instanceof et)return tr(d,k),super(d),this;let B={n:0};try{let{names:u,values:_}=si(d),y=le._Rf_allocVector(Ue[k],_.length);it(y,B),_.forEach(M(y)),Me.wrap(y).setNames(u),super(new et(y))}finally{ht(B.n)}}get length(){return le._LENGTH(this.ptr)}get(d){return super.get(d)}subset(d){return super.subset(d)}getDollar(d){throw new Error("$ operator is invalid for atomic vectors")}detectMissing(){let d={n:0};try{let k=le._Rf_lang2(new Nt("is.na").ptr,this.ptr);it(k,d);let M=$t.wrap($r(k,nt.baseEnv));it(M,d);let B=M.toTypedArray();return Array.from(B).map(u=>Boolean(u))}finally{ht(d.n)}}toArray(){let d=this.toTypedArray();return this.detectMissing().map((k,M)=>k?null:d[M])}toObject({allowDuplicateKey:d=!0,allowEmptyKey:k=!1}={}){let M=this.entries(),B=M.map(([u,_])=>u);if(!d&&new Set(B).size!==B.length)throw new Error("Duplicate key when converting atomic vector without allowDuplicateKey enabled");if(!k&&B.some(u=>!u))throw new Error("Empty or null key when converting atomic vector without allowEmptyKey enabled");return Object.fromEntries(M.filter((u,_)=>M.findIndex(y=>y[0]===u[0])===_))}entries(){let d=this.toArray(),k=this.names();return d.map((M,B)=>[k?k[B]:null,M])}toJs(){return{type:this.type(),names:this.names(),values:this.toArray()}}},Vi,Js=class extends Ht{constructor(d){super(d,"logical",re(Js,Vi))}getBoolean(d){return this.get(d).toArray()[0]}toBoolean(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let d=this.getBoolean(1);if(d===null)throw new Error("Can't convert missing value `NA` to a JS boolean");return d}toTypedArray(){return new Int32Array(le.HEAP32.subarray(le._LOGICAL(this.ptr)/4,le._LOGICAL(this.ptr)/4+this.length))}toArray(){let d=this.toTypedArray();return this.detectMissing().map((k,M)=>k?null:Boolean(d[M]))}},$t=Js;Vi=new WeakMap,we($t,Vi,d=>{let k=le._LOGICAL(d),M=le.getValue(le._R_NaInt,"i32");return(B,u)=>{le.setValue(k+4*u,B===null?M:Boolean(B),"i32")}});var Ji,Xs=class extends Ht{constructor(d){super(d,"integer",re(Xs,Ji))}getNumber(d){return this.get(d).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let d=this.getNumber(1);if(d===null)throw new Error("Can't convert missing value `NA` to a JS number");return d}toTypedArray(){return new Int32Array(le.HEAP32.subarray(le._INTEGER(this.ptr)/4,le._INTEGER(this.ptr)/4+this.length))}},qi=Xs;Ji=new WeakMap,we(qi,Ji,d=>{let k=le._INTEGER(d),M=le.getValue(le._R_NaInt,"i32");return(B,u)=>{le.setValue(k+4*u,B===null?M:Math.round(Number(B)),"i32")}});var Xi,Gs=class extends Ht{constructor(d){super(d,"double",re(Gs,Xi))}getNumber(d){return this.get(d).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let d=this.getNumber(1);if(d===null)throw new Error("Can't convert missing value `NA` to a JS number");return d}toTypedArray(){return new Float64Array(le.HEAPF64.subarray(le._REAL(this.ptr)/8,le._REAL(this.ptr)/8+this.length))}},ti=Gs;Xi=new WeakMap,we(ti,Xi,d=>{let k=le._REAL(d),M=le.getValue(le._R_NaReal,"double");return(B,u)=>{le.setValue(k+8*u,B===null?M:B,"double")}});var Gi,Ys=class extends Ht{constructor(d){super(d,"complex",re(Ys,Gi))}getComplex(d){return this.get(d).toArray()[0]}toComplex(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let d=this.getComplex(1);if(d===null)throw new Error("Can't convert missing value `NA` to a JS object");return d}toTypedArray(){return new Float64Array(le.HEAPF64.subarray(le._COMPLEX(this.ptr)/8,le._COMPLEX(this.ptr)/8+2*this.length))}toArray(){let d=this.toTypedArray();return this.detectMissing().map((k,M)=>k?null:{re:d[2*M],im:d[2*M+1]})}},ri=Ys;Gi=new WeakMap,we(ri,Gi,d=>{let k=le._COMPLEX(d),M=le.getValue(le._R_NaReal,"double");return(B,u)=>{le.setValue(k+8*(2*u),B===null?M:B.re,"double"),le.setValue(k+8*(2*u+1),B===null?M:B.im,"double")}});var Yi,Zs=class extends Ht{constructor(d){super(d,"character",re(Zs,Yi))}getString(d){return this.get(d).toArray()[0]}toString(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let d=this.getString(1);if(d===null)throw new Error("Can't convert missing value `NA` to a JS string");return d}toTypedArray(){return new Uint32Array(le.HEAPU32.subarray(le._STRING_PTR(this.ptr)/4,le._STRING_PTR(this.ptr)/4+this.length))}toArray(){return this.detectMissing().map((d,k)=>d?null:le.UTF8ToString(le._R_CHAR(le._STRING_ELT(this.ptr,k))))}},It=Zs;Yi=new WeakMap,we(It,Yi,d=>(k,M)=>{k===null?le._SET_STRING_ELT(d,M,nt.naString.ptr):le._SET_STRING_ELT(d,M,new ii(k).ptr)});var Zi,Qs=class extends Ht{constructor(d){super(d,"raw",re(Qs,Zi))}getNumber(d){return this.get(d).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let d=this.getNumber(1);if(d===null)throw new Error("Can't convert missing value `NA` to a JS number");return d}toTypedArray(){return new Uint8Array(le.HEAPU8.subarray(le._RAW(this.ptr),le._RAW(this.ptr)+this.length))}},zi=Qs;Zi=new WeakMap,we(zi,Zi,d=>{let k=le._RAW(d);return(M,B)=>{le.setValue(k+B,Number(M),"i8")}});function si(o){return qs(o)?o:Array.isArray(o)?{names:null,values:o}:o&&typeof o=="object"&&!zs(o)?{names:Object.keys(o),values:Object.values(o)}:{names:null,values:[o]}}function Ta(o){let d={[Ue.null]:Ki,[Ue.symbol]:Nt,[Ue.pairlist]:Sr,[Ue.closure]:Dr,[Ue.environment]:ei,[Ue.call]:er,[Ue.special]:Dr,[Ue.builtin]:Dr,[Ue.string]:ii,[Ue.logical]:$t,[Ue.integer]:qi,[Ue.double]:ti,[Ue.complex]:ri,[Ue.character]:It,[Ue.list]:Vs,[Ue.raw]:zi,[Ue.function]:Dr};return o in d?d[o]:Me}function Tl(o){return o instanceof Me}var nt;function Ll(){}function Pl(o,d){return async function*(){let k={type:"callRObjectMethod",data:{payload:d._payload,prop:"getPropertyValue",args:[{payloadType:"raw",obj:"length"}],shelter:void 0}},M=await o.request(k);if(typeof M.obj!="number")throw new Error("Cannot iterate over object, unexpected type for length property.");for(let B=1;B<=M.obj;B++)yield d.get(B)}}function Aa(o,d,k){return async(...M)=>{let B=M.map(y=>Ft(y)?y._payload:{obj:wt(y,Ft,w=>w._payload),payloadType:"raw"}),u={type:"callRObjectMethod",data:{payload:k,prop:d,args:B}},_=await o.request(u);switch(_.payloadType){case"ptr":return Wt(o,_);case"raw":return wt(_,Oi,(w,R)=>Wt(R,w),o).obj}}}async function Fl(o,d,k,M){let B={type:"newRObject",data:{objType:d,obj:wt(M,Ft,_=>_._payload),shelter:k}},u=await o.request(B);switch(u.payloadType){case"raw":throw new Error("Unexpected raw payload type returned from newRObject");case"ptr":return Wt(o,u)}}function Wt(o,d){var M;let k=new Proxy((M=d.obj.methods)!=null&&M.includes("exec")?Object.assign(Ll,{...d}):d,{get:(B,u)=>{var _;if(u==="_payload")return d;if(u===Symbol.asyncIterator)return Pl(o,k);if((_=d.obj.methods)!=null&&_.includes(u.toString()))return Aa(o,u.toString(),d)},apply:async(B,u,_)=>{let y=await Wt(o,d).exec(..._);return ba(y)?y:y.toJs()}});return k}function ut(o,d,k){return new Proxy(Me,{construct:(M,B)=>Fl(o,k,d,...B),get:(M,B)=>Aa(o,B.toString())})}var ni,ai,oi,li,Qi,$i,es,ts,rs,La,$s=class{constructor(d={},k={REnv:{R_HOME:"/usr/lib/R",R_ENABLE_JIT:"0",R_DEFAULT_DEVICE:"canvas"}}){we(this,rs);we(this,ni,void 0);we(this,ai,void 0);we(this,oi,void 0);we(this,li,void 0);we(this,Qi,d=>{console.log(d)});we(this,$i,d=>{console.error(d)});we(this,es,d=>{let k=prompt(d);k&&this.stdin(`${k}
`)});we(this,ts,d=>{if($e)throw new Error("Plotting with HTML canvas is not yet supported under Node");Function(`this.getContext('2d').${d}`).bind(this.canvas)()});this.webR=new wr(k),$e||(this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width","1008"),this.canvas.setAttribute("height","1008")),Be(this,ni,d.stdout||re(this,Qi)),Be(this,ai,d.stderr||re(this,$i)),Be(this,oi,d.prompt||re(this,es)),Be(this,li,d.canvasExec||re(this,ts))}stdin(d){this.webR.writeConsole(d)}interrupt(){this.webR.interrupt()}run(){st(this,rs,La).call(this)}};ni=new WeakMap,ai=new WeakMap,oi=new WeakMap,li=new WeakMap,Qi=new WeakMap,$i=new WeakMap,es=new WeakMap,ts=new WeakMap,rs=new WeakSet,La=async function(){for(;;){let d=await this.webR.read();switch(d.type){case"stdout":re(this,ni).call(this,d.data);break;case"stderr":re(this,ai).call(this,d.data);break;case"prompt":re(this,oi).call(this,d.data);break;case"canvasExec":re(this,li).call(this,d.data);break;default:console.warn(`Unhandled output type for webR Console: ${d.type}.`)}}};var Ol={R_HOME:"/usr/lib/R",R_ENABLE_JIT:"0"},Bl={RArgs:[],REnv:Ol,WEBR_URL:Sa,SW_URL:"",PKG_URL:wa,homedir:"/home/web_user",interactive:!0,channelType:Pt.Automatic},Qe,wr=class{constructor(d={}){we(this,Qe,void 0);this.FS={lookupPath:async d=>{let k={type:"lookupPath",data:{path:d}};return(await re(this,Qe).request(k)).obj},mkdir:async d=>{let k={type:"mkdir",data:{path:d}};return(await re(this,Qe).request(k)).obj},readFile:async(d,k)=>{let M={type:"readFile",data:{path:d,flags:k}};return(await re(this,Qe).request(M)).obj},rmdir:async d=>{let k={type:"rmdir",data:{path:d}};await re(this,Qe).request(k)},writeFile:async(d,k,M)=>{let B={type:"writeFile",data:{path:d,data:k,flags:M}};await re(this,Qe).request(B)},unlink:async d=>{let k={type:"unlink",data:{path:d}};await re(this,Qe).request(k)}};let k=Object.assign(Bl,d);Be(this,Qe,Ca(k)),this.objs={},this.Shelter=Ml(re(this,Qe))}async init(){let d=await re(this,Qe).initialised;return this.globalShelter=await new this.Shelter,this.RObject=this.globalShelter.RObject,this.RLogical=this.globalShelter.RLogical,this.RInteger=this.globalShelter.RInteger,this.RDouble=this.globalShelter.RDouble,this.RComplex=this.globalShelter.RComplex,this.RCharacter=this.globalShelter.RCharacter,this.RRaw=this.globalShelter.RRaw,this.RList=this.globalShelter.RList,this.RPairlist=this.globalShelter.RPairlist,this.REnvironment=this.globalShelter.REnvironment,this.RSymbol=this.globalShelter.RSymbol,this.RString=this.globalShelter.RString,this.RCall=this.globalShelter.RCall,this.objs={baseEnv:await this.RObject.getPersistentObject("baseEnv"),globalEnv:await this.RObject.getPersistentObject("globalEnv"),null:await this.RObject.getPersistentObject("null"),true:await this.RObject.getPersistentObject("true"),false:await this.RObject.getPersistentObject("false"),na:await this.RObject.getPersistentObject("na")},d}close(){re(this,Qe).close()}async read(){return await re(this,Qe).read()}async flush(){return await re(this,Qe).flush()}write(d){re(this,Qe).write(d)}writeConsole(d){this.write({type:"stdin",data:d+`
`})}interrupt(){re(this,Qe).interrupt()}async installPackages(d){for(let k of d){let M={type:"installPackage",data:{name:k}};await re(this,Qe).request(M)}}async destroy(d){await this.globalShelter.destroy(d)}async evalR(d,k){return this.globalShelter.evalR(d,k)}async evalRVoid(d,k){return this.evalRRaw(d,"void",k)}async evalRBoolean(d,k){return this.evalRRaw(d,"boolean",k)}async evalRNumber(d,k){return this.evalRRaw(d,"number",k)}async evalRString(d,k){return this.evalRRaw(d,"string",k)}async evalRRaw(d,k,M={}){let B=wt(M,Ft,y=>y._payload),u={type:"evalRRaw",data:{code:d,options:B,outputType:k}},_=await re(this,Qe).request(u);switch(_.payloadType){case"raw":return _.obj;case"ptr":throw new Error("Unexpected ptr payload type returned from evalRVoid")}}};Qe=new WeakMap;var Xe,qe,ci,is=class{constructor(d){we(this,Xe,"");we(this,qe,void 0);we(this,ci,!1);Be(this,qe,d)}async init(){if(re(this,ci))return;let d={type:"newShelter"},k=await re(this,qe).request(d);Be(this,Xe,k.obj),this.RObject=ut(re(this,qe),re(this,Xe),"object"),this.RLogical=ut(re(this,qe),re(this,Xe),"logical"),this.RInteger=ut(re(this,qe),re(this,Xe),"integer"),this.RDouble=ut(re(this,qe),re(this,Xe),"double"),this.RComplex=ut(re(this,qe),re(this,Xe),"complex"),this.RCharacter=ut(re(this,qe),re(this,Xe),"character"),this.RRaw=ut(re(this,qe),re(this,Xe),"raw"),this.RList=ut(re(this,qe),re(this,Xe),"list"),this.RPairlist=ut(re(this,qe),re(this,Xe),"pairlist"),this.REnvironment=ut(re(this,qe),re(this,Xe),"environment"),this.RSymbol=ut(re(this,qe),re(this,Xe),"symbol"),this.RString=ut(re(this,qe),re(this,Xe),"string"),this.RCall=ut(re(this,qe),re(this,Xe),"call"),Be(this,ci,!0)}async purge(){let d={type:"shelterPurge",data:re(this,Xe)};await re(this,qe).request(d)}async destroy(d){let k={type:"shelterDestroy",data:{id:re(this,Xe),obj:d._payload}};await re(this,qe).request(k)}async size(){let d={type:"shelterSize",data:re(this,Xe)};return(await re(this,qe).request(d)).obj}async evalR(d,k={}){let M=wt(k,Ft,_=>_._payload),B={type:"evalR",data:{code:d,options:M,shelter:re(this,Xe)}},u=await re(this,qe).request(B);switch(u.payloadType){case"raw":throw new Error("Unexpected payload type returned from evalR");default:return Wt(re(this,qe),u)}}async captureR(d,k={}){let M=wt(k,Ft,_=>_._payload),B={type:"captureR",data:{code:d,options:M,shelter:re(this,Xe)}},u=await re(this,qe).request(B);switch(u.payloadType){case"ptr":throw new Error("Unexpected payload type returned from evalR");case"raw":{let _=u.obj,y=Wt(re(this,qe),_.result),w=_.output;for(let R=0;R<w.length;++R)w[R].type!=="stdout"&&w[R].type!=="stderr"&&(w[R].data=Wt(re(this,qe),w[R].data));return{result:y,output:w}}}}};Xe=new WeakMap,qe=new WeakMap,ci=new WeakMap;function Ml(o){return new Proxy(is,{construct:async()=>{let d=new is(o);return await d.init(),d}})}var Qa=Tt(Fa()),$a=Tt(Ya()),eo=Tt(Za()),Rr=new Qa.Terminal({theme:{background:"#191919",foreground:"#F0F0F0"}}),us=new eo.FitAddon,hi=new $a.Readline;Rr.write("webR is downloading, please wait...");Rr.loadAddon(us);Rr.loadAddon(hi);Rr.open(document.getElementById("term"));Rr.focus();us.fit();function to(){(async()=>{await St.init();let o=us.proposeDimensions();await St.evalRVoid(`options(width=${o?o.cols:80})`)})(),us.fit()}window.addEventListener("resize",to);var Ct;function Zl(o,d){var k,M,B,u;d.node&&d.node.original&&(d.node.original.isFolder?((B=document.getElementById("download-file"))==null||B.setAttribute("disabled",""),(u=document.getElementById("upload-file"))==null||u.removeAttribute("disabled")):((k=document.getElementById("download-file"))==null||k.removeAttribute("disabled"),(M=document.getElementById("upload-file"))==null||M.setAttribute("disabled","")))}function Ql(o,d){o.id==="#"&&St.FS.lookupPath("/").then(k=>{let M=Ct.createJSTreeNodefromFSNode(k);M.parents=[],d.call(Ct,M)})}var St=new wr({RArgs:[],REnv:{R_HOME:"/usr/lib/R",R_ENABLE_JIT:"0",R_DEFAULT_DEVICE:"canvas",COLORTERM:"truecolor"}});globalThis.webR=St;(async()=>{await St.init(),hi.setCtrlCHandler(()=>St.interrupt()),await St.evalRVoid("webr::global_prompt_install()",{withHandlers:!1}),Rr.write("\x1B[2K\r"),to(),Ct=ia({selector:"#jstree_fs",core:{check_callback:!0,data:Ql,multiple:!1}}),Ct.getJSTreeElement().on("changed.jstree",Zl);let o=document.getElementById("download-file");o&&o.addEventListener("click",()=>{let M=Ct.getSelectedNode();if(!M)return;let B=Ct.getNodeFileName(M);St.FS.readFile(B).then(u=>{let _=M.text,y=new Blob([u],{type:"application/octet-stream"}),w=URL.createObjectURL(y),R=document.createElement("a");R.download=_,R.href=w,R.click(),R.remove()})});let d=document.getElementById("input-upload");d&&d.addEventListener("change",()=>{let M=Ct.getSelectedNode();if(M){let B=Ct.getNodeFileName(M);if(B===""&&(B="/"),!d.files||d.files.length===0)return;let u=d.files[0],_=new FileReader;_.onload=async function(){d.value="";let y=new Uint8Array(_.result);await St.FS.writeFile(B+"/"+u.name,y),Ct.refresh()},_.readAsArrayBuffer(u)}},!1);let k=document.getElementById("plot-save");for(k&&k.addEventListener("click",()=>{let M=document.createElement("a");M.download="plot.png";let B=document.getElementById("plot-canvas");!B||(M.href=B.toDataURL(),M.click(),M.remove())});;){let M=await St.read();switch(M.type){case"stdout":hi.println(M.data);break;case"stderr":hi.println(`\x1B[1;31m${M.data}\x1B[m`);break;case"prompt":hi.read(M.data).then(B=>St.writeConsole(B)),Ct.refresh();break;case"packageLoading":console.log(`Loading package: ${M.data}`),Ct.refresh();break;case"canvasExec":Function(`
           document.getElementById('plot-canvas').getContext('2d').${M.data}
         `)();break;default:console.error(`Unimplemented output type: ${M.type}`),console.error(M.data)}}})();
/*!
 * if using jslint please allow for the jQuery global and use following options:
 * jslint: loopfunc: true, browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true
 */
/*!
 * jQuery JavaScript Library v3.6.3
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2022-12-20T21:28Z
 */
/*!
 * jsTree 3.3.14
 * http://jstree.com/
 *
 * Copyright (c) 2014 Ivan Bozhanov (http://vakata.com)
 *
 * Licensed same as jquery - under the terms of the MIT License
 *   http://www.opensource.org/licenses/mit-license.php
 */
/*!
if(!('oncontextmenu' in document.body) && ('ontouchstart' in document.body)) {
	var el = null, tm = null;
	this.element
		.on("touchstart", ".jstree-anchor", function (e) {
			el = e.currentTarget;
			tm = +new Date();
			$(document).one("touchend", function (e) {
				e.target = document.elementFromPoint(e.originalEvent.targetTouches[0].pageX - window.pageXOffset, e.originalEvent.targetTouches[0].pageY - window.pageYOffset);
				e.currentTarget = e.target;
				tm = ((+(new Date())) - tm);
				if(e.target === el && tm > 600 && tm < 1000) {
					e.preventDefault();
					$(el).trigger('contextmenu', e);
				}
				el = null;
				tm = null;
			});
		});
}
*/
/*!
oi = obj.children("i:visible"),
ai = a.children("i:visible"),
w1 = oi.width() * oi.length,
w2 = ai.width() * ai.length,
*/
//# sourceMappingURL=repl.mjs.map
